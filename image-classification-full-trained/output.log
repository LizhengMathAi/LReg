Running experiment with n_components=16 and dof=16
[2024-11-09 10:40:10,159] torch.distributed.run: [WARNING] 
[2024-11-09 10:40:10,159] torch.distributed.run: [WARNING] *****************************************
[2024-11-09 10:40:10,159] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-09 10:40:10,159] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
| distributed init (rank 2): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='mobilenet_v2', device='cuda', n_components=16, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='mobilenet_v2', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='MobileNet_V2_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.5965332984924316
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 328720
Start training
Epoch: [0]  [    0/10010]  eta: 11:11:53  lr: 0.01  img/s: 14.836183302367905  loss: 0.9656 (0.9656)  acc1: 68.7500 (68.7500)  acc5: 90.6250 (90.6250)  time: 4.0274  data: 1.8705  max mem: 2682
Epoch: [0]  [ 1000/10010]  eta: 0:10:11  lr: 0.01  img/s: 445.81276344153883  loss: 1.0105 (1.1488)  acc1: 75.0000 (72.5774)  acc5: 90.6250 (89.2420)  time: 0.0625  data: 0.0001  max mem: 2682
Epoch: [0]  [ 2000/10010]  eta: 0:08:48  lr: 0.01  img/s: 357.09405338675737  loss: 1.1486 (1.1401)  acc1: 71.8750 (72.7058)  acc5: 87.5000 (89.3850)  time: 0.0654  data: 0.0001  max mem: 2682
Epoch: [0]  [ 3000/10010]  eta: 0:07:37  lr: 0.01  img/s: 334.9105018752012  loss: 1.2318 (1.1350)  acc1: 75.0000 (72.8226)  acc5: 87.5000 (89.4285)  time: 0.0640  data: 0.0001  max mem: 2682
Epoch: [0]  [ 4000/10010]  eta: 0:06:30  lr: 0.01  img/s: 501.1302990703058  loss: 1.1230 (1.1360)  acc1: 71.8750 (72.7802)  acc5: 90.6250 (89.4112)  time: 0.0609  data: 0.0001  max mem: 2682
Epoch: [0]  [ 5000/10010]  eta: 0:05:24  lr: 0.01  img/s: 403.50336559130085  loss: 1.1042 (1.1366)  acc1: 71.8750 (72.7904)  acc5: 87.5000 (89.4077)  time: 0.0657  data: 0.0001  max mem: 2682
Epoch: [0]  [ 6000/10010]  eta: 0:04:19  lr: 0.01  img/s: 577.3749171907666  loss: 1.0551 (1.1347)  acc1: 71.8750 (72.8103)  acc5: 90.6250 (89.4497)  time: 0.0604  data: 0.0001  max mem: 2682
Epoch: [0]  [ 7000/10010]  eta: 0:03:14  lr: 0.01  img/s: 502.70506496473666  loss: 1.0886 (1.1313)  acc1: 75.0000 (72.8454)  acc5: 90.6250 (89.4966)  time: 0.0611  data: 0.0001  max mem: 2682
Epoch: [0]  [ 8000/10010]  eta: 0:02:09  lr: 0.01  img/s: 589.1600442470107  loss: 1.0824 (1.1305)  acc1: 71.8750 (72.8635)  acc5: 90.6250 (89.4978)  time: 0.0616  data: 0.0001  max mem: 2682
Epoch: [0]  [ 9000/10010]  eta: 0:01:05  lr: 0.01  img/s: 426.48607907062467  loss: 1.0397 (1.1292)  acc1: 75.0000 (72.8832)  acc5: 90.6250 (89.5092)  time: 0.0634  data: 0.0001  max mem: 2682
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 711.6754933879126  loss: 0.8567 (1.1275)  acc1: 75.0000 (72.9136)  acc5: 90.6250 (89.5370)  time: 0.0450  data: 0.0001  max mem: 2682
Epoch: [0] Total time: 0:10:44
Test:   [  0/391]  eta: 0:11:00  loss: 0.4447 (0.4447)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.6901  data: 1.6722  max mem: 2682
Test:   [100/391]  eta: 0:00:25  loss: 0.8335 (0.8517)  acc1: 75.0000 (78.2488)  acc5: 93.7500 (93.7500)  time: 0.0728  data: 0.0508  max mem: 2682
Test:   [200/391]  eta: 0:00:14  loss: 1.6113 (0.9597)  acc1: 59.3750 (75.5442)  acc5: 84.3750 (92.7394)  time: 0.0605  data: 0.0366  max mem: 2682
Test:   [300/391]  eta: 0:00:06  loss: 1.3730 (1.1072)  acc1: 68.7500 (72.8094)  acc5: 84.3750 (90.9053)  time: 0.0615  data: 0.0414  max mem: 2682
Test:  Total time: 0:00:27
Test:  Acc@1 71.912 Acc@5 90.236
Number of added parameters: 328720
Epoch: [1]  [    0/10010]  eta: 4:49:51  lr: 0.01  img/s: 69.37754439033618  loss: 0.8745 (0.8745)  acc1: 84.3750 (84.3750)  acc5: 93.7500 (93.7500)  time: 1.7374  data: 1.2761  max mem: 2682
Epoch: [1]  [ 1000/10010]  eta: 0:10:03  lr: 0.01  img/s: 489.101360338463  loss: 1.0072 (1.1246)  acc1: 75.0000 (72.8428)  acc5: 90.6250 (89.5355)  time: 0.0638  data: 0.0001  max mem: 2682
Epoch: [1]  [ 2000/10010]  eta: 0:08:47  lr: 0.01  img/s: 486.7317055480811  loss: 1.2026 (1.1246)  acc1: 71.8750 (72.7683)  acc5: 87.5000 (89.5958)  time: 0.0672  data: 0.0004  max mem: 2682
Epoch: [1]  [ 3000/10010]  eta: 0:07:38  lr: 0.01  img/s: 373.3372497969447  loss: 1.1599 (1.1318)  acc1: 71.8750 (72.6622)  acc5: 87.5000 (89.4900)  time: 0.0655  data: 0.0002  max mem: 2682
Epoch: [1]  [ 4000/10010]  eta: 0:06:32  lr: 0.01  img/s: 515.5419120160711  loss: 1.0539 (1.1301)  acc1: 71.8750 (72.7170)  acc5: 87.5000 (89.5073)  time: 0.0658  data: 0.0003  max mem: 2682
Epoch: [1]  [ 5000/10010]  eta: 0:05:26  lr: 0.01  img/s: 527.075736512649  loss: 1.1386 (1.1307)  acc1: 68.7500 (72.7498)  acc5: 87.5000 (89.5240)  time: 0.0631  data: 0.0002  max mem: 2682
Epoch: [1]  [ 6000/10010]  eta: 0:04:21  lr: 0.01  img/s: 400.1315549407633  loss: 0.9113 (1.1314)  acc1: 71.8750 (72.7978)  acc5: 90.6250 (89.5132)  time: 0.0629  data: 0.0001  max mem: 2682
Epoch: [1]  [ 7000/10010]  eta: 0:03:15  lr: 0.01  img/s: 480.47127218574815  loss: 1.1774 (1.1307)  acc1: 68.7500 (72.8320)  acc5: 87.5000 (89.5385)  time: 0.0632  data: 0.0001  max mem: 2682
Epoch: [1]  [ 8000/10010]  eta: 0:02:10  lr: 0.01  img/s: 500.4258949244427  loss: 1.0974 (1.1305)  acc1: 75.0000 (72.8503)  acc5: 90.6250 (89.5478)  time: 0.0673  data: 0.0001  max mem: 2682
Epoch: [1]  [ 9000/10010]  eta: 0:01:05  lr: 0.01  img/s: 541.5870520492448  loss: 1.2092 (1.1325)  acc1: 71.8750 (72.8110)  acc5: 87.5000 (89.5085)  time: 0.0652  data: 0.0001  max mem: 2682
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 681.9625325820203  loss: 1.0129 (1.1330)  acc1: 71.8750 (72.8033)  acc5: 90.6250 (89.4995)  time: 0.0473  data: 0.0001  max mem: 2682
Epoch: [1] Total time: 0:10:50
Test:   [  0/391]  eta: 0:11:40  loss: 0.4499 (0.4499)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.7924  data: 1.7542  max mem: 2682
Test:   [100/391]  eta: 0:00:25  loss: 0.8330 (0.8527)  acc1: 75.0000 (78.3416)  acc5: 93.7500 (93.7191)  time: 0.0713  data: 0.0458  max mem: 2682
Test:   [200/391]  eta: 0:00:14  loss: 1.5730 (0.9590)  acc1: 59.3750 (75.5908)  acc5: 84.3750 (92.7705)  time: 0.0542  data: 0.0260  max mem: 2682
Test:   [300/391]  eta: 0:00:06  loss: 1.4116 (1.1050)  acc1: 68.7500 (72.8509)  acc5: 84.3750 (90.9053)  time: 0.0552  data: 0.0313  max mem: 2682
Test:  Total time: 0:00:27
Test:  Acc@1 71.878 Acc@5 90.290
Number of added parameters: 328720
Epoch: [2]  [    0/10010]  eta: 4:59:36  lr: 0.01  img/s: 275.90191358544945  loss: 1.2105 (1.2105)  acc1: 75.0000 (75.0000)  acc5: 93.7500 (93.7500)  time: 1.7959  data: 1.6799  max mem: 2710
Epoch: [2]  [ 1000/10010]  eta: 0:10:03  lr: 0.01  img/s: 548.3422314826163  loss: 1.1888 (1.1172)  acc1: 71.8750 (73.1550)  acc5: 87.5000 (89.5448)  time: 0.0658  data: 0.0001  max mem: 2713
Epoch: [2]  [ 2000/10010]  eta: 0:08:48  lr: 0.01  img/s: 408.21345953228933  loss: 1.0764 (1.1268)  acc1: 71.8750 (72.9854)  acc5: 90.6250 (89.4928)  time: 0.0646  data: 0.0001  max mem: 2713
Epoch: [2]  [ 3000/10010]  eta: 0:07:39  lr: 0.01  img/s: 600.5294341361706  loss: 1.0538 (1.1301)  acc1: 71.8750 (72.9309)  acc5: 87.5000 (89.4202)  time: 0.0650  data: 0.0002  max mem: 2713
Epoch: [2]  [ 4000/10010]  eta: 0:06:32  lr: 0.01  img/s: 393.3650484753989  loss: 1.0184 (1.1339)  acc1: 75.0000 (72.8185)  acc5: 90.6250 (89.4370)  time: 0.0630  data: 0.0001  max mem: 2713
Epoch: [2]  [ 5000/10010]  eta: 0:05:27  lr: 0.01  img/s: 541.534608044479  loss: 1.2809 (1.1378)  acc1: 68.7500 (72.7223)  acc5: 84.3750 (89.3815)  time: 0.0662  data: 0.0001  max mem: 2713
Epoch: [2]  [ 6000/10010]  eta: 0:04:21  lr: 0.01  img/s: 455.7632788889266  loss: 0.9904 (1.1358)  acc1: 75.0000 (72.7556)  acc5: 90.6250 (89.4314)  time: 0.0673  data: 0.0002  max mem: 2713
Epoch: [2]  [ 7000/10010]  eta: 0:03:16  lr: 0.01  img/s: 419.15532931513695  loss: 0.9669 (1.1364)  acc1: 75.0000 (72.7476)  acc5: 90.6250 (89.4140)  time: 0.0648  data: 0.0001  max mem: 2713
Epoch: [2]  [ 8000/10010]  eta: 0:02:10  lr: 0.01  img/s: 375.62438045555933  loss: 1.0776 (1.1371)  acc1: 71.8750 (72.7554)  acc5: 87.5000 (89.4041)  time: 0.0648  data: 0.0001  max mem: 2713
Epoch: [2]  [ 9000/10010]  eta: 0:01:05  lr: 0.01  img/s: 685.172357814885  loss: 1.0549 (1.1360)  acc1: 71.8750 (72.7350)  acc5: 90.6250 (89.4310)  time: 0.0624  data: 0.0001  max mem: 2713
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 664.4968314321926  loss: 1.1411 (1.1367)  acc1: 71.8750 (72.7452)  acc5: 90.6250 (89.4245)  time: 0.0490  data: 0.0001  max mem: 2713
Epoch: [2] Total time: 0:10:51
Test:   [  0/391]  eta: 0:09:50  loss: 0.4448 (0.4448)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.5102  data: 1.4700  max mem: 2713
Test:   [100/391]  eta: 0:00:24  loss: 0.8295 (0.8505)  acc1: 75.0000 (78.3416)  acc5: 93.7500 (93.8119)  time: 0.0772  data: 0.0482  max mem: 2713
Test:   [200/391]  eta: 0:00:15  loss: 1.5721 (0.9583)  acc1: 59.3750 (75.5597)  acc5: 87.5000 (92.8483)  time: 0.0664  data: 0.0363  max mem: 2713
Test:   [300/391]  eta: 0:00:06  loss: 1.3707 (1.1042)  acc1: 68.7500 (72.8717)  acc5: 84.3750 (90.9053)  time: 0.0610  data: 0.0281  max mem: 2713
Test:  Total time: 0:00:27
Test:  Acc@1 71.850 Acc@5 90.246
Number of added parameters: 328720
Epoch: [3]  [    0/10010]  eta: 4:54:13  lr: 0.01  img/s: 154.40458320870624  loss: 1.1889 (1.1889)  acc1: 75.0000 (75.0000)  acc5: 87.5000 (87.5000)  time: 1.7636  data: 1.5563  max mem: 2753
Epoch: [3]  [ 1000/10010]  eta: 0:10:07  lr: 0.01  img/s: 479.41237949300444  loss: 1.1910 (1.1196)  acc1: 71.8750 (73.1831)  acc5: 90.6250 (89.7946)  time: 0.0637  data: 0.0002  max mem: 2754
Epoch: [3]  [ 2000/10010]  eta: 0:08:51  lr: 0.01  img/s: 347.3786418823261  loss: 1.0961 (1.1139)  acc1: 71.8750 (73.1291)  acc5: 90.6250 (89.8020)  time: 0.0678  data: 0.0001  max mem: 2754
Epoch: [3]  [ 3000/10010]  eta: 0:07:42  lr: 0.01  img/s: 463.32621520765804  loss: 1.0408 (1.1237)  acc1: 75.0000 (73.0621)  acc5: 90.6250 (89.6316)  time: 0.0678  data: 0.0001  max mem: 2754
Epoch: [3]  [ 4000/10010]  eta: 0:06:35  lr: 0.01  img/s: 479.2446217074137  loss: 1.0464 (1.1296)  acc1: 71.8750 (72.8583)  acc5: 90.6250 (89.5112)  time: 0.0651  data: 0.0002  max mem: 2754
Epoch: [3]  [ 5000/10010]  eta: 0:05:29  lr: 0.01  img/s: 531.3154773686335  loss: 1.0519 (1.1335)  acc1: 75.0000 (72.8461)  acc5: 90.6250 (89.4584)  time: 0.0665  data: 0.0001  max mem: 2754
Epoch: [3]  [ 6000/10010]  eta: 0:04:22  lr: 0.01  img/s: 486.96304358868304  loss: 1.0755 (1.1357)  acc1: 71.8750 (72.8082)  acc5: 87.5000 (89.4262)  time: 0.0630  data: 0.0001  max mem: 2754
Epoch: [3]  [ 7000/10010]  eta: 0:03:17  lr: 0.01  img/s: 471.2998995723044  loss: 1.1225 (1.1343)  acc1: 75.0000 (72.8195)  acc5: 87.5000 (89.4689)  time: 0.0664  data: 0.0001  max mem: 2754
Epoch: [3]  [ 8000/10010]  eta: 0:02:11  lr: 0.01  img/s: 391.4845220698687  loss: 0.9634 (1.1337)  acc1: 71.8750 (72.8221)  acc5: 90.6250 (89.4673)  time: 0.0631  data: 0.0001  max mem: 2754
Epoch: [3]  [ 9000/10010]  eta: 0:01:06  lr: 0.01  img/s: 380.87188276824935  loss: 0.9416 (1.1333)  acc1: 71.8750 (72.8315)  acc5: 90.6250 (89.4869)  time: 0.0652  data: 0.0001  max mem: 2754
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 627.0215644504242  loss: 0.9505 (1.1340)  acc1: 75.0000 (72.7977)  acc5: 90.6250 (89.4889)  time: 0.0488  data: 0.0001  max mem: 2754
Epoch: [3] Total time: 0:10:55
Test:   [  0/391]  eta: 0:09:59  loss: 0.4526 (0.4526)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.5339  data: 1.5137  max mem: 2754
Test:   [100/391]  eta: 0:00:26  loss: 0.8372 (0.8531)  acc1: 75.0000 (78.0941)  acc5: 93.7500 (93.8119)  time: 0.0700  data: 0.0335  max mem: 2754
Test:   [200/391]  eta: 0:00:15  loss: 1.5941 (0.9578)  acc1: 59.3750 (75.4664)  acc5: 84.3750 (92.8483)  time: 0.0506  data: 0.0294  max mem: 2754
Test:   [300/391]  eta: 0:00:07  loss: 1.3548 (1.1050)  acc1: 68.7500 (72.7782)  acc5: 84.3750 (90.9468)  time: 0.0682  data: 0.0380  max mem: 2754
Test:  Total time: 0:00:28
Test:  Acc@1 71.924 Acc@5 90.254
Number of added parameters: 328720
Epoch: [4]  [    0/10010]  eta: 4:48:15  lr: 0.01  img/s: 61.296010120269536  loss: 1.5003 (1.5003)  acc1: 59.3750 (59.3750)  acc5: 87.5000 (87.5000)  time: 1.7279  data: 1.2058  max mem: 2793
Epoch: [4]  [ 1000/10010]  eta: 0:10:05  lr: 0.01  img/s: 649.6061641515096  loss: 1.2587 (1.1372)  acc1: 68.7500 (72.6773)  acc5: 90.6250 (89.4512)  time: 0.0655  data: 0.0001  max mem: 2794
Epoch: [4]  [ 2000/10010]  eta: 0:08:51  lr: 0.01  img/s: 451.94349768838873  loss: 1.1548 (1.1279)  acc1: 71.8750 (72.7105)  acc5: 90.6250 (89.5865)  time: 0.0637  data: 0.0007  max mem: 2794
Epoch: [4]  [ 3000/10010]  eta: 0:07:42  lr: 0.01  img/s: 583.9437886942184  loss: 0.9917 (1.1259)  acc1: 75.0000 (72.6987)  acc5: 90.6250 (89.6316)  time: 0.0637  data: 0.0002  max mem: 2794
Epoch: [4]  [ 4000/10010]  eta: 0:06:35  lr: 0.01  img/s: 543.4488164746086  loss: 1.0871 (1.1282)  acc1: 71.8750 (72.6943)  acc5: 90.6250 (89.5612)  time: 0.0626  data: 0.0001  max mem: 2794
Epoch: [4]  [ 5000/10010]  eta: 0:05:28  lr: 0.01  img/s: 477.49702226364883  loss: 1.0620 (1.1293)  acc1: 75.0000 (72.6773)  acc5: 87.5000 (89.5440)  time: 0.0632  data: 0.0002  max mem: 2794
Epoch: [4]  [ 6000/10010]  eta: 0:04:22  lr: 0.01  img/s: 579.0388362080123  loss: 1.1706 (1.1311)  acc1: 68.7500 (72.6639)  acc5: 90.6250 (89.5028)  time: 0.0666  data: 0.0002  max mem: 2794
Epoch: [4]  [ 7000/10010]  eta: 0:03:17  lr: 0.01  img/s: 533.0965881558566  loss: 1.2406 (1.1301)  acc1: 68.7500 (72.6686)  acc5: 87.5000 (89.5310)  time: 0.0658  data: 0.0002  max mem: 2794
Epoch: [4]  [ 8000/10010]  eta: 0:02:11  lr: 0.01  img/s: 504.25755065390786  loss: 1.0122 (1.1289)  acc1: 75.0000 (72.7175)  acc5: 90.6250 (89.5247)  time: 0.0652  data: 0.0001  max mem: 2794
Epoch: [4]  [ 9000/10010]  eta: 0:01:06  lr: 0.01  img/s: 453.4857637117401  loss: 1.0747 (1.1292)  acc1: 71.8750 (72.7315)  acc5: 90.6250 (89.5081)  time: 0.0660  data: 0.0001  max mem: 2794
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 693.4453170207489  loss: 1.1255 (1.1297)  acc1: 68.7500 (72.7290)  acc5: 90.6250 (89.4945)  time: 0.0513  data: 0.0001  max mem: 2794
Epoch: [4] Total time: 0:10:55
Test:   [  0/391]  eta: 0:10:06  loss: 0.4365 (0.4365)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.5524  data: 1.4874  max mem: 2794
Test:   [100/391]  eta: 0:00:26  loss: 0.8340 (0.8503)  acc1: 75.0000 (78.3725)  acc5: 93.7500 (93.7809)  time: 0.0804  data: 0.0493  max mem: 2794
Test:   [200/391]  eta: 0:00:15  loss: 1.6033 (0.9588)  acc1: 59.3750 (75.5752)  acc5: 84.3750 (92.8016)  time: 0.0569  data: 0.0258  max mem: 2794
Test:   [300/391]  eta: 0:00:06  loss: 1.3897 (1.1052)  acc1: 68.7500 (72.8405)  acc5: 84.3750 (90.9053)  time: 0.0556  data: 0.0287  max mem: 2794
Test:  Total time: 0:00:27
Test:  Acc@1 71.934 Acc@5 90.268
Number of added parameters: 328720
Training time 0:56:37
Experiment with model=mobilenet_v2, n_components=16, and dof=16 completed
-----------------------------------
Running experiment with n_components=16 and dof=16
[2024-11-09 12:49:23,797] torch.distributed.run: [WARNING] 
[2024-11-09 12:49:23,797] torch.distributed.run: [WARNING] *****************************************
[2024-11-09 12:49:23,797] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-09 12:49:23,797] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 2): env://
| distributed init (rank 3): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=16, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.3794071674346924
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 540688
Start training
Epoch: [0]  [    0/10010]  eta: 13:24:35  lr: 0.01  img/s: 9.99949919705389  loss: 1.1202 (1.1202)  acc1: 65.6250 (65.6250)  acc5: 87.5000 (87.5000)  time: 4.8227  data: 1.6225  max mem: 21519
Epoch: [0]  [ 1000/10010]  eta: 0:12:50  lr: 0.01  img/s: 405.31284690136675  loss: 0.8298 (0.9008)  acc1: 78.1250 (78.0438)  acc5: 93.7500 (92.2109)  time: 0.0809  data: 0.0001  max mem: 21519
Epoch: [0]  [ 2000/10010]  eta: 0:11:06  lr: 0.01  img/s: 393.96083219837504  loss: 0.7474 (0.8992)  acc1: 78.1250 (78.0407)  acc5: 93.7500 (92.2101)  time: 0.0811  data: 0.0001  max mem: 21519
Epoch: [0]  [ 3000/10010]  eta: 0:09:38  lr: 0.01  img/s: 393.078192313437  loss: 0.8939 (0.8935)  acc1: 75.0000 (78.0802)  acc5: 90.6250 (92.2890)  time: 0.0812  data: 0.0001  max mem: 21519
Epoch: [0]  [ 4000/10010]  eta: 0:08:13  lr: 0.01  img/s: 399.702579557705  loss: 0.7918 (0.8892)  acc1: 78.1250 (78.1797)  acc5: 90.6250 (92.2754)  time: 0.0806  data: 0.0001  max mem: 21519
Epoch: [0]  [ 5000/10010]  eta: 0:06:50  lr: 0.01  img/s: 396.77691784669054  loss: 0.8324 (0.8914)  acc1: 78.1250 (78.1475)  acc5: 90.6250 (92.2466)  time: 0.0808  data: 0.0001  max mem: 21519
Epoch: [0]  [ 6000/10010]  eta: 0:05:27  lr: 0.01  img/s: 396.37382978849075  loss: 0.8203 (0.8898)  acc1: 78.1250 (78.2005)  acc5: 93.7500 (92.2862)  time: 0.0805  data: 0.0001  max mem: 21519
Epoch: [0]  [ 7000/10010]  eta: 0:04:05  lr: 0.01  img/s: 392.669943360015  loss: 0.9438 (0.8885)  acc1: 78.1250 (78.2187)  acc5: 90.6250 (92.3292)  time: 0.0811  data: 0.0001  max mem: 21519
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 383.8103963991787  loss: 0.9126 (0.8881)  acc1: 78.1250 (78.2180)  acc5: 90.6250 (92.3263)  time: 0.0805  data: 0.0001  max mem: 21519
Epoch: [0]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 391.95439678534717  loss: 0.8300 (0.8881)  acc1: 78.1250 (78.2087)  acc5: 93.7500 (92.3189)  time: 0.0807  data: 0.0001  max mem: 21519
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 402.6608345558566  loss: 0.8072 (0.8874)  acc1: 78.1250 (78.2409)  acc5: 93.7500 (92.3395)  time: 0.0786  data: 0.0001  max mem: 21519
Epoch: [0] Total time: 0:13:35
Test:   [  0/391]  eta: 0:10:35  loss: 0.3901 (0.3901)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6260  data: 1.4069  max mem: 21519
Test:   [100/391]  eta: 0:00:26  loss: 0.6454 (0.6905)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.9777)  time: 0.0801  data: 0.0463  max mem: 21519
Test:   [200/391]  eta: 0:00:14  loss: 1.1901 (0.7922)  acc1: 68.7500 (79.4154)  acc5: 87.5000 (94.9005)  time: 0.0547  data: 0.0246  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2599 (0.9205)  acc1: 71.8750 (76.8376)  acc5: 87.5000 (93.3762)  time: 0.0620  data: 0.0282  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.242 Acc@5 92.936
Number of added parameters: 540688
Epoch: [1]  [    0/10010]  eta: 4:43:45  lr: 0.01  img/s: 77.83666318516357  loss: 0.4844 (0.4844)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.7008  data: 1.2897  max mem: 21519
Epoch: [1]  [ 1000/10010]  eta: 0:12:44  lr: 0.01  img/s: 384.4083928581657  loss: 0.9325 (0.8827)  acc1: 78.1250 (78.2436)  acc5: 90.6250 (92.2983)  time: 0.0825  data: 0.0001  max mem: 21519
Epoch: [1]  [ 2000/10010]  eta: 0:11:12  lr: 0.01  img/s: 393.31432858214555  loss: 0.8420 (0.8789)  acc1: 78.1250 (78.2156)  acc5: 93.7500 (92.4991)  time: 0.0834  data: 0.0001  max mem: 21519
Epoch: [1]  [ 3000/10010]  eta: 0:09:45  lr: 0.01  img/s: 368.38390303615836  loss: 0.8740 (0.8824)  acc1: 75.0000 (78.2666)  acc5: 90.6250 (92.4254)  time: 0.0829  data: 0.0001  max mem: 21519
Epoch: [1]  [ 4000/10010]  eta: 0:08:21  lr: 0.01  img/s: 384.5251312140451  loss: 0.8773 (0.8862)  acc1: 78.1250 (78.2398)  acc5: 90.6250 (92.3738)  time: 0.0830  data: 0.0001  max mem: 21519
Epoch: [1]  [ 5000/10010]  eta: 0:06:57  lr: 0.01  img/s: 389.12712513046506  loss: 0.8174 (0.8893)  acc1: 81.2500 (78.2331)  acc5: 93.7500 (92.3309)  time: 0.0824  data: 0.0001  max mem: 21519
Epoch: [1]  [ 6000/10010]  eta: 0:05:33  lr: 0.01  img/s: 392.25222402768196  loss: 0.8721 (0.8874)  acc1: 78.1250 (78.2510)  acc5: 90.6250 (92.3601)  time: 0.0830  data: 0.0001  max mem: 21519
Epoch: [1]  [ 7000/10010]  eta: 0:04:10  lr: 0.01  img/s: 350.2203017446078  loss: 0.8021 (0.8872)  acc1: 78.1250 (78.2344)  acc5: 93.7500 (92.3457)  time: 0.0828  data: 0.0001  max mem: 21519
Epoch: [1]  [ 8000/10010]  eta: 0:02:47  lr: 0.01  img/s: 397.675087257708  loss: 0.8649 (0.8886)  acc1: 78.1250 (78.2058)  acc5: 93.7500 (92.3342)  time: 0.0826  data: 0.0001  max mem: 21519
Epoch: [1]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 389.99662357511676  loss: 0.7881 (0.8899)  acc1: 75.0000 (78.1746)  acc5: 93.7500 (92.3099)  time: 0.0827  data: 0.0001  max mem: 21519
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 396.1749315197884  loss: 0.6997 (0.8884)  acc1: 81.2500 (78.2131)  acc5: 93.7500 (92.3323)  time: 0.0802  data: 0.0001  max mem: 21519
Epoch: [1] Total time: 0:13:51
Test:   [  0/391]  eta: 0:10:18  loss: 0.4009 (0.4009)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5812  data: 1.5373  max mem: 21519
Test:   [100/391]  eta: 0:00:28  loss: 0.6385 (0.6919)  acc1: 81.2500 (81.7450)  acc5: 96.8750 (95.8849)  time: 0.0561  data: 0.0208  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.2019 (0.7929)  acc1: 68.7500 (79.2755)  acc5: 87.5000 (94.8539)  time: 0.0516  data: 0.0186  max mem: 21519
Test:   [300/391]  eta: 0:00:07  loss: 1.2483 (0.9200)  acc1: 68.7500 (76.7130)  acc5: 87.5000 (93.4178)  time: 0.0793  data: 0.0384  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.188 Acc@5 92.938
Number of added parameters: 540688
Epoch: [2]  [    0/10010]  eta: 6:47:33  lr: 0.01  img/s: 287.4761514126666  loss: 0.9460 (0.9460)  acc1: 78.1250 (78.1250)  acc5: 90.6250 (90.6250)  time: 2.4429  data: 2.3315  max mem: 21519
Epoch: [2]  [ 1000/10010]  eta: 0:13:03  lr: 0.01  img/s: 377.10189116062924  loss: 0.9654 (0.8840)  acc1: 78.1250 (78.2062)  acc5: 87.5000 (92.4170)  time: 0.0850  data: 0.0001  max mem: 21519
Epoch: [2]  [ 2000/10010]  eta: 0:11:27  lr: 0.01  img/s: 376.2741111628194  loss: 0.8966 (0.8923)  acc1: 78.1250 (78.0672)  acc5: 90.6250 (92.3007)  time: 0.0850  data: 0.0001  max mem: 21519
Epoch: [2]  [ 3000/10010]  eta: 0:09:58  lr: 0.01  img/s: 380.4378936388528  loss: 0.7644 (0.8877)  acc1: 81.2500 (78.1208)  acc5: 93.7500 (92.3578)  time: 0.0846  data: 0.0002  max mem: 21519
Epoch: [2]  [ 4000/10010]  eta: 0:08:32  lr: 0.01  img/s: 380.8491871845002  loss: 0.9144 (0.8900)  acc1: 75.0000 (78.0766)  acc5: 90.6250 (92.3457)  time: 0.0847  data: 0.0001  max mem: 21519
Epoch: [2]  [ 5000/10010]  eta: 0:07:06  lr: 0.01  img/s: 376.70393353821976  loss: 0.9610 (0.8919)  acc1: 78.1250 (78.0169)  acc5: 93.7500 (92.3015)  time: 0.0842  data: 0.0001  max mem: 21519
Epoch: [2]  [ 6000/10010]  eta: 0:05:40  lr: 0.01  img/s: 381.73415244596134  loss: 0.8831 (0.8902)  acc1: 75.0000 (78.0625)  acc5: 90.6250 (92.3216)  time: 0.0848  data: 0.0002  max mem: 21519
Epoch: [2]  [ 7000/10010]  eta: 0:04:15  lr: 0.01  img/s: 386.0836327339568  loss: 0.8498 (0.8903)  acc1: 78.1250 (78.0612)  acc5: 90.6250 (92.3123)  time: 0.0843  data: 0.0001  max mem: 21519
Epoch: [2]  [ 8000/10010]  eta: 0:02:50  lr: 0.01  img/s: 379.62870315372646  loss: 0.7816 (0.8904)  acc1: 81.2500 (78.0613)  acc5: 93.7500 (92.3361)  time: 0.0844  data: 0.0001  max mem: 21519
Epoch: [2]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 382.7279825029157  loss: 0.7659 (0.8907)  acc1: 81.2500 (78.0365)  acc5: 93.7500 (92.3259)  time: 0.0846  data: 0.0001  max mem: 21519
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 402.7720017405135  loss: 0.7693 (0.8913)  acc1: 81.2500 (78.0297)  acc5: 93.7500 (92.3076)  time: 0.0830  data: 0.0001  max mem: 21519
Epoch: [2] Total time: 0:14:09
Test:   [  0/391]  eta: 0:12:30  loss: 0.4092 (0.4092)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.9196  data: 1.8851  max mem: 21519
Test:   [100/391]  eta: 0:00:26  loss: 0.6327 (0.6910)  acc1: 81.2500 (81.9616)  acc5: 96.8750 (95.9158)  time: 0.0615  data: 0.0259  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1952 (0.7901)  acc1: 68.7500 (79.4621)  acc5: 87.5000 (94.9160)  time: 0.0518  data: 0.0138  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2487 (0.9182)  acc1: 68.7500 (76.8272)  acc5: 87.5000 (93.4489)  time: 0.0565  data: 0.0211  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.260 Acc@5 92.974
Number of added parameters: 540688
Epoch: [3]  [    0/10010]  eta: 4:49:39  lr: 0.01  img/s: 65.37785454520656  loss: 0.6559 (0.6559)  acc1: 78.1250 (78.1250)  acc5: 93.7500 (93.7500)  time: 1.7362  data: 1.2468  max mem: 21519
Epoch: [3]  [ 1000/10010]  eta: 0:13:16  lr: 0.01  img/s: 368.01421411101484  loss: 0.8910 (0.8973)  acc1: 75.0000 (77.6848)  acc5: 90.6250 (92.1016)  time: 0.0866  data: 0.0001  max mem: 21519
Epoch: [3]  [ 2000/10010]  eta: 0:11:40  lr: 0.01  img/s: 371.9426253131443  loss: 0.9212 (0.8886)  acc1: 78.1250 (77.8892)  acc5: 90.6250 (92.3366)  time: 0.0863  data: 0.0001  max mem: 21519
Epoch: [3]  [ 3000/10010]  eta: 0:10:10  lr: 0.01  img/s: 367.9082927417609  loss: 0.8899 (0.8950)  acc1: 78.1250 (77.8355)  acc5: 90.6250 (92.2359)  time: 0.0868  data: 0.0001  max mem: 21519
Epoch: [3]  [ 4000/10010]  eta: 0:08:42  lr: 0.01  img/s: 368.85770349076876  loss: 0.7962 (0.8955)  acc1: 81.2500 (77.8454)  acc5: 93.7500 (92.2363)  time: 0.0863  data: 0.0001  max mem: 21519
Epoch: [3]  [ 5000/10010]  eta: 0:07:15  lr: 0.01  img/s: 369.03112704596884  loss: 0.8694 (0.8962)  acc1: 75.0000 (77.8494)  acc5: 93.7500 (92.2353)  time: 0.0868  data: 0.0001  max mem: 21519
Epoch: [3]  [ 6000/10010]  eta: 0:05:48  lr: 0.01  img/s: 375.4100519407143  loss: 0.6861 (0.8970)  acc1: 78.1250 (77.8678)  acc5: 96.8750 (92.2279)  time: 0.0864  data: 0.0001  max mem: 21519
Epoch: [3]  [ 7000/10010]  eta: 0:04:21  lr: 0.01  img/s: 363.84017002266245  loss: 0.9255 (0.8963)  acc1: 78.1250 (77.8982)  acc5: 93.7500 (92.2333)  time: 0.0870  data: 0.0001  max mem: 21519
Epoch: [3]  [ 8000/10010]  eta: 0:02:54  lr: 0.01  img/s: 371.6491010436367  loss: 0.7123 (0.8951)  acc1: 81.2500 (77.9305)  acc5: 93.7500 (92.2459)  time: 0.0864  data: 0.0001  max mem: 21519
Epoch: [3]  [ 9000/10010]  eta: 0:01:27  lr: 0.01  img/s: 366.9828208009668  loss: 0.8023 (0.8955)  acc1: 78.1250 (77.9087)  acc5: 93.7500 (92.2477)  time: 0.0862  data: 0.0001  max mem: 21519
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 389.3890358817249  loss: 0.8898 (0.8956)  acc1: 75.0000 (77.8750)  acc5: 90.6250 (92.2330)  time: 0.0839  data: 0.0001  max mem: 21519
Epoch: [3] Total time: 0:14:27
Test:   [  0/391]  eta: 0:08:57  loss: 0.3984 (0.3984)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3741  data: 1.3417  max mem: 21519
Test:   [100/391]  eta: 0:00:27  loss: 0.6603 (0.6918)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (95.9158)  time: 0.0494  data: 0.0163  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1704 (0.7915)  acc1: 68.7500 (79.3843)  acc5: 87.5000 (94.8694)  time: 0.0548  data: 0.0148  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2231 (0.9193)  acc1: 68.7500 (76.8584)  acc5: 87.5000 (93.4178)  time: 0.0655  data: 0.0256  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.206 Acc@5 92.950
Number of added parameters: 540688
Epoch: [4]  [    0/10010]  eta: 5:47:50  lr: 0.01  img/s: 100.60982187967096  loss: 0.6452 (0.6452)  acc1: 75.0000 (75.0000)  acc5: 100.0000 (100.0000)  time: 2.0849  data: 1.7669  max mem: 21519
Epoch: [4]  [ 1000/10010]  eta: 0:13:34  lr: 0.01  img/s: 367.85888363271596  loss: 0.9321 (0.8945)  acc1: 75.0000 (78.0251)  acc5: 93.7500 (92.2140)  time: 0.0880  data: 0.0002  max mem: 21519
Epoch: [4]  [ 2000/10010]  eta: 0:11:55  lr: 0.01  img/s: 362.5830440526135  loss: 0.8780 (0.8959)  acc1: 78.1250 (78.0781)  acc5: 93.7500 (92.1258)  time: 0.0881  data: 0.0001  max mem: 21519
Epoch: [4]  [ 3000/10010]  eta: 0:10:23  lr: 0.01  img/s: 366.6029193252338  loss: 0.8305 (0.8902)  acc1: 78.1250 (78.1948)  acc5: 93.7500 (92.2130)  time: 0.0882  data: 0.0001  max mem: 21519
Epoch: [4]  [ 4000/10010]  eta: 0:08:53  lr: 0.01  img/s: 368.65507561649554  loss: 0.7572 (0.8868)  acc1: 81.2500 (78.2547)  acc5: 93.7500 (92.3004)  time: 0.0882  data: 0.0001  max mem: 21519
Epoch: [4]  [ 5000/10010]  eta: 0:07:24  lr: 0.01  img/s: 367.0671272176322  loss: 0.7037 (0.8887)  acc1: 78.1250 (78.2100)  acc5: 93.7500 (92.2784)  time: 0.0881  data: 0.0001  max mem: 21519
Epoch: [4]  [ 6000/10010]  eta: 0:05:55  lr: 0.01  img/s: 363.5080884762573  loss: 0.8380 (0.8914)  acc1: 78.1250 (78.1531)  acc5: 90.6250 (92.2638)  time: 0.0883  data: 0.0001  max mem: 21519
Epoch: [4]  [ 7000/10010]  eta: 0:04:26  lr: 0.01  img/s: 359.38983559149574  loss: 1.0557 (0.8913)  acc1: 75.0000 (78.1513)  acc5: 90.6250 (92.2542)  time: 0.0883  data: 0.0001  max mem: 21519
Epoch: [4]  [ 8000/10010]  eta: 0:02:57  lr: 0.01  img/s: 368.0071507889722  loss: 0.8462 (0.8909)  acc1: 78.1250 (78.1582)  acc5: 90.6250 (92.2717)  time: 0.0876  data: 0.0001  max mem: 21519
Epoch: [4]  [ 9000/10010]  eta: 0:01:29  lr: 0.01  img/s: 368.00513274675984  loss: 0.8398 (0.8911)  acc1: 78.1250 (78.1403)  acc5: 93.7500 (92.2700)  time: 0.0890  data: 0.0001  max mem: 21519
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 360.482499301691  loss: 0.8655 (0.8923)  acc1: 75.0000 (78.0997)  acc5: 93.7500 (92.2630)  time: 0.0887  data: 0.0001  max mem: 21519
Epoch: [4] Total time: 0:14:47
Test:   [  0/391]  eta: 0:11:14  loss: 0.3889 (0.3889)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7255  data: 1.6665  max mem: 21519
Test:   [100/391]  eta: 0:00:27  loss: 0.6569 (0.6900)  acc1: 81.2500 (81.7450)  acc5: 96.8750 (96.0087)  time: 0.0674  data: 0.0276  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.2268 (0.7914)  acc1: 68.7500 (79.2910)  acc5: 87.5000 (94.9316)  time: 0.0684  data: 0.0187  max mem: 21519
Test:   [300/391]  eta: 0:00:07  loss: 1.2264 (0.9197)  acc1: 68.7500 (76.7234)  acc5: 87.5000 (93.4489)  time: 0.0676  data: 0.0216  max mem: 21519
Test:  Total time: 0:00:30
Test:  Acc@1 76.222 Acc@5 92.938
Number of added parameters: 540688
Training time 1:13:20
Experiment with model=resnet50, n_components=16, and dof=16 completed
-----------------------------------
Running experiment with n_components=4 and dof=16
[2024-11-09 18:28:16,635] torch.distributed.run: [WARNING] 
[2024-11-09 18:28:16,635] torch.distributed.run: [WARNING] *****************************************
[2024-11-09 18:28:16,635] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-09 18:28:16,635] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
| distributed init (rank 2): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnext50_32x4d', device='cuda', n_components=4, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.001, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnext50_32x4d', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNeXt50_32X4D_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.4048588275909424
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 135172
Start training
Epoch: [0]  [    0/10010]  eta: 14:08:24  lr: 0.001  img/s: 11.820756532417226  loss: 0.8536 (0.8536)  acc1: 87.5000 (87.5000)  acc5: 93.7500 (93.7500)  time: 5.0854  data: 2.3783  max mem: 22293
Epoch: [0]  [ 1000/10010]  eta: 0:16:00  lr: 0.001  img/s: 318.0718387195389  loss: 0.5246 (0.6516)  acc1: 87.5000 (84.0316)  acc5: 93.7500 (94.3369)  time: 0.1019  data: 0.0001  max mem: 22293
Epoch: [0]  [ 2000/10010]  eta: 0:13:54  lr: 0.001  img/s: 312.7328072100788  loss: 0.5952 (0.6506)  acc1: 84.3750 (84.0127)  acc5: 93.7500 (94.4575)  time: 0.1017  data: 0.0001  max mem: 22293
Epoch: [0]  [ 3000/10010]  eta: 0:12:04  lr: 0.001  img/s: 319.76092094228864  loss: 0.5736 (0.6498)  acc1: 84.3750 (83.9991)  acc5: 93.7500 (94.5018)  time: 0.1019  data: 0.0001  max mem: 22293
Epoch: [0]  [ 4000/10010]  eta: 0:10:18  lr: 0.001  img/s: 318.17513915360473  loss: 0.6082 (0.6468)  acc1: 84.3750 (84.0384)  acc5: 96.8750 (94.5748)  time: 0.1020  data: 0.0001  max mem: 22293
Epoch: [0]  [ 5000/10010]  eta: 0:08:34  lr: 0.001  img/s: 321.29335331376785  loss: 0.6839 (0.6452)  acc1: 81.2500 (84.0538)  acc5: 93.7500 (94.6279)  time: 0.1017  data: 0.0001  max mem: 22293
Epoch: [0]  [ 6000/10010]  eta: 0:06:50  lr: 0.001  img/s: 313.9023242542881  loss: 0.6866 (0.6465)  acc1: 84.3750 (84.0172)  acc5: 93.7500 (94.6124)  time: 0.1012  data: 0.0001  max mem: 22293
Epoch: [0]  [ 7000/10010]  eta: 0:05:08  lr: 0.001  img/s: 319.6931351275388  loss: 0.7340 (0.6451)  acc1: 81.2500 (84.0237)  acc5: 93.7500 (94.6548)  time: 0.1011  data: 0.0001  max mem: 22293
Epoch: [0]  [ 8000/10010]  eta: 0:03:25  lr: 0.001  img/s: 311.27787505537094  loss: 0.6544 (0.6451)  acc1: 81.2500 (84.0407)  acc5: 93.7500 (94.6620)  time: 0.1011  data: 0.0001  max mem: 22293
Epoch: [0]  [ 9000/10010]  eta: 0:01:43  lr: 0.001  img/s: 316.5721509911032  loss: 0.6146 (0.6446)  acc1: 81.2500 (84.0636)  acc5: 96.8750 (94.6568)  time: 0.1016  data: 0.0001  max mem: 22293
Epoch: [0]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 321.4326242153841  loss: 0.5788 (0.6441)  acc1: 84.3750 (84.0844)  acc5: 96.8750 (94.6655)  time: 0.1005  data: 0.0001  max mem: 22293
Epoch: [0] Total time: 0:17:03
Test:   [  0/391]  eta: 0:12:38  loss: 0.3073 (0.3073)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.9402  data: 1.8484  max mem: 22293
Test:   [100/391]  eta: 0:00:28  loss: 0.6953 (0.6380)  acc1: 84.3750 (84.0965)  acc5: 96.8750 (96.3800)  time: 0.0784  data: 0.0400  max mem: 22293
Test:   [200/391]  eta: 0:00:15  loss: 1.3314 (0.7693)  acc1: 68.7500 (81.0790)  acc5: 90.6250 (95.4291)  time: 0.0759  data: 0.0351  max mem: 22293
Test:   [300/391]  eta: 0:00:07  loss: 1.1099 (0.8988)  acc1: 75.0000 (78.7272)  acc5: 90.6250 (94.1549)  time: 0.0596  data: 0.0200  max mem: 22293
Test:  Total time: 0:00:28
Test:  Acc@1 77.632 Acc@5 93.682
Number of added parameters: 135172
Epoch: [1]  [    0/10010]  eta: 5:14:17  lr: 0.001  img/s: 143.80275696258408  loss: 0.1257 (0.1257)  acc1: 96.8750 (96.8750)  acc5: 100.0000 (100.0000)  time: 1.8838  data: 1.6613  max mem: 22293
Epoch: [1]  [ 1000/10010]  eta: 0:15:47  lr: 0.001  img/s: 311.2302358961992  loss: 0.5541 (0.6438)  acc1: 84.3750 (84.2532)  acc5: 96.8750 (94.6491)  time: 0.1037  data: 0.0001  max mem: 22293
Epoch: [1]  [ 2000/10010]  eta: 0:13:54  lr: 0.001  img/s: 313.61260640274037  loss: 0.5949 (0.6444)  acc1: 84.3750 (84.1626)  acc5: 96.8750 (94.6714)  time: 0.1029  data: 0.0001  max mem: 22293
Epoch: [1]  [ 3000/10010]  eta: 0:12:07  lr: 0.001  img/s: 302.9560907123042  loss: 0.6523 (0.6464)  acc1: 84.3750 (84.0772)  acc5: 93.7500 (94.6716)  time: 0.1030  data: 0.0001  max mem: 22293
Epoch: [1]  [ 4000/10010]  eta: 0:10:22  lr: 0.001  img/s: 312.3783421464214  loss: 0.6471 (0.6441)  acc1: 84.3750 (84.1360)  acc5: 93.7500 (94.6888)  time: 0.1034  data: 0.0001  max mem: 22293
Epoch: [1]  [ 5000/10010]  eta: 0:08:38  lr: 0.001  img/s: 316.00122428414693  loss: 0.5028 (0.6461)  acc1: 84.3750 (84.1132)  acc5: 96.8750 (94.6667)  time: 0.1026  data: 0.0001  max mem: 22293
Epoch: [1]  [ 6000/10010]  eta: 0:06:54  lr: 0.001  img/s: 303.4828719887486  loss: 0.5356 (0.6438)  acc1: 84.3750 (84.1365)  acc5: 93.7500 (94.7181)  time: 0.1028  data: 0.0001  max mem: 22293
Epoch: [1]  [ 7000/10010]  eta: 0:05:11  lr: 0.001  img/s: 312.52308802812803  loss: 0.6061 (0.6429)  acc1: 84.3750 (84.1518)  acc5: 93.7500 (94.7244)  time: 0.1030  data: 0.0001  max mem: 22293
Epoch: [1]  [ 8000/10010]  eta: 0:03:27  lr: 0.001  img/s: 318.7214073182258  loss: 0.5989 (0.6437)  acc1: 87.5000 (84.1418)  acc5: 93.7500 (94.7120)  time: 0.1034  data: 0.0001  max mem: 22293
Epoch: [1]  [ 9000/10010]  eta: 0:01:44  lr: 0.001  img/s: 315.4701647420514  loss: 0.5768 (0.6441)  acc1: 84.3750 (84.1167)  acc5: 96.8750 (94.7117)  time: 0.1032  data: 0.0001  max mem: 22293
Epoch: [1]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 316.6378726255296  loss: 0.5062 (0.6426)  acc1: 84.3750 (84.1572)  acc5: 96.8750 (94.7430)  time: 0.1019  data: 0.0001  max mem: 22293
Epoch: [1] Total time: 0:17:13
Test:   [  0/391]  eta: 0:11:52  loss: 0.3090 (0.3090)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.8217  data: 1.7719  max mem: 22293
Test:   [100/391]  eta: 0:00:26  loss: 0.6940 (0.6370)  acc1: 84.3750 (84.0965)  acc5: 96.8750 (96.3800)  time: 0.0633  data: 0.0240  max mem: 22293
Test:   [200/391]  eta: 0:00:15  loss: 1.3486 (0.7684)  acc1: 68.7500 (81.0479)  acc5: 90.6250 (95.4447)  time: 0.0704  data: 0.0215  max mem: 22293
Test:   [300/391]  eta: 0:00:07  loss: 1.1117 (0.8979)  acc1: 75.0000 (78.6856)  acc5: 90.6250 (94.1653)  time: 0.0598  data: 0.0199  max mem: 22293
Test:  Total time: 0:00:28
Test:  Acc@1 77.650 Acc@5 93.680
Number of added parameters: 135172
Epoch: [2]  [    0/10010]  eta: 5:02:39  lr: 0.001  img/s: 187.56337882518662  loss: 0.5896 (0.5896)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.8142  data: 1.6435  max mem: 22293
Epoch: [2]  [ 1000/10010]  eta: 0:16:00  lr: 0.001  img/s: 296.0746133008621  loss: 0.4950 (0.6224)  acc1: 84.3750 (84.3875)  acc5: 96.8750 (94.8864)  time: 0.1052  data: 0.0001  max mem: 22293
Epoch: [2]  [ 2000/10010]  eta: 0:14:06  lr: 0.001  img/s: 302.53816278550806  loss: 0.5160 (0.6323)  acc1: 84.3750 (84.1454)  acc5: 96.8750 (94.7745)  time: 0.1058  data: 0.0001  max mem: 22293
Epoch: [2]  [ 3000/10010]  eta: 0:12:18  lr: 0.001  img/s: 306.6495038737374  loss: 0.6515 (0.6273)  acc1: 84.3750 (84.2219)  acc5: 93.7500 (94.8434)  time: 0.1044  data: 0.0001  max mem: 22293
Epoch: [2]  [ 4000/10010]  eta: 0:10:31  lr: 0.001  img/s: 309.70987110202464  loss: 0.5807 (0.6331)  acc1: 84.3750 (84.1368)  acc5: 93.7500 (94.8482)  time: 0.1045  data: 0.0001  max mem: 22293
Epoch: [2]  [ 5000/10010]  eta: 0:08:45  lr: 0.001  img/s: 303.8882780731228  loss: 0.5579 (0.6361)  acc1: 84.3750 (84.0838)  acc5: 93.7500 (94.8085)  time: 0.1045  data: 0.0001  max mem: 22293
Epoch: [2]  [ 6000/10010]  eta: 0:07:00  lr: 0.001  img/s: 305.9846708705505  loss: 0.6462 (0.6384)  acc1: 81.2500 (84.0646)  acc5: 93.7500 (94.7774)  time: 0.1040  data: 0.0001  max mem: 22293
Epoch: [2]  [ 7000/10010]  eta: 0:05:15  lr: 0.001  img/s: 310.58493792592765  loss: 0.5803 (0.6398)  acc1: 81.2500 (84.0719)  acc5: 96.8750 (94.7677)  time: 0.1048  data: 0.0001  max mem: 22293
Epoch: [2]  [ 8000/10010]  eta: 0:03:30  lr: 0.001  img/s: 312.1473177946984  loss: 0.5611 (0.6408)  acc1: 84.3750 (84.0497)  acc5: 96.8750 (94.7468)  time: 0.1048  data: 0.0001  max mem: 22293
Epoch: [2]  [ 9000/10010]  eta: 0:01:45  lr: 0.001  img/s: 312.0921550116496  loss: 0.6042 (0.6404)  acc1: 81.2500 (84.0570)  acc5: 93.7500 (94.7745)  time: 0.1042  data: 0.0001  max mem: 22293
Epoch: [2]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 325.3408185773673  loss: 0.5639 (0.6406)  acc1: 84.3750 (84.0647)  acc5: 96.8750 (94.7711)  time: 0.1030  data: 0.0001  max mem: 22293
Epoch: [2] Total time: 0:17:28
Test:   [  0/391]  eta: 0:11:25  loss: 0.3094 (0.3094)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.7532  data: 1.7117  max mem: 22293
Test:   [100/391]  eta: 0:00:27  loss: 0.6919 (0.6364)  acc1: 84.3750 (84.0037)  acc5: 96.8750 (96.2562)  time: 0.0596  data: 0.0167  max mem: 22293
Test:   [200/391]  eta: 0:00:16  loss: 1.3619 (0.7680)  acc1: 68.7500 (81.0012)  acc5: 90.6250 (95.4136)  time: 0.0672  data: 0.0243  max mem: 22293
Test:   [300/391]  eta: 0:00:07  loss: 1.1134 (0.8975)  acc1: 71.8750 (78.6233)  acc5: 90.6250 (94.1341)  time: 0.0636  data: 0.0231  max mem: 22293
Test:  Total time: 0:00:28
Test:  Acc@1 77.618 Acc@5 93.678
Number of added parameters: 135172
Epoch: [3]  [    0/10010]  eta: 5:40:00  lr: 0.001  img/s: 76.46056449155029  loss: 0.3291 (0.3291)  acc1: 93.7500 (93.7500)  acc5: 100.0000 (100.0000)  time: 2.0380  data: 1.6195  max mem: 22293
Epoch: [3]  [ 1000/10010]  eta: 0:16:11  lr: 0.001  img/s: 307.55736837160487  loss: 0.6106 (0.6441)  acc1: 87.5000 (84.0285)  acc5: 93.7500 (94.7240)  time: 0.1064  data: 0.0001  max mem: 22293
Epoch: [3]  [ 2000/10010]  eta: 0:14:15  lr: 0.001  img/s: 300.6514628502564  loss: 0.6523 (0.6432)  acc1: 84.3750 (84.0221)  acc5: 93.7500 (94.7839)  time: 0.1054  data: 0.0001  max mem: 22293
Epoch: [3]  [ 3000/10010]  eta: 0:12:26  lr: 0.001  img/s: 299.9292242646894  loss: 0.7374 (0.6436)  acc1: 81.2500 (84.0439)  acc5: 96.8750 (94.7715)  time: 0.1060  data: 0.0002  max mem: 22293
Epoch: [3]  [ 4000/10010]  eta: 0:10:38  lr: 0.001  img/s: 304.9370281427426  loss: 0.5098 (0.6448)  acc1: 84.3750 (84.0235)  acc5: 96.8750 (94.7505)  time: 0.1059  data: 0.0001  max mem: 22293
Epoch: [3]  [ 5000/10010]  eta: 0:08:53  lr: 0.001  img/s: 306.99107967905144  loss: 0.6786 (0.6444)  acc1: 81.2500 (84.0244)  acc5: 93.7500 (94.7411)  time: 0.1054  data: 0.0001  max mem: 22293
Epoch: [3]  [ 6000/10010]  eta: 0:07:06  lr: 0.001  img/s: 295.8592407429451  loss: 0.6954 (0.6456)  acc1: 84.3750 (83.9917)  acc5: 93.7500 (94.7238)  time: 0.1059  data: 0.0001  max mem: 22293
Epoch: [3]  [ 7000/10010]  eta: 0:05:19  lr: 0.001  img/s: 292.8465595074195  loss: 0.5933 (0.6463)  acc1: 84.3750 (84.0027)  acc5: 96.8750 (94.7061)  time: 0.1059  data: 0.0001  max mem: 22293
Epoch: [3]  [ 8000/10010]  eta: 0:03:33  lr: 0.001  img/s: 288.7582625158667  loss: 0.5577 (0.6454)  acc1: 84.3750 (84.0067)  acc5: 93.7500 (94.7284)  time: 0.1054  data: 0.0001  max mem: 22293
Epoch: [3]  [ 9000/10010]  eta: 0:01:47  lr: 0.001  img/s: 301.39816804658255  loss: 0.7375 (0.6476)  acc1: 84.3750 (83.9823)  acc5: 93.7500 (94.6950)  time: 0.1055  data: 0.0001  max mem: 22293
Epoch: [3]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 320.7198468776957  loss: 0.5863 (0.6488)  acc1: 84.3750 (83.9441)  acc5: 93.7500 (94.6877)  time: 0.1041  data: 0.0001  max mem: 22293
Epoch: [3] Total time: 0:17:42
Test:   [  0/391]  eta: 0:09:16  loss: 0.3111 (0.3111)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.4230  data: 1.3860  max mem: 22293
Test:   [100/391]  eta: 0:00:25  loss: 0.6910 (0.6360)  acc1: 84.3750 (84.0347)  acc5: 96.8750 (96.2252)  time: 0.0682  data: 0.0255  max mem: 22293
Test:   [200/391]  eta: 0:00:15  loss: 1.3669 (0.7677)  acc1: 68.7500 (81.0012)  acc5: 90.6250 (95.4136)  time: 0.0841  data: 0.0368  max mem: 22293
Test:   [300/391]  eta: 0:00:06  loss: 1.1132 (0.8972)  acc1: 71.8750 (78.6233)  acc5: 90.6250 (94.1341)  time: 0.0482  data: 0.0087  max mem: 22293
Test:  Total time: 0:00:28
Test:  Acc@1 77.610 Acc@5 93.676
Number of added parameters: 135172
Epoch: [4]  [    0/10010]  eta: 4:49:20  lr: 0.001  img/s: 109.71838145072358  loss: 0.3382 (0.3382)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.7344  data: 1.4427  max mem: 22293
Epoch: [4]  [ 1000/10010]  eta: 0:16:20  lr: 0.001  img/s: 295.07480983159655  loss: 0.5908 (0.6363)  acc1: 84.3750 (84.2782)  acc5: 93.7500 (94.9332)  time: 0.1075  data: 0.0001  max mem: 22293
Epoch: [4]  [ 2000/10010]  eta: 0:14:24  lr: 0.001  img/s: 299.652003072032  loss: 0.5742 (0.6323)  acc1: 84.3750 (84.2547)  acc5: 96.8750 (94.9510)  time: 0.1064  data: 0.0001  max mem: 22293
Epoch: [4]  [ 3000/10010]  eta: 0:12:34  lr: 0.001  img/s: 308.10240871204036  loss: 0.5237 (0.6303)  acc1: 84.3750 (84.3375)  acc5: 96.8750 (94.9246)  time: 0.1061  data: 0.0001  max mem: 22293
Epoch: [4]  [ 4000/10010]  eta: 0:10:45  lr: 0.001  img/s: 300.7916094259494  loss: 0.6202 (0.6321)  acc1: 81.2500 (84.2906)  acc5: 93.7500 (94.8919)  time: 0.1063  data: 0.0001  max mem: 22293
Epoch: [4]  [ 5000/10010]  eta: 0:08:57  lr: 0.001  img/s: 278.5547945774081  loss: 0.6948 (0.6350)  acc1: 84.3750 (84.1919)  acc5: 96.8750 (94.8442)  time: 0.1075  data: 0.0001  max mem: 22293
Epoch: [4]  [ 6000/10010]  eta: 0:07:10  lr: 0.001  img/s: 298.63856601221096  loss: 0.6355 (0.6368)  acc1: 84.3750 (84.1844)  acc5: 93.7500 (94.8113)  time: 0.1070  data: 0.0001  max mem: 22293
Epoch: [4]  [ 7000/10010]  eta: 0:05:22  lr: 0.001  img/s: 302.3459759732024  loss: 0.5463 (0.6368)  acc1: 84.3750 (84.1822)  acc5: 96.8750 (94.8030)  time: 0.1064  data: 0.0001  max mem: 22293
Epoch: [4]  [ 8000/10010]  eta: 0:03:35  lr: 0.001  img/s: 303.0867589807513  loss: 0.5110 (0.6374)  acc1: 84.3750 (84.1797)  acc5: 96.8750 (94.7776)  time: 0.1062  data: 0.0001  max mem: 22293
Epoch: [4]  [ 9000/10010]  eta: 0:01:48  lr: 0.001  img/s: 300.3789556607912  loss: 0.5967 (0.6380)  acc1: 84.3750 (84.1788)  acc5: 93.7500 (94.7756)  time: 0.1068  data: 0.0001  max mem: 22293
Epoch: [4]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 292.65244589806485  loss: 0.6162 (0.6397)  acc1: 84.3750 (84.1378)  acc5: 96.8750 (94.7602)  time: 0.1062  data: 0.0001  max mem: 22293
Epoch: [4] Total time: 0:17:52
Test:   [  0/391]  eta: 0:09:30  loss: 0.3124 (0.3124)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.4587  data: 1.4211  max mem: 22293
Test:   [100/391]  eta: 0:00:26  loss: 0.6905 (0.6358)  acc1: 84.3750 (84.0347)  acc5: 96.8750 (96.2252)  time: 0.0748  data: 0.0326  max mem: 22293
Test:   [200/391]  eta: 0:00:14  loss: 1.3743 (0.7675)  acc1: 65.6250 (80.9857)  acc5: 90.6250 (95.4136)  time: 0.0604  data: 0.0195  max mem: 22293
Test:   [300/391]  eta: 0:00:06  loss: 1.1118 (0.8969)  acc1: 71.8750 (78.6233)  acc5: 90.6250 (94.1445)  time: 0.0525  data: 0.0135  max mem: 22293
Test:  Total time: 0:00:28
Test:  Acc@1 77.616 Acc@5 93.678
Number of added parameters: 135172
Training time 1:29:46
Experiment with model=resnext50_32x4d, n_components=4, and dof=16 completed
-----------------------------------
Running experiment with n_components=4 and dof=16
[2024-11-09 23:01:08,450] torch.distributed.run: [WARNING] 
[2024-11-09 23:01:08,450] torch.distributed.run: [WARNING] *****************************************
[2024-11-09 23:01:08,450] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-09 23:01:08,450] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 3): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='vit_b_16', device='cuda', n_components=4, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.0003, momentum=0.9, weight_decay=2e-05, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.11, mixup_alpha=0.2, cutmix_alpha=1.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='vit_b_16', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment='ra', ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=True, world_size=4, dist_url='env://', model_ema=True, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=True, ra_reps=12, weights='ViT_B_16_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.566706895828247
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 67076
Start training
Epoch: [0]  [    0/10008]  eta: 13:56:56  lr: 0.0003  img/s: 15.960347461528098  loss: 1.4228 (1.4228)  acc1: 90.6250 (90.6250)  acc5: 100.0000 (100.0000)  time: 5.0177  data: 3.0127  max mem: 3444
Epoch: [0]  [ 1000/10008]  eta: 0:17:41  lr: 0.0003  img/s: 297.93190646795324  loss: 1.8759 (1.9530)  acc1: 84.3750 (81.5684)  acc5: 93.7500 (93.8718)  time: 0.1121  data: 0.0001  max mem: 3781
Epoch: [0]  [ 2000/10008]  eta: 0:15:25  lr: 0.0003  img/s: 293.7586244632281  loss: 1.8189 (1.9493)  acc1: 78.1250 (81.6014)  acc5: 96.8750 (93.9202)  time: 0.1132  data: 0.0001  max mem: 3781
Epoch: [0]  [ 3000/10008]  eta: 0:13:24  lr: 0.0003  img/s: 287.4287476443378  loss: 1.8336 (1.9445)  acc1: 81.2500 (81.6072)  acc5: 93.7500 (93.9583)  time: 0.1112  data: 0.0001  max mem: 3781
Epoch: [0]  [ 4000/10008]  eta: 0:11:27  lr: 0.0003  img/s: 255.45720800453748  loss: 1.9753 (1.9519)  acc1: 78.1250 (81.3711)  acc5: 93.7500 (93.8656)  time: 0.1157  data: 0.0001  max mem: 3781
Epoch: [0]  [ 5000/10008]  eta: 0:09:32  lr: 0.0003  img/s: 287.97699921256634  loss: 1.7365 (1.9502)  acc1: 84.3750 (81.3406)  acc5: 93.7500 (93.8625)  time: 0.1167  data: 0.0002  max mem: 3781
Epoch: [0]  [ 6000/10008]  eta: 0:07:37  lr: 0.0003  img/s: 293.531199426137  loss: 1.8720 (1.9481)  acc1: 81.2500 (81.3864)  acc5: 96.8750 (93.9156)  time: 0.1134  data: 0.0001  max mem: 3781
Epoch: [0]  [ 7000/10008]  eta: 0:05:42  lr: 0.0003  img/s: 293.52542202374576  loss: 1.8526 (1.9495)  acc1: 84.3750 (81.3214)  acc5: 96.8750 (93.8964)  time: 0.1120  data: 0.0001  max mem: 3781
Epoch: [0]  [ 8000/10008]  eta: 0:03:48  lr: 0.0003  img/s: 269.77515944178793  loss: 1.8270 (1.9470)  acc1: 81.2500 (81.3547)  acc5: 93.7500 (93.9242)  time: 0.1119  data: 0.0001  max mem: 3781
Epoch: [0]  [ 9000/10008]  eta: 0:01:54  lr: 0.0003  img/s: 296.8578101776488  loss: 1.9045 (1.9475)  acc1: 84.3750 (81.3614)  acc5: 96.8750 (93.9260)  time: 0.1119  data: 0.0001  max mem: 3781
Epoch: [0]  [10000/10008]  eta: 0:00:00  lr: 0.0003  img/s: 316.3132643129344  loss: 2.1026 (1.9499)  acc1: 75.0000 (81.2422)  acc5: 90.6250 (93.9084)  time: 0.1047  data: 0.0001  max mem: 3781
Epoch: [0] Total time: 0:18:58
Test:   [  0/391]  eta: 0:19:07  loss: 1.1718 (1.1718)  acc1: 100.0000 (100.0000)  acc5: 100.0000 (100.0000)  time: 2.9357  data: 1.9233  max mem: 3781
Test:   [100/391]  eta: 0:00:31  loss: 1.5435 (1.5818)  acc1: 87.5000 (86.4480)  acc5: 96.8750 (97.2153)  time: 0.0839  data: 0.0045  max mem: 3781
Test:   [200/391]  eta: 0:00:18  loss: 2.0456 (1.6566)  acc1: 75.0000 (84.1107)  acc5: 93.7500 (96.5330)  time: 0.0815  data: 0.0016  max mem: 3781
Test:   [300/391]  eta: 0:00:08  loss: 1.9415 (1.7317)  acc1: 71.8750 (81.9871)  acc5: 90.6250 (95.4734)  time: 0.0812  data: 0.0012  max mem: 3781
Test:  Total time: 0:00:34
Test:  Acc@1 81.082 Acc@5 95.316
Test: EMA  [  0/391]  eta: 0:10:12  loss: 1.1718 (1.1718)  acc1: 100.0000 (100.0000)  acc5: 100.0000 (100.0000)  time: 1.5663  data: 1.4767  max mem: 3781
Test: EMA  [100/391]  eta: 0:00:32  loss: 1.5435 (1.5818)  acc1: 87.5000 (86.4480)  acc5: 96.8750 (97.2153)  time: 0.0816  data: 0.0022  max mem: 3781
Test: EMA  [200/391]  eta: 0:00:18  loss: 2.0456 (1.6567)  acc1: 75.0000 (84.1107)  acc5: 93.7500 (96.5330)  time: 0.0815  data: 0.0016  max mem: 3781
Test: EMA  [300/391]  eta: 0:00:08  loss: 1.9417 (1.7317)  acc1: 71.8750 (81.9871)  acc5: 90.6250 (95.4734)  time: 0.0809  data: 0.0014  max mem: 3781
Test: EMA Total time: 0:00:34
Test: EMA Acc@1 81.086 Acc@5 95.316
Experiment with model=vit_b_16, n_components=4, and dof=16 completed

************************************

Running experiment with n_components=16 and dof=16
[2024-11-13 08:34:35,435] torch.distributed.run: [WARNING] 
[2024-11-13 08:34:35,435] torch.distributed.run: [WARNING] *****************************************
[2024-11-13 08:34:35,435] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-13 08:34:35,435] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='mobilenet_v2', device='cuda', n_components=16, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='mobilenet_v2', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='MobileNet_V2_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.4323821067810059
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 328720
Start training
Epoch: [0]  [    0/10010]  eta: 10:59:15  lr: 0.01  img/s: 17.816920148129054  loss: 0.9744 (0.9744)  acc1: 78.1250 (78.1250)  acc5: 96.8750 (96.8750)  time: 3.9516  data: 2.1555  max mem: 2681
Epoch: [0]  [ 1000/10010]  eta: 0:10:05  lr: 0.01  img/s: 577.5662284570863  loss: 1.0402 (1.1403)  acc1: 71.8750 (73.0020)  acc5: 93.7500 (89.5199)  time: 0.0662  data: 0.0001  max mem: 2681
Epoch: [0]  [ 2000/10010]  eta: 0:08:42  lr: 0.01  img/s: 726.514425523162  loss: 1.0632 (1.1389)  acc1: 71.8750 (72.8386)  acc5: 90.6250 (89.4959)  time: 0.0628  data: 0.0001  max mem: 2681
Epoch: [0]  [ 3000/10010]  eta: 0:07:33  lr: 0.01  img/s: 621.9225526038988  loss: 1.0466 (1.1374)  acc1: 75.0000 (72.8476)  acc5: 90.6250 (89.4421)  time: 0.0646  data: 0.0001  max mem: 2681
Epoch: [0]  [ 4000/10010]  eta: 0:06:27  lr: 0.01  img/s: 451.0519615816323  loss: 0.9814 (1.1329)  acc1: 75.0000 (72.9036)  acc5: 90.6250 (89.4792)  time: 0.0624  data: 0.0001  max mem: 2681
Epoch: [0]  [ 5000/10010]  eta: 0:05:22  lr: 0.01  img/s: 505.7072108392425  loss: 1.1806 (1.1337)  acc1: 68.7500 (72.8992)  acc5: 87.5000 (89.4890)  time: 0.0671  data: 0.0001  max mem: 2681
Epoch: [0]  [ 6000/10010]  eta: 0:04:17  lr: 0.01  img/s: 596.7831677797441  loss: 1.3305 (1.1349)  acc1: 68.7500 (72.8894)  acc5: 87.5000 (89.4710)  time: 0.0594  data: 0.0001  max mem: 2681
Epoch: [0]  [ 7000/10010]  eta: 0:03:13  lr: 0.01  img/s: 568.8059534505263  loss: 1.0453 (1.1334)  acc1: 71.8750 (72.9507)  acc5: 90.6250 (89.4948)  time: 0.0621  data: 0.0001  max mem: 2681
Epoch: [0]  [ 8000/10010]  eta: 0:02:08  lr: 0.01  img/s: 361.3666795003998  loss: 1.0979 (1.1329)  acc1: 71.8750 (72.9124)  acc5: 90.6250 (89.4833)  time: 0.0647  data: 0.0001  max mem: 2681
Epoch: [0]  [ 9000/10010]  eta: 0:01:04  lr: 0.01  img/s: 527.471372148317  loss: 1.1204 (1.1324)  acc1: 75.0000 (72.9218)  acc5: 93.7500 (89.4654)  time: 0.0655  data: 0.0001  max mem: 2681
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 692.6365634901795  loss: 0.9526 (1.1317)  acc1: 75.0000 (72.9155)  acc5: 90.6250 (89.4611)  time: 0.0461  data: 0.0001  max mem: 2681
Epoch: [0] Total time: 0:10:42
Test:   [  0/391]  eta: 0:10:49  loss: 0.4450 (0.4450)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.6605  data: 1.6377  max mem: 2681
Test:   [100/391]  eta: 0:00:24  loss: 0.8269 (0.8509)  acc1: 75.0000 (78.3416)  acc5: 93.7500 (93.7809)  time: 0.0673  data: 0.0448  max mem: 2681
Test:   [200/391]  eta: 0:00:14  loss: 1.6027 (0.9583)  acc1: 59.3750 (75.4198)  acc5: 84.3750 (92.7861)  time: 0.0563  data: 0.0374  max mem: 2681
Test:   [300/391]  eta: 0:00:06  loss: 1.3956 (1.1055)  acc1: 68.7500 (72.6640)  acc5: 84.3750 (90.8742)  time: 0.0601  data: 0.0403  max mem: 2681
Test:  Total time: 0:00:27
Test:  Acc@1 71.844 Acc@5 90.270
Number of added parameters: 328720
Epoch: [1]  [    0/10010]  eta: 4:46:03  lr: 0.01  img/s: 192.41416049980933  loss: 0.6069 (0.6069)  acc1: 84.3750 (84.3750)  acc5: 93.7500 (93.7500)  time: 1.7147  data: 1.5484  max mem: 2681
Epoch: [1]  [ 1000/10010]  eta: 0:10:00  lr: 0.01  img/s: 556.0548026929052  loss: 1.0770 (1.1378)  acc1: 71.8750 (72.7335)  acc5: 90.6250 (89.4075)  time: 0.0603  data: 0.0001  max mem: 2681
Epoch: [1]  [ 2000/10010]  eta: 0:08:45  lr: 0.01  img/s: 525.772897675858  loss: 1.0762 (1.1332)  acc1: 71.8750 (72.7808)  acc5: 87.5000 (89.4974)  time: 0.0639  data: 0.0001  max mem: 2681
Epoch: [1]  [ 3000/10010]  eta: 0:07:37  lr: 0.01  img/s: 436.47048034678886  loss: 1.0792 (1.1362)  acc1: 71.8750 (72.6924)  acc5: 87.5000 (89.4639)  time: 0.0632  data: 0.0001  max mem: 2681
Epoch: [1]  [ 4000/10010]  eta: 0:06:31  lr: 0.01  img/s: 358.3602192597181  loss: 1.1257 (1.1351)  acc1: 75.0000 (72.7576)  acc5: 87.5000 (89.4690)  time: 0.0646  data: 0.0002  max mem: 2681
Epoch: [1]  [ 5000/10010]  eta: 0:05:26  lr: 0.01  img/s: 462.90275497675447  loss: 1.0468 (1.1335)  acc1: 75.0000 (72.7636)  acc5: 87.5000 (89.5040)  time: 0.0675  data: 0.0001  max mem: 2681
Epoch: [1]  [ 6000/10010]  eta: 0:04:20  lr: 0.01  img/s: 523.0559580363441  loss: 0.8873 (1.1341)  acc1: 75.0000 (72.7363)  acc5: 93.7500 (89.5101)  time: 0.0653  data: 0.0001  max mem: 2681
Epoch: [1]  [ 7000/10010]  eta: 0:03:15  lr: 0.01  img/s: 589.2660962106677  loss: 1.0402 (1.1347)  acc1: 71.8750 (72.7561)  acc5: 90.6250 (89.5069)  time: 0.0654  data: 0.0006  max mem: 2681
Epoch: [1]  [ 8000/10010]  eta: 0:02:10  lr: 0.01  img/s: 553.247023907667  loss: 1.1846 (1.1351)  acc1: 75.0000 (72.7534)  acc5: 87.5000 (89.5119)  time: 0.0638  data: 0.0001  max mem: 2681
Epoch: [1]  [ 9000/10010]  eta: 0:01:05  lr: 0.01  img/s: 429.06286123471943  loss: 1.3076 (1.1359)  acc1: 71.8750 (72.7301)  acc5: 87.5000 (89.4914)  time: 0.0656  data: 0.0001  max mem: 2681
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 677.0944679305439  loss: 1.0299 (1.1353)  acc1: 68.7500 (72.7452)  acc5: 90.6250 (89.5007)  time: 0.0469  data: 0.0001  max mem: 2681
Epoch: [1] Total time: 0:10:50
Test:   [  0/391]  eta: 0:09:39  loss: 0.4509 (0.4509)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.4818  data: 1.4640  max mem: 2681
Test:   [100/391]  eta: 0:00:23  loss: 0.8308 (0.8530)  acc1: 75.0000 (78.2178)  acc5: 93.7500 (93.7191)  time: 0.0540  data: 0.0249  max mem: 2681
Test:   [200/391]  eta: 0:00:14  loss: 1.5878 (0.9596)  acc1: 59.3750 (75.4975)  acc5: 84.3750 (92.7861)  time: 0.0691  data: 0.0442  max mem: 2681
Test:   [300/391]  eta: 0:00:06  loss: 1.4164 (1.1052)  acc1: 68.7500 (72.8301)  acc5: 84.3750 (90.8949)  time: 0.0812  data: 0.0536  max mem: 2681
Test:  Total time: 0:00:27
Test:  Acc@1 71.942 Acc@5 90.266
Number of added parameters: 328720
Epoch: [2]  [    0/10010]  eta: 5:28:51  lr: 0.01  img/s: 221.35757059994492  loss: 1.5312 (1.5312)  acc1: 71.8750 (71.8750)  acc5: 84.3750 (84.3750)  time: 1.9712  data: 1.8266  max mem: 2704
Epoch: [2]  [ 1000/10010]  eta: 0:10:05  lr: 0.01  img/s: 569.3319420053787  loss: 1.1209 (1.1179)  acc1: 71.8750 (72.9052)  acc5: 90.6250 (89.6198)  time: 0.0608  data: 0.0001  max mem: 2708
Epoch: [2]  [ 2000/10010]  eta: 0:08:49  lr: 0.01  img/s: 502.403988755423  loss: 1.0715 (1.1272)  acc1: 68.7500 (72.6652)  acc5: 87.5000 (89.5365)  time: 0.0626  data: 0.0001  max mem: 2708
Epoch: [2]  [ 3000/10010]  eta: 0:07:40  lr: 0.01  img/s: 505.3644695127002  loss: 0.9748 (1.1297)  acc1: 75.0000 (72.6622)  acc5: 87.5000 (89.4441)  time: 0.0642  data: 0.0001  max mem: 2708
Epoch: [2]  [ 4000/10010]  eta: 0:06:33  lr: 0.01  img/s: 595.4487813101692  loss: 1.1165 (1.1293)  acc1: 75.0000 (72.7584)  acc5: 87.5000 (89.5026)  time: 0.0647  data: 0.0001  max mem: 2708
Epoch: [2]  [ 5000/10010]  eta: 0:05:27  lr: 0.01  img/s: 677.4191216922137  loss: 1.1712 (1.1302)  acc1: 68.7500 (72.7361)  acc5: 90.6250 (89.5165)  time: 0.0636  data: 0.0001  max mem: 2708
Epoch: [2]  [ 6000/10010]  eta: 0:04:22  lr: 0.01  img/s: 409.05073753504814  loss: 0.9779 (1.1284)  acc1: 75.0000 (72.8144)  acc5: 90.6250 (89.5273)  time: 0.0675  data: 0.0002  max mem: 2708
Epoch: [2]  [ 7000/10010]  eta: 0:03:16  lr: 0.01  img/s: 496.8505906262378  loss: 0.9802 (1.1283)  acc1: 75.0000 (72.8499)  acc5: 90.6250 (89.5127)  time: 0.0679  data: 0.0002  max mem: 2708
Epoch: [2]  [ 8000/10010]  eta: 0:02:11  lr: 0.01  img/s: 607.7793083461258  loss: 1.0281 (1.1292)  acc1: 75.0000 (72.8253)  acc5: 90.6250 (89.4935)  time: 0.0630  data: 0.0001  max mem: 2708
Epoch: [2]  [ 9000/10010]  eta: 0:01:06  lr: 0.01  img/s: 418.783902350746  loss: 1.0448 (1.1287)  acc1: 75.0000 (72.8030)  acc5: 90.6250 (89.5213)  time: 0.0674  data: 0.0001  max mem: 2708
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 719.8243474436739  loss: 1.0808 (1.1297)  acc1: 71.8750 (72.8033)  acc5: 90.6250 (89.4986)  time: 0.0486  data: 0.0001  max mem: 2708
Epoch: [2] Total time: 0:10:56
Test:   [  0/391]  eta: 0:08:42  loss: 0.4558 (0.4558)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.3371  data: 1.3187  max mem: 2708
Test:   [100/391]  eta: 0:00:25  loss: 0.8363 (0.8528)  acc1: 75.0000 (78.3416)  acc5: 93.7500 (93.8119)  time: 0.0889  data: 0.0643  max mem: 2708
Test:   [200/391]  eta: 0:00:15  loss: 1.5514 (0.9597)  acc1: 62.5000 (75.6063)  acc5: 84.3750 (92.8483)  time: 0.0661  data: 0.0377  max mem: 2708
Test:   [300/391]  eta: 0:00:06  loss: 1.3920 (1.1043)  acc1: 68.7500 (72.9340)  acc5: 84.3750 (90.9468)  time: 0.0602  data: 0.0325  max mem: 2708
Test:  Total time: 0:00:27
Test:  Acc@1 71.892 Acc@5 90.272
Number of added parameters: 328720
Epoch: [3]  [    0/10010]  eta: 5:24:55  lr: 0.01  img/s: 54.13720961562818  loss: 0.8240 (0.8240)  acc1: 78.1250 (78.1250)  acc5: 93.7500 (93.7500)  time: 1.9476  data: 1.3565  max mem: 2751
Epoch: [3]  [ 1000/10010]  eta: 0:10:09  lr: 0.01  img/s: 449.18016371826536  loss: 1.1037 (1.1211)  acc1: 75.0000 (72.8459)  acc5: 90.6250 (89.7727)  time: 0.0640  data: 0.0001  max mem: 2751
Epoch: [3]  [ 2000/10010]  eta: 0:08:53  lr: 0.01  img/s: 476.37677774741167  loss: 1.1714 (1.1218)  acc1: 71.8750 (72.9010)  acc5: 87.5000 (89.7707)  time: 0.0677  data: 0.0001  max mem: 2751
Epoch: [3]  [ 3000/10010]  eta: 0:07:43  lr: 0.01  img/s: 613.6396920319672  loss: 1.0745 (1.1285)  acc1: 71.8750 (72.8288)  acc5: 90.6250 (89.6305)  time: 0.0645  data: 0.0001  max mem: 2751
Epoch: [3]  [ 4000/10010]  eta: 0:06:37  lr: 0.01  img/s: 472.172013959248  loss: 1.1332 (1.1307)  acc1: 71.8750 (72.7529)  acc5: 90.6250 (89.5675)  time: 0.0671  data: 0.0001  max mem: 2751
Epoch: [3]  [ 5000/10010]  eta: 0:05:30  lr: 0.01  img/s: 500.77691506945405  loss: 1.0843 (1.1324)  acc1: 71.8750 (72.7198)  acc5: 90.6250 (89.5421)  time: 0.0655  data: 0.0001  max mem: 2751
Epoch: [3]  [ 6000/10010]  eta: 0:04:23  lr: 0.01  img/s: 548.6986603218988  loss: 1.1412 (1.1360)  acc1: 68.7500 (72.7103)  acc5: 90.6250 (89.4700)  time: 0.0637  data: 0.0005  max mem: 2751
Epoch: [3]  [ 7000/10010]  eta: 0:03:17  lr: 0.01  img/s: 427.75559323330316  loss: 1.0461 (1.1343)  acc1: 71.8750 (72.7548)  acc5: 90.6250 (89.4765)  time: 0.0657  data: 0.0002  max mem: 2751
Epoch: [3]  [ 8000/10010]  eta: 0:02:11  lr: 0.01  img/s: 516.919872597237  loss: 1.0077 (1.1313)  acc1: 75.0000 (72.7936)  acc5: 90.6250 (89.5259)  time: 0.0657  data: 0.0004  max mem: 2751
Epoch: [3]  [ 9000/10010]  eta: 0:01:06  lr: 0.01  img/s: 552.8482257234065  loss: 1.0727 (1.1312)  acc1: 71.8750 (72.7954)  acc5: 90.6250 (89.5394)  time: 0.0679  data: 0.0001  max mem: 2751
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 712.7790889103674  loss: 1.0141 (1.1320)  acc1: 71.8750 (72.7768)  acc5: 90.6250 (89.5273)  time: 0.0497  data: 0.0001  max mem: 2751
Epoch: [3] Total time: 0:10:56
Test:   [  0/391]  eta: 0:09:28  loss: 0.4603 (0.4603)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.4546  data: 1.4362  max mem: 2751
Test:   [100/391]  eta: 0:00:26  loss: 0.8356 (0.8523)  acc1: 75.0000 (78.4035)  acc5: 93.7500 (93.7500)  time: 0.0963  data: 0.0654  max mem: 2751
Test:   [200/391]  eta: 0:00:15  loss: 1.6000 (0.9577)  acc1: 59.3750 (75.6685)  acc5: 84.3750 (92.8016)  time: 0.0661  data: 0.0398  max mem: 2751
Test:   [300/391]  eta: 0:00:06  loss: 1.3715 (1.1046)  acc1: 68.7500 (72.8509)  acc5: 84.3750 (90.9365)  time: 0.0595  data: 0.0306  max mem: 2751
Test:  Total time: 0:00:27
Test:  Acc@1 71.926 Acc@5 90.272
Number of added parameters: 328720
Epoch: [4]  [    0/10010]  eta: 5:47:06  lr: 0.01  img/s: 322.1199702402381  loss: 1.1161 (1.1161)  acc1: 71.8750 (71.8750)  acc5: 93.7500 (93.7500)  time: 2.0806  data: 1.9812  max mem: 2786
Epoch: [4]  [ 1000/10010]  eta: 0:10:05  lr: 0.01  img/s: 521.5113594417224  loss: 1.3258 (1.1326)  acc1: 68.7500 (72.7429)  acc5: 87.5000 (89.5136)  time: 0.0660  data: 0.0002  max mem: 2789
Epoch: [4]  [ 2000/10010]  eta: 0:08:52  lr: 0.01  img/s: 497.4822568329911  loss: 1.0317 (1.1295)  acc1: 71.8750 (72.8807)  acc5: 90.6250 (89.5599)  time: 0.0641  data: 0.0001  max mem: 2789
Epoch: [4]  [ 3000/10010]  eta: 0:07:44  lr: 0.01  img/s: 550.8696105431218  loss: 1.1754 (1.1292)  acc1: 71.8750 (72.8747)  acc5: 90.6250 (89.4920)  time: 0.0653  data: 0.0001  max mem: 2789
Epoch: [4]  [ 4000/10010]  eta: 0:06:36  lr: 0.01  img/s: 407.5787734774753  loss: 0.9382 (1.1278)  acc1: 75.0000 (72.9029)  acc5: 90.6250 (89.5542)  time: 0.0649  data: 0.0004  max mem: 2789
Epoch: [4]  [ 5000/10010]  eta: 0:05:30  lr: 0.01  img/s: 547.0169830006969  loss: 1.0931 (1.1291)  acc1: 71.8750 (72.8054)  acc5: 90.6250 (89.5465)  time: 0.0664  data: 0.0003  max mem: 2789
Epoch: [4]  [ 6000/10010]  eta: 0:04:24  lr: 0.01  img/s: 629.2203199129897  loss: 1.1560 (1.1312)  acc1: 71.8750 (72.7972)  acc5: 87.5000 (89.5205)  time: 0.0659  data: 0.0001  max mem: 2789
Epoch: [4]  [ 7000/10010]  eta: 0:03:18  lr: 0.01  img/s: 478.87870127553293  loss: 1.1640 (1.1307)  acc1: 71.8750 (72.8405)  acc5: 87.5000 (89.4966)  time: 0.0645  data: 0.0001  max mem: 2789
Epoch: [4]  [ 8000/10010]  eta: 0:02:12  lr: 0.01  img/s: 620.9126858559783  loss: 1.0488 (1.1298)  acc1: 75.0000 (72.8077)  acc5: 87.5000 (89.5103)  time: 0.0668  data: 0.0001  max mem: 2789
Epoch: [4]  [ 9000/10010]  eta: 0:01:06  lr: 0.01  img/s: 426.5863866358158  loss: 1.1746 (1.1295)  acc1: 71.8750 (72.8388)  acc5: 87.5000 (89.4973)  time: 0.0663  data: 0.0001  max mem: 2789
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 600.5536176115262  loss: 1.1145 (1.1318)  acc1: 71.8750 (72.7930)  acc5: 87.5000 (89.4723)  time: 0.0515  data: 0.0001  max mem: 2789
Epoch: [4] Total time: 0:10:58
Test:   [  0/391]  eta: 0:07:47  loss: 0.4339 (0.4339)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.1951  data: 1.1592  max mem: 2789
Test:   [100/391]  eta: 0:00:25  loss: 0.8330 (0.8511)  acc1: 75.0000 (78.3106)  acc5: 93.7500 (93.8119)  time: 0.0900  data: 0.0603  max mem: 2789
Test:   [200/391]  eta: 0:00:15  loss: 1.6016 (0.9598)  acc1: 59.3750 (75.5286)  acc5: 84.3750 (92.8016)  time: 0.0583  data: 0.0332  max mem: 2789
Test:   [300/391]  eta: 0:00:06  loss: 1.3852 (1.1057)  acc1: 68.7500 (72.7367)  acc5: 84.3750 (90.9365)  time: 0.0554  data: 0.0235  max mem: 2789
Test:  Total time: 0:00:27
Test:  Acc@1 71.910 Acc@5 90.286
Number of added parameters: 328720
Training time 0:56:45
Experiment with model=mobilenet_v2, n_components=16, and dof=16 completed
-----------------------------------
Running experiment with n_components=16 and dof=16
[2024-11-13 09:31:34,551] torch.distributed.run: [WARNING] 
[2024-11-13 09:31:34,551] torch.distributed.run: [WARNING] *****************************************
[2024-11-13 09:31:34,551] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-13 09:31:34,551] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 3): env://
| distributed init (rank 1): env://
| distributed init (rank 2): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=16, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.5279266834259033
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 540688
Start training
Epoch: [0]  [    0/10010]  eta: 13:50:18  lr: 0.01  img/s: 10.045431837013664  loss: 0.7781 (0.7781)  acc1: 75.0000 (75.0000)  acc5: 93.7500 (93.7500)  time: 4.9768  data: 1.7913  max mem: 21524
Epoch: [0]  [ 1000/10010]  eta: 0:12:49  lr: 0.01  img/s: 404.2751358450102  loss: 0.8035 (0.9182)  acc1: 78.1250 (77.6005)  acc5: 90.6250 (91.8550)  time: 0.0806  data: 0.0001  max mem: 21524
Epoch: [0]  [ 2000/10010]  eta: 0:11:05  lr: 0.01  img/s: 397.2878120976216  loss: 0.8900 (0.9035)  acc1: 78.1250 (77.9407)  acc5: 90.6250 (92.1336)  time: 0.0814  data: 0.0001  max mem: 21524
Epoch: [0]  [ 3000/10010]  eta: 0:09:36  lr: 0.01  img/s: 397.5890917385264  loss: 0.8283 (0.8995)  acc1: 75.0000 (77.9396)  acc5: 93.7500 (92.1214)  time: 0.0805  data: 0.0001  max mem: 21524
Epoch: [0]  [ 4000/10010]  eta: 0:08:12  lr: 0.01  img/s: 393.0436595672405  loss: 0.7215 (0.8930)  acc1: 78.1250 (78.0649)  acc5: 93.7500 (92.2019)  time: 0.0808  data: 0.0001  max mem: 21524
Epoch: [0]  [ 5000/10010]  eta: 0:06:49  lr: 0.01  img/s: 403.293614259444  loss: 0.9499 (0.8944)  acc1: 75.0000 (78.0200)  acc5: 90.6250 (92.1928)  time: 0.0812  data: 0.0002  max mem: 21524
Epoch: [0]  [ 6000/10010]  eta: 0:05:26  lr: 0.01  img/s: 392.0597300928901  loss: 0.9027 (0.8949)  acc1: 78.1250 (77.9828)  acc5: 90.6250 (92.2013)  time: 0.0805  data: 0.0001  max mem: 21524
Epoch: [0]  [ 7000/10010]  eta: 0:04:05  lr: 0.01  img/s: 392.6940696983794  loss: 0.8397 (0.8941)  acc1: 78.1250 (78.0116)  acc5: 90.6250 (92.2234)  time: 0.0806  data: 0.0001  max mem: 21524
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 401.73521902452893  loss: 0.8702 (0.8942)  acc1: 78.1250 (78.0313)  acc5: 93.7500 (92.2244)  time: 0.0805  data: 0.0001  max mem: 21524
Epoch: [0]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 397.78587602100697  loss: 0.8862 (0.8936)  acc1: 78.1250 (78.0500)  acc5: 93.7500 (92.2401)  time: 0.0802  data: 0.0001  max mem: 21524
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 404.61272341952076  loss: 0.8076 (0.8929)  acc1: 81.2500 (78.0716)  acc5: 93.7500 (92.2555)  time: 0.0782  data: 0.0001  max mem: 21524
Epoch: [0] Total time: 0:13:34
Test:   [  0/391]  eta: 0:11:54  loss: 0.3950 (0.3950)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.8265  data: 1.6791  max mem: 21524
Test:   [100/391]  eta: 0:00:27  loss: 0.6456 (0.6894)  acc1: 81.2500 (81.7760)  acc5: 96.8750 (95.9777)  time: 0.0574  data: 0.0208  max mem: 21524
Test:   [200/391]  eta: 0:00:15  loss: 1.1961 (0.7902)  acc1: 68.7500 (79.3066)  acc5: 90.6250 (94.9471)  time: 0.0613  data: 0.0302  max mem: 21524
Test:   [300/391]  eta: 0:00:06  loss: 1.2410 (0.9194)  acc1: 68.7500 (76.7753)  acc5: 87.5000 (93.4282)  time: 0.0403  data: 0.0100  max mem: 21524
Test:  Total time: 0:00:28
Test:  Acc@1 76.224 Acc@5 92.960
Number of added parameters: 540688
Epoch: [1]  [    0/10010]  eta: 5:54:33  lr: 0.01  img/s: 238.17655388786952  loss: 0.4272 (0.4272)  acc1: 93.7500 (93.7500)  acc5: 96.8750 (96.8750)  time: 2.1252  data: 1.9908  max mem: 21524
Epoch: [1]  [ 1000/10010]  eta: 0:12:43  lr: 0.01  img/s: 393.4849838756963  loss: 0.8147 (0.8793)  acc1: 81.2500 (78.2468)  acc5: 93.7500 (92.5231)  time: 0.0824  data: 0.0001  max mem: 21524
Epoch: [1]  [ 2000/10010]  eta: 0:11:09  lr: 0.01  img/s: 395.91082268959616  loss: 0.9081 (0.8823)  acc1: 78.1250 (78.1984)  acc5: 93.7500 (92.4866)  time: 0.0821  data: 0.0001  max mem: 21524
Epoch: [1]  [ 3000/10010]  eta: 0:09:42  lr: 0.01  img/s: 396.3246716432014  loss: 0.7915 (0.8860)  acc1: 75.0000 (78.2156)  acc5: 93.7500 (92.3890)  time: 0.0821  data: 0.0001  max mem: 21524
Epoch: [1]  [ 4000/10010]  eta: 0:08:18  lr: 0.01  img/s: 396.10010388138636  loss: 0.8905 (0.8896)  acc1: 78.1250 (78.1758)  acc5: 90.6250 (92.2996)  time: 0.0823  data: 0.0001  max mem: 21524
Epoch: [1]  [ 5000/10010]  eta: 0:06:55  lr: 0.01  img/s: 389.4658696535314  loss: 0.7591 (0.8900)  acc1: 78.1250 (78.1425)  acc5: 93.7500 (92.3215)  time: 0.0821  data: 0.0001  max mem: 21524
Epoch: [1]  [ 6000/10010]  eta: 0:05:32  lr: 0.01  img/s: 396.01946199216917  loss: 0.7146 (0.8886)  acc1: 78.1250 (78.2130)  acc5: 93.7500 (92.3200)  time: 0.0822  data: 0.0001  max mem: 21524
Epoch: [1]  [ 7000/10010]  eta: 0:04:09  lr: 0.01  img/s: 390.23814757310913  loss: 0.7055 (0.8880)  acc1: 81.2500 (78.2308)  acc5: 93.7500 (92.3551)  time: 0.0828  data: 0.0001  max mem: 21524
Epoch: [1]  [ 8000/10010]  eta: 0:02:46  lr: 0.01  img/s: 392.6308879540841  loss: 1.0096 (0.8894)  acc1: 75.0000 (78.1976)  acc5: 90.6250 (92.3353)  time: 0.0826  data: 0.0001  max mem: 21524
Epoch: [1]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 391.75190377368955  loss: 1.0254 (0.8907)  acc1: 75.0000 (78.1476)  acc5: 90.6250 (92.3092)  time: 0.0818  data: 0.0001  max mem: 21524
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 411.5038079003201  loss: 0.8610 (0.8897)  acc1: 78.1250 (78.1459)  acc5: 93.7500 (92.3201)  time: 0.0801  data: 0.0001  max mem: 21524
Epoch: [1] Total time: 0:13:47
Test:   [  0/391]  eta: 0:09:11  loss: 0.4082 (0.4082)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4109  data: 1.3672  max mem: 21524
Test:   [100/391]  eta: 0:00:26  loss: 0.6444 (0.6915)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.8849)  time: 0.0533  data: 0.0152  max mem: 21524
Test:   [200/391]  eta: 0:00:15  loss: 1.1696 (0.7925)  acc1: 68.7500 (79.4154)  acc5: 87.5000 (94.8539)  time: 0.0630  data: 0.0256  max mem: 21524
Test:   [300/391]  eta: 0:00:06  loss: 1.2588 (0.9199)  acc1: 68.7500 (76.8376)  acc5: 87.5000 (93.3970)  time: 0.0567  data: 0.0208  max mem: 21524
Test:  Total time: 0:00:27
Test:  Acc@1 76.214 Acc@5 92.922
Number of added parameters: 540688
Epoch: [2]  [    0/10010]  eta: 6:43:52  lr: 0.01  img/s: 65.99522753299449  loss: 1.3229 (1.3229)  acc1: 71.8750 (71.8750)  acc5: 87.5000 (87.5000)  time: 2.4208  data: 1.9359  max mem: 21524
Epoch: [2]  [ 1000/10010]  eta: 0:12:59  lr: 0.01  img/s: 378.0557431813893  loss: 0.8666 (0.8693)  acc1: 75.0000 (78.5184)  acc5: 90.6250 (92.5262)  time: 0.0837  data: 0.0001  max mem: 21524
Epoch: [2]  [ 2000/10010]  eta: 0:11:23  lr: 0.01  img/s: 376.5158314935493  loss: 0.7936 (0.8786)  acc1: 78.1250 (78.3327)  acc5: 93.7500 (92.3804)  time: 0.0838  data: 0.0001  max mem: 21524
Epoch: [2]  [ 3000/10010]  eta: 0:09:55  lr: 0.01  img/s: 383.05129983361445  loss: 0.8092 (0.8813)  acc1: 78.1250 (78.2843)  acc5: 93.7500 (92.3213)  time: 0.0845  data: 0.0001  max mem: 21524
Epoch: [2]  [ 4000/10010]  eta: 0:08:29  lr: 0.01  img/s: 376.35429834055844  loss: 0.8435 (0.8862)  acc1: 81.2500 (78.2164)  acc5: 93.7500 (92.2644)  time: 0.0846  data: 0.0001  max mem: 21524
Epoch: [2]  [ 5000/10010]  eta: 0:07:04  lr: 0.01  img/s: 375.2326806302629  loss: 0.9618 (0.8886)  acc1: 75.0000 (78.1450)  acc5: 90.6250 (92.2790)  time: 0.0839  data: 0.0001  max mem: 21524
Epoch: [2]  [ 6000/10010]  eta: 0:05:39  lr: 0.01  img/s: 390.30396649994185  loss: 0.7770 (0.8885)  acc1: 75.0000 (78.1396)  acc5: 93.7500 (92.2820)  time: 0.0840  data: 0.0001  max mem: 21524
Epoch: [2]  [ 7000/10010]  eta: 0:04:14  lr: 0.01  img/s: 384.2642197632306  loss: 0.7731 (0.8880)  acc1: 78.1250 (78.1701)  acc5: 90.6250 (92.2966)  time: 0.0842  data: 0.0001  max mem: 21524
Epoch: [2]  [ 8000/10010]  eta: 0:02:49  lr: 0.01  img/s: 383.388305059086  loss: 0.6631 (0.8883)  acc1: 81.2500 (78.1570)  acc5: 93.7500 (92.3080)  time: 0.0840  data: 0.0001  max mem: 21524
Epoch: [2]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 383.5460694578198  loss: 0.7938 (0.8887)  acc1: 78.1250 (78.1729)  acc5: 93.7500 (92.3081)  time: 0.0844  data: 0.0001  max mem: 21524
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 396.44876089203956  loss: 0.8392 (0.8891)  acc1: 78.1250 (78.1472)  acc5: 93.7500 (92.3136)  time: 0.0822  data: 0.0001  max mem: 21524
Epoch: [2] Total time: 0:14:05
Test:   [  0/391]  eta: 0:10:50  loss: 0.4056 (0.4056)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6639  data: 1.6052  max mem: 21524
Test:   [100/391]  eta: 0:00:26  loss: 0.6375 (0.6925)  acc1: 81.2500 (81.9926)  acc5: 96.8750 (95.9158)  time: 0.0680  data: 0.0323  max mem: 21524
Test:   [200/391]  eta: 0:00:15  loss: 1.2027 (0.7904)  acc1: 68.7500 (79.4310)  acc5: 87.5000 (94.8850)  time: 0.0772  data: 0.0412  max mem: 21524
Test:   [300/391]  eta: 0:00:06  loss: 1.2353 (0.9181)  acc1: 68.7500 (76.8895)  acc5: 87.5000 (93.4697)  time: 0.0551  data: 0.0241  max mem: 21524
Test:  Total time: 0:00:28
Test:  Acc@1 76.238 Acc@5 92.998
Number of added parameters: 540688
Epoch: [3]  [    0/10010]  eta: 4:58:38  lr: 0.01  img/s: 42.12737358906063  loss: 0.8784 (0.8784)  acc1: 75.0000 (75.0000)  acc5: 90.6250 (90.6250)  time: 1.7901  data: 1.0304  max mem: 21524
Epoch: [3]  [ 1000/10010]  eta: 0:13:12  lr: 0.01  img/s: 368.90535336849655  loss: 1.0460 (0.8887)  acc1: 75.0000 (78.1469)  acc5: 90.6250 (92.4544)  time: 0.0853  data: 0.0001  max mem: 21524
Epoch: [3]  [ 2000/10010]  eta: 0:11:36  lr: 0.01  img/s: 373.6032868293009  loss: 0.9030 (0.8955)  acc1: 78.1250 (78.0344)  acc5: 93.7500 (92.2820)  time: 0.0860  data: 0.0001  max mem: 21524
Epoch: [3]  [ 3000/10010]  eta: 0:10:07  lr: 0.01  img/s: 371.03984695936794  loss: 0.9336 (0.9028)  acc1: 75.0000 (77.8824)  acc5: 93.7500 (92.1724)  time: 0.0859  data: 0.0001  max mem: 21524
Epoch: [3]  [ 4000/10010]  eta: 0:08:39  lr: 0.01  img/s: 374.33267141167806  loss: 0.8606 (0.8992)  acc1: 78.1250 (77.9219)  acc5: 96.8750 (92.2371)  time: 0.0858  data: 0.0001  max mem: 21524
Epoch: [3]  [ 5000/10010]  eta: 0:07:12  lr: 0.01  img/s: 370.99369504587054  loss: 0.9253 (0.8995)  acc1: 75.0000 (77.9313)  acc5: 90.6250 (92.2278)  time: 0.0862  data: 0.0001  max mem: 21524
Epoch: [3]  [ 6000/10010]  eta: 0:05:46  lr: 0.01  img/s: 379.23718406962126  loss: 0.8697 (0.8996)  acc1: 75.0000 (77.9261)  acc5: 90.6250 (92.2216)  time: 0.0863  data: 0.0001  max mem: 21524
Epoch: [3]  [ 7000/10010]  eta: 0:04:19  lr: 0.01  img/s: 367.4298854602396  loss: 0.8201 (0.8993)  acc1: 78.1250 (77.9558)  acc5: 90.6250 (92.2123)  time: 0.0860  data: 0.0002  max mem: 21524
Epoch: [3]  [ 8000/10010]  eta: 0:02:53  lr: 0.01  img/s: 377.48264146698165  loss: 0.6580 (0.8980)  acc1: 78.1250 (77.9664)  acc5: 93.7500 (92.2295)  time: 0.0856  data: 0.0001  max mem: 21524
Epoch: [3]  [ 9000/10010]  eta: 0:01:27  lr: 0.01  img/s: 371.8127995301705  loss: 0.8087 (0.8963)  acc1: 78.1250 (78.0083)  acc5: 90.6250 (92.2568)  time: 0.0860  data: 0.0001  max mem: 21524
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 349.4034061030786  loss: 0.9391 (0.8965)  acc1: 78.1250 (78.0025)  acc5: 90.6250 (92.2464)  time: 0.0871  data: 0.0001  max mem: 21524
Epoch: [3] Total time: 0:14:23
Test:   [  0/391]  eta: 0:12:41  loss: 0.4061 (0.4061)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.9488  data: 1.8959  max mem: 21524
Test:   [100/391]  eta: 0:00:26  loss: 0.6612 (0.6927)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.9468)  time: 0.0560  data: 0.0137  max mem: 21524
Test:   [200/391]  eta: 0:00:15  loss: 1.1554 (0.7918)  acc1: 68.7500 (79.3066)  acc5: 87.5000 (94.9160)  time: 0.0712  data: 0.0315  max mem: 21524
Test:   [300/391]  eta: 0:00:07  loss: 1.2531 (0.9204)  acc1: 71.8750 (76.8169)  acc5: 87.5000 (93.4178)  time: 0.0548  data: 0.0154  max mem: 21524
Test:  Total time: 0:00:29
Test:  Acc@1 76.274 Acc@5 92.932
Number of added parameters: 540688
Epoch: [4]  [    0/10010]  eta: 4:50:22  lr: 0.01  img/s: 89.3440523159486  loss: 0.8192 (0.8192)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 1.7405  data: 1.3823  max mem: 21524
Epoch: [4]  [ 1000/10010]  eta: 0:13:42  lr: 0.01  img/s: 366.7852540103298  loss: 0.9280 (0.8915)  acc1: 75.0000 (77.8596)  acc5: 93.7500 (92.3764)  time: 0.0900  data: 0.0002  max mem: 21524
Epoch: [4]  [ 2000/10010]  eta: 0:12:12  lr: 0.01  img/s: 342.2542138627798  loss: 0.8020 (0.8902)  acc1: 78.1250 (78.1547)  acc5: 93.7500 (92.2898)  time: 0.0943  data: 0.0001  max mem: 21524
Epoch: [4]  [ 3000/10010]  eta: 0:10:43  lr: 0.01  img/s: 364.74884842094394  loss: 0.8784 (0.8860)  acc1: 78.1250 (78.1271)  acc5: 90.6250 (92.3505)  time: 0.0886  data: 0.0002  max mem: 21524
Epoch: [4]  [ 4000/10010]  eta: 0:09:11  lr: 0.01  img/s: 364.01779166395454  loss: 0.8190 (0.8825)  acc1: 78.1250 (78.2617)  acc5: 93.7500 (92.3980)  time: 0.0886  data: 0.0001  max mem: 21524
Epoch: [4]  [ 5000/10010]  eta: 0:07:36  lr: 0.01  img/s: 370.45917068956476  loss: 0.7935 (0.8816)  acc1: 78.1250 (78.2487)  acc5: 93.7500 (92.4078)  time: 0.0894  data: 0.0001  max mem: 21524
Epoch: [4]  [ 6000/10010]  eta: 0:06:05  lr: 0.01  img/s: 348.3026459200515  loss: 0.7733 (0.8814)  acc1: 81.2500 (78.3041)  acc5: 93.7500 (92.4226)  time: 0.0925  data: 0.0001  max mem: 21524
Epoch: [4]  [ 7000/10010]  eta: 0:04:33  lr: 0.01  img/s: 370.28031648991936  loss: 0.8502 (0.8830)  acc1: 78.1250 (78.2625)  acc5: 90.6250 (92.3908)  time: 0.0879  data: 0.0001  max mem: 21524
Epoch: [4]  [ 8000/10010]  eta: 0:03:03  lr: 0.01  img/s: 349.1579900313212  loss: 0.6617 (0.8828)  acc1: 84.3750 (78.2828)  acc5: 93.7500 (92.3951)  time: 0.0931  data: 0.0001  max mem: 21524
Epoch: [4]  [ 9000/10010]  eta: 0:01:32  lr: 0.01  img/s: 342.1198637818879  loss: 0.9113 (0.8834)  acc1: 75.0000 (78.2483)  acc5: 90.6250 (92.3828)  time: 0.0924  data: 0.0001  max mem: 21524
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 343.9460624402594  loss: 0.8693 (0.8864)  acc1: 78.1250 (78.2019)  acc5: 87.5000 (92.3480)  time: 0.0923  data: 0.0001  max mem: 21524
Epoch: [4] Total time: 0:15:16
Test:   [  0/391]  eta: 0:09:18  loss: 0.3860 (0.3860)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4281  data: 1.3853  max mem: 21524
Test:   [100/391]  eta: 0:00:26  loss: 0.6561 (0.6911)  acc1: 81.2500 (82.0235)  acc5: 96.8750 (95.9468)  time: 0.0717  data: 0.0339  max mem: 21524
Test:   [200/391]  eta: 0:00:16  loss: 1.2238 (0.7907)  acc1: 68.7500 (79.4465)  acc5: 87.5000 (94.9316)  time: 0.0640  data: 0.0217  max mem: 21524
Test:   [300/391]  eta: 0:00:07  loss: 1.2396 (0.9190)  acc1: 68.7500 (76.8376)  acc5: 87.5000 (93.4593)  time: 0.0533  data: 0.0123  max mem: 21524
Test:  Total time: 0:00:29
Test:  Acc@1 76.238 Acc@5 92.942
Number of added parameters: 540688
Training time 1:13:34
Experiment with model=resnet50, n_components=16, and dof=16 completed
-----------------------------------
Running experiment with n_components=4 and dof=16
[2024-11-13 10:45:24,060] torch.distributed.run: [WARNING] 
[2024-11-13 10:45:24,060] torch.distributed.run: [WARNING] *****************************************
[2024-11-13 10:45:24,060] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-13 10:45:24,060] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 1): env://
| distributed init (rank 2): env://
| distributed init (rank 3): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnext50_32x4d', device='cuda', n_components=4, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.001, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnext50_32x4d', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNeXt50_32X4D_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.5391311645507812
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 135172
Start training
Epoch: [0]  [    0/10010]  eta: 14:49:58  lr: 0.001  img/s: 9.5952852908478  loss: 0.8118 (0.8118)  acc1: 78.1250 (78.1250)  acc5: 90.6250 (90.6250)  time: 5.3345  data: 1.9995  max mem: 22294
Epoch: [0]  [ 1000/10010]  eta: 0:16:01  lr: 0.001  img/s: 312.50707937609286  loss: 0.4562 (0.6629)  acc1: 87.5000 (83.8536)  acc5: 96.8750 (94.3806)  time: 0.1015  data: 0.0001  max mem: 22294
Epoch: [0]  [ 2000/10010]  eta: 0:13:53  lr: 0.001  img/s: 316.5766311449503  loss: 0.6102 (0.6597)  acc1: 81.2500 (83.8300)  acc5: 93.7500 (94.4153)  time: 0.1013  data: 0.0001  max mem: 22294
Epoch: [0]  [ 3000/10010]  eta: 0:12:04  lr: 0.001  img/s: 317.3205980537719  loss: 0.6226 (0.6594)  acc1: 84.3750 (83.8908)  acc5: 96.8750 (94.4321)  time: 0.1011  data: 0.0001  max mem: 22294
Epoch: [0]  [ 4000/10010]  eta: 0:10:19  lr: 0.001  img/s: 302.3166923444243  loss: 0.6026 (0.6575)  acc1: 87.5000 (83.8986)  acc5: 96.8750 (94.4428)  time: 0.1013  data: 0.0001  max mem: 22294
Epoch: [0]  [ 5000/10010]  eta: 0:08:34  lr: 0.001  img/s: 315.221960224337  loss: 0.6601 (0.6547)  acc1: 84.3750 (83.9020)  acc5: 93.7500 (94.5123)  time: 0.1015  data: 0.0001  max mem: 22294
Epoch: [0]  [ 6000/10010]  eta: 0:06:51  lr: 0.001  img/s: 306.6410968167913  loss: 0.5708 (0.6517)  acc1: 84.3750 (83.9673)  acc5: 93.7500 (94.5764)  time: 0.1022  data: 0.0003  max mem: 22294
Epoch: [0]  [ 7000/10010]  eta: 0:05:08  lr: 0.001  img/s: 320.49009883258634  loss: 0.6268 (0.6509)  acc1: 81.2500 (83.9813)  acc5: 93.7500 (94.5901)  time: 0.1015  data: 0.0001  max mem: 22294
Epoch: [0]  [ 8000/10010]  eta: 0:03:25  lr: 0.001  img/s: 320.073564270963  loss: 0.5339 (0.6490)  acc1: 87.5000 (84.0196)  acc5: 93.7500 (94.6175)  time: 0.1020  data: 0.0001  max mem: 22294
Epoch: [0]  [ 9000/10010]  eta: 0:01:43  lr: 0.001  img/s: 309.5819995617525  loss: 0.6684 (0.6474)  acc1: 84.3750 (84.0653)  acc5: 93.7500 (94.6336)  time: 0.1014  data: 0.0001  max mem: 22294
Epoch: [0]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 315.3300849070346  loss: 0.5822 (0.6458)  acc1: 84.3750 (84.0900)  acc5: 96.8750 (94.6599)  time: 0.1004  data: 0.0001  max mem: 22294
Epoch: [0] Total time: 0:17:04
Test:   [  0/391]  eta: 0:08:57  loss: 0.3084 (0.3084)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.3748  data: 1.3287  max mem: 22294
Test:   [100/391]  eta: 0:00:25  loss: 0.6941 (0.6380)  acc1: 84.3750 (84.1275)  acc5: 96.8750 (96.3800)  time: 0.0753  data: 0.0394  max mem: 22294
Test:   [200/391]  eta: 0:00:15  loss: 1.3297 (0.7692)  acc1: 68.7500 (81.0945)  acc5: 90.6250 (95.4136)  time: 0.0631  data: 0.0237  max mem: 22294
Test:   [300/391]  eta: 0:00:06  loss: 1.1089 (0.8989)  acc1: 75.0000 (78.7375)  acc5: 90.6250 (94.1341)  time: 0.0640  data: 0.0262  max mem: 22294
Test:  Total time: 0:00:28
Test:  Acc@1 77.650 Acc@5 93.672
Number of added parameters: 135172
Epoch: [1]  [    0/10010]  eta: 5:40:47  lr: 0.001  img/s: 116.64229958337606  loss: 0.6493 (0.6493)  acc1: 84.3750 (84.3750)  acc5: 93.7500 (93.7500)  time: 2.0427  data: 1.7683  max mem: 22294
Epoch: [1]  [ 1000/10010]  eta: 0:15:44  lr: 0.001  img/s: 312.5951472636399  loss: 0.5469 (0.6461)  acc1: 87.5000 (83.9816)  acc5: 96.8750 (94.6834)  time: 0.1024  data: 0.0001  max mem: 22294
Epoch: [1]  [ 2000/10010]  eta: 0:13:52  lr: 0.001  img/s: 308.1674905575901  loss: 0.7289 (0.6408)  acc1: 84.3750 (84.0830)  acc5: 93.7500 (94.7651)  time: 0.1025  data: 0.0001  max mem: 22294
Epoch: [1]  [ 3000/10010]  eta: 0:12:05  lr: 0.001  img/s: 313.87075938740145  loss: 0.6296 (0.6398)  acc1: 81.2500 (84.1459)  acc5: 93.7500 (94.7434)  time: 0.1031  data: 0.0001  max mem: 22294
Epoch: [1]  [ 4000/10010]  eta: 0:10:21  lr: 0.001  img/s: 314.5128459887334  loss: 0.5051 (0.6402)  acc1: 84.3750 (84.1321)  acc5: 96.8750 (94.7279)  time: 0.1024  data: 0.0001  max mem: 22294
Epoch: [1]  [ 5000/10010]  eta: 0:08:37  lr: 0.001  img/s: 295.32282750760214  loss: 0.5258 (0.6362)  acc1: 84.3750 (84.2200)  acc5: 96.8750 (94.7942)  time: 0.1035  data: 0.0001  max mem: 22294
Epoch: [1]  [ 6000/10010]  eta: 0:06:54  lr: 0.001  img/s: 296.9399052661155  loss: 0.6404 (0.6385)  acc1: 81.2500 (84.1469)  acc5: 93.7500 (94.7623)  time: 0.1030  data: 0.0001  max mem: 22294
Epoch: [1]  [ 7000/10010]  eta: 0:05:10  lr: 0.001  img/s: 304.0163087056777  loss: 0.6119 (0.6392)  acc1: 84.3750 (84.1621)  acc5: 96.8750 (94.7686)  time: 0.1030  data: 0.0001  max mem: 22294
Epoch: [1]  [ 8000/10010]  eta: 0:03:27  lr: 0.001  img/s: 311.19704146813666  loss: 0.6053 (0.6398)  acc1: 87.5000 (84.1496)  acc5: 93.7500 (94.7569)  time: 0.1028  data: 0.0001  max mem: 22294
Epoch: [1]  [ 9000/10010]  eta: 0:01:44  lr: 0.001  img/s: 309.6162787747089  loss: 0.6554 (0.6402)  acc1: 84.3750 (84.1511)  acc5: 93.7500 (94.7495)  time: 0.1024  data: 0.0001  max mem: 22294
Epoch: [1]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 316.54452617751036  loss: 0.6339 (0.6405)  acc1: 84.3750 (84.1428)  acc5: 93.7500 (94.7543)  time: 0.1011  data: 0.0001  max mem: 22294
Epoch: [1] Total time: 0:17:12
Test:   [  0/391]  eta: 0:10:00  loss: 0.3102 (0.3102)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.5360  data: 1.4851  max mem: 22294
Test:   [100/391]  eta: 0:00:28  loss: 0.6932 (0.6371)  acc1: 84.3750 (84.0656)  acc5: 96.8750 (96.3490)  time: 0.0576  data: 0.0191  max mem: 22294
Test:   [200/391]  eta: 0:00:16  loss: 1.3463 (0.7684)  acc1: 68.7500 (81.0323)  acc5: 90.6250 (95.4291)  time: 0.0629  data: 0.0201  max mem: 22294
Test:   [300/391]  eta: 0:00:07  loss: 1.1110 (0.8979)  acc1: 71.8750 (78.6752)  acc5: 90.6250 (94.1341)  time: 0.0695  data: 0.0281  max mem: 22294
Test:  Total time: 0:00:28
Test:  Acc@1 77.636 Acc@5 93.666
Number of added parameters: 135172
Epoch: [2]  [    0/10010]  eta: 4:49:26  lr: 0.001  img/s: 196.30683004882158  loss: 0.7253 (0.7253)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.7349  data: 1.5719  max mem: 22294
Epoch: [2]  [ 1000/10010]  eta: 0:15:58  lr: 0.001  img/s: 308.2007495040047  loss: 0.4909 (0.6323)  acc1: 87.5000 (84.2564)  acc5: 96.8750 (94.8021)  time: 0.1042  data: 0.0001  max mem: 22294
Epoch: [2]  [ 2000/10010]  eta: 0:14:03  lr: 0.001  img/s: 306.69785339859516  loss: 0.5150 (0.6466)  acc1: 84.3750 (84.0673)  acc5: 96.8750 (94.6699)  time: 0.1041  data: 0.0001  max mem: 22294
Epoch: [2]  [ 3000/10010]  eta: 0:12:16  lr: 0.001  img/s: 308.03806131488716  loss: 0.5133 (0.6425)  acc1: 84.3750 (84.0782)  acc5: 96.8750 (94.7080)  time: 0.1044  data: 0.0001  max mem: 22294
Epoch: [2]  [ 4000/10010]  eta: 0:10:30  lr: 0.001  img/s: 285.1922094589713  loss: 0.6975 (0.6433)  acc1: 81.2500 (84.1102)  acc5: 93.7500 (94.7154)  time: 0.1080  data: 0.0001  max mem: 22294
Epoch: [2]  [ 5000/10010]  eta: 0:08:44  lr: 0.001  img/s: 299.9050977132464  loss: 0.6426 (0.6464)  acc1: 81.2500 (84.0619)  acc5: 93.7500 (94.6711)  time: 0.1038  data: 0.0001  max mem: 22294
Epoch: [2]  [ 6000/10010]  eta: 0:06:59  lr: 0.001  img/s: 306.99388838060383  loss: 0.6630 (0.6478)  acc1: 84.3750 (84.0058)  acc5: 93.7500 (94.6499)  time: 0.1045  data: 0.0004  max mem: 22294
Epoch: [2]  [ 7000/10010]  eta: 0:05:14  lr: 0.001  img/s: 309.6777146865216  loss: 0.5017 (0.6456)  acc1: 84.3750 (84.0465)  acc5: 93.7500 (94.6650)  time: 0.1046  data: 0.0001  max mem: 22294
Epoch: [2]  [ 8000/10010]  eta: 0:03:30  lr: 0.001  img/s: 308.78430055329966  loss: 0.5529 (0.6455)  acc1: 84.3750 (84.0141)  acc5: 93.7500 (94.6776)  time: 0.1049  data: 0.0001  max mem: 22294
Epoch: [2]  [ 9000/10010]  eta: 0:01:45  lr: 0.001  img/s: 306.560552558369  loss: 0.5254 (0.6454)  acc1: 84.3750 (83.9955)  acc5: 96.8750 (94.6888)  time: 0.1048  data: 0.0001  max mem: 22294
Epoch: [2]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 314.5939367801274  loss: 0.6024 (0.6450)  acc1: 81.2500 (84.0178)  acc5: 93.7500 (94.6890)  time: 0.1030  data: 0.0001  max mem: 22294
Epoch: [2] Total time: 0:17:26
Test:   [  0/391]  eta: 0:09:15  loss: 0.3114 (0.3114)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.4209  data: 1.3832  max mem: 22294
Test:   [100/391]  eta: 0:00:27  loss: 0.6939 (0.6364)  acc1: 84.3750 (84.0347)  acc5: 96.8750 (96.2562)  time: 0.0700  data: 0.0313  max mem: 22294
Test:   [200/391]  eta: 0:00:15  loss: 1.3593 (0.7678)  acc1: 68.7500 (81.0323)  acc5: 90.6250 (95.4291)  time: 0.0502  data: 0.0131  max mem: 22294
Test:   [300/391]  eta: 0:00:06  loss: 1.1139 (0.8974)  acc1: 71.8750 (78.6337)  acc5: 90.6250 (94.1549)  time: 0.0663  data: 0.0241  max mem: 22294
Test:  Total time: 0:00:28
Test:  Acc@1 77.614 Acc@5 93.680
Number of added parameters: 135172
Epoch: [3]  [    0/10010]  eta: 4:50:43  lr: 0.001  img/s: 95.35516029202391  loss: 0.5335 (0.5335)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.7426  data: 1.4070  max mem: 22294
Epoch: [3]  [ 1000/10010]  eta: 0:16:08  lr: 0.001  img/s: 309.5441584140148  loss: 0.6260 (0.6438)  acc1: 81.2500 (84.2002)  acc5: 93.7500 (94.7709)  time: 0.1051  data: 0.0001  max mem: 22294
Epoch: [3]  [ 2000/10010]  eta: 0:14:13  lr: 0.001  img/s: 304.6000054466725  loss: 0.7486 (0.6434)  acc1: 84.3750 (83.9955)  acc5: 93.7500 (94.7667)  time: 0.1060  data: 0.0001  max mem: 22294
Epoch: [3]  [ 3000/10010]  eta: 0:12:24  lr: 0.001  img/s: 306.9728243716122  loss: 0.6648 (0.6429)  acc1: 84.3750 (84.0126)  acc5: 93.7500 (94.7684)  time: 0.1051  data: 0.0001  max mem: 22294
Epoch: [3]  [ 4000/10010]  eta: 0:10:37  lr: 0.001  img/s: 297.74948865728726  loss: 0.4237 (0.6446)  acc1: 87.5000 (83.9353)  acc5: 96.8750 (94.7302)  time: 0.1054  data: 0.0001  max mem: 22294
Epoch: [3]  [ 5000/10010]  eta: 0:08:51  lr: 0.001  img/s: 306.19827712074755  loss: 0.5978 (0.6454)  acc1: 84.3750 (83.9820)  acc5: 93.7500 (94.7211)  time: 0.1056  data: 0.0001  max mem: 22294
Epoch: [3]  [ 6000/10010]  eta: 0:07:05  lr: 0.001  img/s: 289.20375613561043  loss: 0.6251 (0.6419)  acc1: 84.3750 (84.0516)  acc5: 93.7500 (94.7727)  time: 0.1069  data: 0.0001  max mem: 22294
Epoch: [3]  [ 7000/10010]  eta: 0:05:20  lr: 0.001  img/s: 305.1630496813491  loss: 0.6244 (0.6432)  acc1: 84.3750 (84.0505)  acc5: 93.7500 (94.7400)  time: 0.1081  data: 0.0001  max mem: 22294
Epoch: [3]  [ 8000/10010]  eta: 0:03:34  lr: 0.001  img/s: 307.05077564690623  loss: 0.5525 (0.6423)  acc1: 84.3750 (84.0797)  acc5: 96.8750 (94.7479)  time: 0.1055  data: 0.0001  max mem: 22294
Epoch: [3]  [ 9000/10010]  eta: 0:01:47  lr: 0.001  img/s: 296.5279178845461  loss: 0.6127 (0.6409)  acc1: 84.3750 (84.0917)  acc5: 93.7500 (94.7617)  time: 0.1062  data: 0.0001  max mem: 22294
Epoch: [3]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 314.12051553895446  loss: 0.6604 (0.6417)  acc1: 81.2500 (84.0838)  acc5: 93.7500 (94.7555)  time: 0.1042  data: 0.0001  max mem: 22294
Epoch: [3] Total time: 0:17:45
Test:   [  0/391]  eta: 0:11:55  loss: 0.3121 (0.3121)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.8294  data: 1.7876  max mem: 22294
Test:   [100/391]  eta: 0:00:25  loss: 0.6925 (0.6360)  acc1: 84.3750 (84.0347)  acc5: 96.8750 (96.2252)  time: 0.0700  data: 0.0285  max mem: 22294
Test:   [200/391]  eta: 0:00:15  loss: 1.3707 (0.7675)  acc1: 68.7500 (81.0168)  acc5: 90.6250 (95.4291)  time: 0.0638  data: 0.0196  max mem: 22294
Test:   [300/391]  eta: 0:00:06  loss: 1.1178 (0.8971)  acc1: 71.8750 (78.6337)  acc5: 90.6250 (94.1445)  time: 0.0616  data: 0.0158  max mem: 22294
Test:  Total time: 0:00:28
Test:  Acc@1 77.620 Acc@5 93.680
Number of added parameters: 135172
Epoch: [4]  [    0/10010]  eta: 6:46:56  lr: 0.001  img/s: 210.81175049593904  loss: 0.3265 (0.3265)  acc1: 93.7500 (93.7500)  acc5: 100.0000 (100.0000)  time: 2.4392  data: 2.2874  max mem: 22294
Epoch: [4]  [ 1000/10010]  eta: 0:16:22  lr: 0.001  img/s: 300.4414876828545  loss: 0.5968 (0.6453)  acc1: 81.2500 (84.1939)  acc5: 93.7500 (94.7115)  time: 0.1064  data: 0.0001  max mem: 22294
Epoch: [4]  [ 2000/10010]  eta: 0:14:24  lr: 0.001  img/s: 303.0491204382117  loss: 0.6249 (0.6430)  acc1: 81.2500 (84.0923)  acc5: 93.7500 (94.7448)  time: 0.1075  data: 0.0001  max mem: 22294
Epoch: [4]  [ 3000/10010]  eta: 0:12:34  lr: 0.001  img/s: 308.34448235064383  loss: 0.6984 (0.6430)  acc1: 84.3750 (84.0959)  acc5: 93.7500 (94.7111)  time: 0.1065  data: 0.0001  max mem: 22294
Epoch: [4]  [ 4000/10010]  eta: 0:10:45  lr: 0.001  img/s: 295.47235871154083  loss: 0.6631 (0.6444)  acc1: 84.3750 (84.1173)  acc5: 93.7500 (94.7084)  time: 0.1070  data: 0.0001  max mem: 22294
Epoch: [4]  [ 5000/10010]  eta: 0:08:59  lr: 0.001  img/s: 304.0562543042517  loss: 0.6603 (0.6424)  acc1: 81.2500 (84.1176)  acc5: 93.7500 (94.7148)  time: 0.1065  data: 0.0001  max mem: 22294
Epoch: [4]  [ 6000/10010]  eta: 0:07:12  lr: 0.001  img/s: 292.66010339872616  loss: 0.5293 (0.6416)  acc1: 84.3750 (84.1329)  acc5: 93.7500 (94.7103)  time: 0.1091  data: 0.0001  max mem: 22294
Epoch: [4]  [ 7000/10010]  eta: 0:05:25  lr: 0.001  img/s: 290.0267904411844  loss: 0.7682 (0.6403)  acc1: 81.2500 (84.1661)  acc5: 93.7500 (94.7476)  time: 0.1078  data: 0.0001  max mem: 22294
Epoch: [4]  [ 8000/10010]  eta: 0:03:37  lr: 0.001  img/s: 300.3285455680539  loss: 0.4369 (0.6387)  acc1: 87.5000 (84.1735)  acc5: 96.8750 (94.7600)  time: 0.1077  data: 0.0001  max mem: 22294
Epoch: [4]  [ 9000/10010]  eta: 0:01:49  lr: 0.001  img/s: 307.2820531605577  loss: 0.7000 (0.6377)  acc1: 81.2500 (84.1827)  acc5: 93.7500 (94.7586)  time: 0.1071  data: 0.0001  max mem: 22294
Epoch: [4]  [10000/10010]  eta: 0:00:01  lr: 0.001  img/s: 303.36283233845575  loss: 0.6897 (0.6392)  acc1: 81.2500 (84.1491)  acc5: 93.7500 (94.7437)  time: 0.1093  data: 0.0001  max mem: 22294
Epoch: [4] Total time: 0:18:02
Test:   [  0/391]  eta: 0:11:16  loss: 0.3132 (0.3132)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.7307  data: 1.6569  max mem: 22294
Test:   [100/391]  eta: 0:00:27  loss: 0.6925 (0.6357)  acc1: 84.3750 (84.0037)  acc5: 96.8750 (96.2252)  time: 0.0980  data: 0.0591  max mem: 22294
Test:   [200/391]  eta: 0:00:15  loss: 1.3753 (0.7673)  acc1: 65.6250 (80.9701)  acc5: 90.6250 (95.4291)  time: 0.0479  data: 0.0055  max mem: 22294
Test:   [300/391]  eta: 0:00:07  loss: 1.1145 (0.8969)  acc1: 71.8750 (78.6130)  acc5: 90.6250 (94.1549)  time: 0.0742  data: 0.0342  max mem: 22294
Test:  Total time: 0:00:29
Test:  Acc@1 77.618 Acc@5 93.676
Number of added parameters: 135172
Training time 1:29:57
Experiment with model=resnext50_32x4d, n_components=4, and dof=16 completed
-----------------------------------
Running experiment with n_components=4 and dof=16
[2024-11-13 12:15:38,273] torch.distributed.run: [WARNING] 
[2024-11-13 12:15:38,273] torch.distributed.run: [WARNING] *****************************************
[2024-11-13 12:15:38,273] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-13 12:15:38,273] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 2): env://
| distributed init (rank 3): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='vit_b_16', device='cuda', n_components=4, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.0003, momentum=0.9, weight_decay=2e-05, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.11, mixup_alpha=0.2, cutmix_alpha=1.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='vit_b_16', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment='ra', ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=True, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=True, ra_reps=12, weights='ViT_B_16_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.6969752311706543
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 67076
Start training
Epoch: [0]  [    0/10008]  eta: 14:11:35  lr: 0.0003  img/s: 13.340875067677112  loss: 1.8311 (1.8311)  acc1: 81.2500 (81.2500)  acc5: 100.0000 (100.0000)  time: 5.1055  data: 2.7068  max mem: 3113
Epoch: [0]  [ 1000/10008]  eta: 0:17:43  lr: 0.0003  img/s: 294.3571339279644  loss: 1.9771 (1.9596)  acc1: 87.5000 (81.1158)  acc5: 96.8750 (93.7500)  time: 0.1116  data: 0.0002  max mem: 3450
Epoch: [0]  [ 2000/10008]  eta: 0:15:33  lr: 0.0003  img/s: 273.3230182116609  loss: 2.0808 (1.9611)  acc1: 78.1250 (80.9845)  acc5: 93.7500 (93.7469)  time: 0.1128  data: 0.0001  max mem: 3450
Epoch: [0]  [ 3000/10008]  eta: 0:13:30  lr: 0.0003  img/s: 244.25650460877716  loss: 1.9259 (1.9520)  acc1: 84.3750 (81.2104)  acc5: 96.8750 (93.8791)  time: 0.1133  data: 0.0001  max mem: 3450
Epoch: [0]  [ 4000/10008]  eta: 0:11:31  lr: 0.0003  img/s: 282.93293983726124  loss: 2.0748 (1.9504)  acc1: 78.1250 (81.2102)  acc5: 93.7500 (93.9023)  time: 0.1137  data: 0.0001  max mem: 3450
Epoch: [0]  [ 5000/10008]  eta: 0:09:34  lr: 0.0003  img/s: 292.42672976323536  loss: 1.8279 (1.9477)  acc1: 84.3750 (81.2444)  acc5: 93.7500 (93.9381)  time: 0.1158  data: 0.0001  max mem: 3450
Epoch: [0]  [ 6000/10008]  eta: 0:07:38  lr: 0.0003  img/s: 279.90833899888634  loss: 1.8436 (1.9465)  acc1: 81.2500 (81.2438)  acc5: 93.7500 (93.9494)  time: 0.1130  data: 0.0001  max mem: 3450
Epoch: [0]  [ 7000/10008]  eta: 0:05:43  lr: 0.0003  img/s: 283.53721515350605  loss: 2.0043 (1.9469)  acc1: 78.1250 (81.2201)  acc5: 93.7500 (93.9464)  time: 0.1122  data: 0.0001  max mem: 3450
Epoch: [0]  [ 8000/10008]  eta: 0:03:48  lr: 0.0003  img/s: 289.0530305640743  loss: 1.8194 (1.9446)  acc1: 81.2500 (81.2855)  acc5: 96.8750 (93.9773)  time: 0.1113  data: 0.0001  max mem: 3450
Epoch: [0]  [ 9000/10008]  eta: 0:01:54  lr: 0.0003  img/s: 292.16574188759415  loss: 1.9576 (1.9453)  acc1: 81.2500 (81.2646)  acc5: 93.7500 (93.9705)  time: 0.1129  data: 0.0001  max mem: 3450
Epoch: [0]  [10000/10008]  eta: 0:00:00  lr: 0.0003  img/s: 305.2518859664085  loss: 1.8233 (1.9469)  acc1: 84.3750 (81.2078)  acc5: 93.7500 (93.9375)  time: 0.1078  data: 0.0001  max mem: 3450
Epoch: [0] Total time: 0:19:04
Test:   [  0/391]  eta: 0:18:10  loss: 1.1718 (1.1718)  acc1: 100.0000 (100.0000)  acc5: 100.0000 (100.0000)  time: 2.7899  data: 1.3971  max mem: 3450
Test:   [100/391]  eta: 0:00:31  loss: 1.5434 (1.5817)  acc1: 87.5000 (86.4480)  acc5: 96.8750 (97.2153)  time: 0.0808  data: 0.0019  max mem: 3450
Test:   [200/391]  eta: 0:00:17  loss: 2.0457 (1.6566)  acc1: 75.0000 (84.0951)  acc5: 93.7500 (96.5330)  time: 0.0802  data: 0.0010  max mem: 3450
Test:   [300/391]  eta: 0:00:08  loss: 1.9414 (1.7317)  acc1: 71.8750 (81.9767)  acc5: 90.6250 (95.4734)  time: 0.0806  data: 0.0011  max mem: 3450
Test:  Total time: 0:00:34
Test:  Acc@1 81.078 Acc@5 95.316
Number of added parameters: 67076
Epoch: [1]  [    0/10008]  eta: 6:02:18  lr: 0.0003  img/s: 65.85068783292031  loss: 1.4918 (1.4918)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 2.1721  data: 1.6861  max mem: 3450
Epoch: [1]  [ 1000/10008]  eta: 0:18:13  lr: 0.0003  img/s: 275.51848521798394  loss: 1.7205 (1.9318)  acc1: 84.3750 (81.4560)  acc5: 93.7500 (94.0372)  time: 0.1138  data: 0.0001  max mem: 3450
Epoch: [1]  [ 2000/10008]  eta: 0:16:00  lr: 0.0003  img/s: 278.3352854322544  loss: 1.8503 (1.9421)  acc1: 90.6250 (81.3031)  acc5: 93.7500 (93.8484)  time: 0.1178  data: 0.0001  max mem: 3450
Epoch: [1]  [ 3000/10008]  eta: 0:13:54  lr: 0.0003  img/s: 260.15573943668795  loss: 1.8287 (1.9384)  acc1: 81.2500 (81.3645)  acc5: 96.8750 (93.9249)  time: 0.1166  data: 0.0001  max mem: 3450
Epoch: [1]  [ 4000/10008]  eta: 0:11:52  lr: 0.0003  img/s: 296.89589665317317  loss: 1.7674 (1.9403)  acc1: 84.3750 (81.3414)  acc5: 96.8750 (93.8992)  time: 0.1146  data: 0.0001  max mem: 3450
Epoch: [1]  [ 5000/10008]  eta: 0:09:52  lr: 0.0003  img/s: 277.038041257116  loss: 1.9476 (1.9425)  acc1: 78.1250 (81.3187)  acc5: 93.7500 (93.9337)  time: 0.1159  data: 0.0002  max mem: 3450
Epoch: [1]  [ 6000/10008]  eta: 0:07:53  lr: 0.0003  img/s: 275.87639410171136  loss: 2.1219 (1.9418)  acc1: 81.2500 (81.3500)  acc5: 93.7500 (93.9302)  time: 0.1133  data: 0.0002  max mem: 3450
Epoch: [1]  [ 7000/10008]  eta: 0:05:54  lr: 0.0003  img/s: 287.2749470259626  loss: 1.8688 (1.9427)  acc1: 81.2500 (81.3375)  acc5: 93.7500 (93.9169)  time: 0.1209  data: 0.0001  max mem: 3450
Epoch: [1]  [ 8000/10008]  eta: 0:03:57  lr: 0.0003  img/s: 252.62230989011817  loss: 1.9473 (1.9437)  acc1: 84.3750 (81.3453)  acc5: 93.7500 (93.9101)  time: 0.1164  data: 0.0001  max mem: 3450
Epoch: [1]  [ 9000/10008]  eta: 0:01:58  lr: 0.0003  img/s: 278.81692540035687  loss: 1.9919 (1.9471)  acc1: 78.1250 (81.2528)  acc5: 93.7500 (93.8739)  time: 0.1165  data: 0.0001  max mem: 3450
Epoch: [1]  [10000/10008]  eta: 0:00:00  lr: 0.0003  img/s: 306.5528505421066  loss: 1.8336 (1.9477)  acc1: 81.2500 (81.2144)  acc5: 93.7500 (93.8756)  time: 0.1058  data: 0.0001  max mem: 3450
Epoch: [1] Total time: 0:19:38
Test:   [  0/391]  eta: 0:11:05  loss: 1.1718 (1.1718)  acc1: 100.0000 (100.0000)  acc5: 100.0000 (100.0000)  time: 1.7029  data: 1.6249  max mem: 3450
Test:   [100/391]  eta: 0:00:30  loss: 1.5433 (1.5817)  acc1: 87.5000 (86.4480)  acc5: 96.8750 (97.2153)  time: 0.0813  data: 0.0018  max mem: 3450
Test:   [200/391]  eta: 0:00:17  loss: 2.0454 (1.6566)  acc1: 75.0000 (84.0951)  acc5: 93.7500 (96.5330)  time: 0.0799  data: 0.0003  max mem: 3450
Test:   [300/391]  eta: 0:00:08  loss: 1.9407 (1.7317)  acc1: 71.8750 (81.9664)  acc5: 90.6250 (95.4734)  time: 0.0804  data: 0.0005  max mem: 3450
Test:  Total time: 0:00:33
Test:  Acc@1 81.078 Acc@5 95.314
Number of added parameters: 67076
Epoch: [2]  [    0/10008]  eta: 8:30:17  lr: 0.0003  img/s: 145.76256004309312  loss: 1.8892 (1.8892)  acc1: 81.2500 (81.2500)  acc5: 96.8750 (96.8750)  time: 3.0593  data: 2.8398  max mem: 3452
Epoch: [2]  [ 1000/10008]  eta: 0:18:08  lr: 0.0003  img/s: 286.0730007907531  loss: 1.7961 (1.9412)  acc1: 84.3750 (81.2125)  acc5: 93.7500 (93.9498)  time: 0.1147  data: 0.0002  max mem: 3452
Epoch: [2]  [ 2000/10008]  eta: 0:15:56  lr: 0.0003  img/s: 259.47124348024454  loss: 1.8321 (1.9430)  acc1: 84.3750 (81.3359)  acc5: 96.8750 (93.8921)  time: 0.1199  data: 0.0001  max mem: 3452
Epoch: [2]  [ 3000/10008]  eta: 0:13:56  lr: 0.0003  img/s: 272.2783932422207  loss: 1.8051 (1.9398)  acc1: 81.2500 (81.3687)  acc5: 93.7500 (93.9479)  time: 0.1222  data: 0.0002  max mem: 3452
Epoch: [2]  [ 4000/10008]  eta: 0:11:54  lr: 0.0003  img/s: 254.17135931522932  loss: 1.8714 (1.9381)  acc1: 81.2500 (81.4187)  acc5: 93.7500 (93.9781)  time: 0.1196  data: 0.0001  max mem: 3452
Epoch: [2]  [ 5000/10008]  eta: 0:09:55  lr: 0.0003  img/s: 256.69131495803975  loss: 1.9060 (1.9417)  acc1: 84.3750 (81.3519)  acc5: 93.7500 (93.9106)  time: 0.1213  data: 0.0001  max mem: 3452
Epoch: [2]  [ 6000/10008]  eta: 0:07:56  lr: 0.0003  img/s: 267.77458831603604  loss: 1.9451 (1.9419)  acc1: 81.2500 (81.3557)  acc5: 90.6250 (93.9479)  time: 0.1228  data: 0.0001  max mem: 3452
Epoch: [2]  [ 7000/10008]  eta: 0:05:57  lr: 0.0003  img/s: 277.48536365008385  loss: 2.0729 (1.9433)  acc1: 78.1250 (81.3411)  acc5: 90.6250 (93.9437)  time: 0.1155  data: 0.0001  max mem: 3452
Epoch: [2]  [ 8000/10008]  eta: 0:03:58  lr: 0.0003  img/s: 257.60620629957833  loss: 1.9033 (1.9433)  acc1: 81.2500 (81.3320)  acc5: 96.8750 (93.9273)  time: 0.1225  data: 0.0001  max mem: 3452
Epoch: [2]  [ 9000/10008]  eta: 0:01:59  lr: 0.0003  img/s: 259.1656201002541  loss: 1.8592 (1.9448)  acc1: 84.3750 (81.3115)  acc5: 96.8750 (93.9305)  time: 0.1244  data: 0.0002  max mem: 3452
Epoch: [2]  [10000/10008]  eta: 0:00:00  lr: 0.0003  img/s: 278.0608089630655  loss: 1.7750 (1.9434)  acc1: 87.5000 (81.3175)  acc5: 96.8750 (93.9440)  time: 0.1126  data: 0.0001  max mem: 3452
Epoch: [2] Total time: 0:19:48
Test:   [  0/391]  eta: 0:09:48  loss: 1.1718 (1.1718)  acc1: 100.0000 (100.0000)  acc5: 100.0000 (100.0000)  time: 1.5050  data: 1.4161  max mem: 3452
Test:   [100/391]  eta: 0:00:30  loss: 1.5432 (1.5818)  acc1: 87.5000 (86.4171)  acc5: 96.8750 (97.2153)  time: 0.0805  data: 0.0009  max mem: 3452
Test:   [200/391]  eta: 0:00:17  loss: 2.0455 (1.6566)  acc1: 75.0000 (84.0796)  acc5: 93.7500 (96.5330)  time: 0.0807  data: 0.0005  max mem: 3452
Test:   [300/391]  eta: 0:00:08  loss: 1.9400 (1.7317)  acc1: 71.8750 (81.9560)  acc5: 90.6250 (95.4734)  time: 0.0813  data: 0.0008  max mem: 3452
Test:  Total time: 0:00:34
Test:  Acc@1 81.070 Acc@5 95.316
Number of added parameters: 67076
Epoch: [3]  [    0/10008]  eta: 6:36:30  lr: 0.0003  img/s: 119.14610336290288  loss: 2.0457 (2.0457)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 2.3772  data: 2.1086  max mem: 3452
Epoch: [3]  [ 1000/10008]  eta: 0:18:26  lr: 0.0003  img/s: 263.89228639738263  loss: 1.7170 (1.9342)  acc1: 84.3750 (81.6933)  acc5: 96.8750 (94.1434)  time: 0.1158  data: 0.0001  max mem: 3452
Epoch: [3]  [ 2000/10008]  eta: 0:16:08  lr: 0.0003  img/s: 286.3977500901543  loss: 2.0626 (1.9446)  acc1: 81.2500 (81.1766)  acc5: 93.7500 (94.0139)  time: 0.1215  data: 0.0002  max mem: 3452
Epoch: [3]  [ 3000/10008]  eta: 0:13:58  lr: 0.0003  img/s: 260.7754382760785  loss: 1.9511 (1.9539)  acc1: 81.2500 (81.0917)  acc5: 93.7500 (93.8895)  time: 0.1219  data: 0.0001  max mem: 3452
Epoch: [3]  [ 4000/10008]  eta: 0:11:54  lr: 0.0003  img/s: 289.5056793425509  loss: 1.7490 (1.9505)  acc1: 81.2500 (81.1766)  acc5: 96.8750 (93.9624)  time: 0.1130  data: 0.0001  max mem: 3452
Epoch: [3]  [ 5000/10008]  eta: 0:09:51  lr: 0.0003  img/s: 291.58243610799724  loss: 1.8631 (1.9521)  acc1: 81.2500 (81.1656)  acc5: 93.7500 (93.9412)  time: 0.1138  data: 0.0001  max mem: 3452
Epoch: [3]  [ 6000/10008]  eta: 0:07:51  lr: 0.0003  img/s: 274.6272008708338  loss: 1.6825 (1.9511)  acc1: 84.3750 (81.1781)  acc5: 93.7500 (93.9083)  time: 0.1185  data: 0.0001  max mem: 3452
Epoch: [3]  [ 7000/10008]  eta: 0:05:52  lr: 0.0003  img/s: 275.0363278688525  loss: 1.7737 (1.9506)  acc1: 81.2500 (81.1281)  acc5: 96.8750 (93.8955)  time: 0.1160  data: 0.0001  max mem: 3452
Epoch: [3]  [ 8000/10008]  eta: 0:03:55  lr: 0.0003  img/s: 248.3269341780021  loss: 1.9566 (1.9524)  acc1: 81.2500 (81.1254)  acc5: 93.7500 (93.8750)  time: 0.1169  data: 0.0001  max mem: 3452
Epoch: [3]  [ 9000/10008]  eta: 0:01:57  lr: 0.0003  img/s: 279.52709096967675  loss: 2.0784 (1.9489)  acc1: 78.1250 (81.2052)  acc5: 90.6250 (93.8979)  time: 0.1142  data: 0.0001  max mem: 3452
Epoch: [3]  [10000/10008]  eta: 0:00:00  lr: 0.0003  img/s: 294.2351729006178  loss: 1.9097 (1.9498)  acc1: 81.2500 (81.1881)  acc5: 93.7500 (93.8831)  time: 0.1064  data: 0.0001  max mem: 3452
Epoch: [3] Total time: 0:19:29
Test:   [  0/391]  eta: 0:08:07  loss: 1.1718 (1.1718)  acc1: 100.0000 (100.0000)  acc5: 100.0000 (100.0000)  time: 1.2463  data: 1.1600  max mem: 3452
Test:   [100/391]  eta: 0:00:28  loss: 1.5431 (1.5818)  acc1: 87.5000 (86.4480)  acc5: 96.8750 (97.2153)  time: 0.0805  data: 0.0005  max mem: 3452
Test:   [200/391]  eta: 0:00:16  loss: 2.0455 (1.6566)  acc1: 75.0000 (84.1107)  acc5: 93.7500 (96.5330)  time: 0.0808  data: 0.0003  max mem: 3452
Test:   [300/391]  eta: 0:00:07  loss: 1.9407 (1.7316)  acc1: 71.8750 (81.9664)  acc5: 90.6250 (95.4734)  time: 0.0817  data: 0.0009  max mem: 3452
Test:  Total time: 0:00:33
Test:  Acc@1 81.070 Acc@5 95.316
Number of added parameters: 67076
Epoch: [4]  [    0/10008]  eta: 7:15:31  lr: 0.0003  img/s: 35.08564864978613  loss: 2.2770 (2.2770)  acc1: 75.0000 (75.0000)  acc5: 96.8750 (96.8750)  time: 2.6110  data: 1.6990  max mem: 3453
Epoch: [4]  [ 1000/10008]  eta: 0:18:01  lr: 0.0003  img/s: 287.1354385724707  loss: 1.9658 (1.9505)  acc1: 84.3750 (81.1938)  acc5: 93.7500 (93.9498)  time: 0.1147  data: 0.0001  max mem: 3454
Epoch: [4]  [ 2000/10008]  eta: 0:15:43  lr: 0.0003  img/s: 275.769830409573  loss: 1.7788 (1.9643)  acc1: 81.2500 (80.6565)  acc5: 96.8750 (93.7313)  time: 0.1166  data: 0.0001  max mem: 3454
Epoch: [4]  [ 3000/10008]  eta: 0:13:41  lr: 0.0003  img/s: 289.68250932926424  loss: 1.8679 (1.9524)  acc1: 75.0000 (81.0240)  acc5: 93.7500 (93.8635)  time: 0.1159  data: 0.0001  max mem: 3454
Epoch: [4]  [ 4000/10008]  eta: 0:11:42  lr: 0.0003  img/s: 260.7480810737827  loss: 1.8603 (1.9489)  acc1: 87.5000 (81.1274)  acc5: 96.8750 (93.9265)  time: 0.1162  data: 0.0001  max mem: 3454
Epoch: [4]  [ 5000/10008]  eta: 0:09:44  lr: 0.0003  img/s: 279.4118719788158  loss: 1.8094 (1.9489)  acc1: 81.2500 (81.0850)  acc5: 96.8750 (93.9243)  time: 0.1167  data: 0.0001  max mem: 3454
Epoch: [4]  [ 6000/10008]  eta: 0:07:47  lr: 0.0003  img/s: 273.6997979130598  loss: 1.8383 (1.9465)  acc1: 84.3750 (81.1901)  acc5: 93.7500 (93.9406)  time: 0.1161  data: 0.0002  max mem: 3454
Epoch: [4]  [ 7000/10008]  eta: 0:05:50  lr: 0.0003  img/s: 281.9534313107632  loss: 1.8068 (1.9470)  acc1: 84.3750 (81.1478)  acc5: 93.7500 (93.9540)  time: 0.1146  data: 0.0001  max mem: 3454
Epoch: [4]  [ 8000/10008]  eta: 0:03:53  lr: 0.0003  img/s: 270.15689573965307  loss: 1.9144 (1.9457)  acc1: 84.3750 (81.1699)  acc5: 93.7500 (93.9777)  time: 0.1151  data: 0.0001  max mem: 3454
Epoch: [4]  [ 9000/10008]  eta: 0:01:57  lr: 0.0003  img/s: 263.78907522891785  loss: 1.9260 (1.9487)  acc1: 81.2500 (81.1090)  acc5: 93.7500 (93.9156)  time: 0.1219  data: 0.0002  max mem: 3454
Epoch: [4]  [10000/10008]  eta: 0:00:00  lr: 0.0003  img/s: 292.6805253597511  loss: 1.7086 (1.9485)  acc1: 87.5000 (81.1297)  acc5: 96.8750 (93.9103)  time: 0.1061  data: 0.0001  max mem: 3454
Epoch: [4] Total time: 0:19:23
Test:   [  0/391]  eta: 0:09:24  loss: 1.1718 (1.1718)  acc1: 100.0000 (100.0000)  acc5: 100.0000 (100.0000)  time: 1.4427  data: 1.3397  max mem: 3454
Test:   [100/391]  eta: 0:00:31  loss: 1.5430 (1.5818)  acc1: 87.5000 (86.4171)  acc5: 96.8750 (97.2153)  time: 0.0817  data: 0.0012  max mem: 3454
Test:   [200/391]  eta: 0:00:18  loss: 2.0454 (1.6566)  acc1: 75.0000 (84.0951)  acc5: 93.7500 (96.5330)  time: 0.0812  data: 0.0006  max mem: 3454
Test:   [300/391]  eta: 0:00:08  loss: 1.9405 (1.7316)  acc1: 71.8750 (81.9560)  acc5: 90.6250 (95.4630)  time: 0.0812  data: 0.0004  max mem: 3454
Test:  Total time: 0:00:34
Test:  Acc@1 81.068 Acc@5 95.314
Number of added parameters: 67076
Training time 1:40:25
Experiment with model=vit_b_16, n_components=4, and dof=16 completed
-----------------------------------
Running experiment with n_components=4 and dof=4
[2024-11-14 09:30:41,167] torch.distributed.run: [WARNING] 
[2024-11-14 09:30:41,167] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 09:30:41,167] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 09:30:41,167] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 3): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=4, dof=4, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.7495648860931396
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 36868
Start training
Epoch: [0]  [    0/10010]  eta: 14:24:52  lr: 0.01  img/s: 13.436952525267795  loss: 0.8872 (0.8872)  acc1: 71.8750 (71.8750)  acc5: 90.6250 (90.6250)  time: 5.1841  data: 2.8026  max mem: 21516
Epoch: [0]  [ 1000/10010]  eta: 0:12:52  lr: 0.01  img/s: 404.9239977795477  loss: 0.8159 (0.9002)  acc1: 81.2500 (77.9876)  acc5: 93.7500 (92.1828)  time: 0.0807  data: 0.0001  max mem: 21516
Epoch: [0]  [ 2000/10010]  eta: 0:11:07  lr: 0.01  img/s: 334.5348610567612  loss: 0.7369 (0.9005)  acc1: 78.1250 (77.9751)  acc5: 90.6250 (92.1383)  time: 0.0831  data: 0.0001  max mem: 21516
Epoch: [0]  [ 3000/10010]  eta: 0:09:40  lr: 0.01  img/s: 397.835397338234  loss: 0.8820 (0.9021)  acc1: 78.1250 (77.9188)  acc5: 90.6250 (92.0797)  time: 0.0805  data: 0.0001  max mem: 21516
Epoch: [0]  [ 4000/10010]  eta: 0:08:14  lr: 0.01  img/s: 391.11148410408833  loss: 0.7647 (0.8971)  acc1: 78.1250 (78.0227)  acc5: 90.6250 (92.1645)  time: 0.0807  data: 0.0001  max mem: 21516
Epoch: [0]  [ 5000/10010]  eta: 0:06:51  lr: 0.01  img/s: 401.0318123825374  loss: 0.9861 (0.8986)  acc1: 71.8750 (77.9438)  acc5: 90.6250 (92.1697)  time: 0.0830  data: 0.0002  max mem: 21516
Epoch: [0]  [ 6000/10010]  eta: 0:05:28  lr: 0.01  img/s: 397.0621518399418  loss: 1.0022 (0.8963)  acc1: 78.1250 (77.9875)  acc5: 90.6250 (92.2299)  time: 0.0812  data: 0.0001  max mem: 21516
Epoch: [0]  [ 7000/10010]  eta: 0:04:06  lr: 0.01  img/s: 355.07711192711037  loss: 0.8259 (0.8966)  acc1: 78.1250 (78.0022)  acc5: 90.6250 (92.2288)  time: 0.0849  data: 0.0001  max mem: 21516
Epoch: [0]  [ 8000/10010]  eta: 0:02:45  lr: 0.01  img/s: 367.83468809436374  loss: 0.8991 (0.8944)  acc1: 75.0000 (78.0477)  acc5: 90.6250 (92.2572)  time: 0.0840  data: 0.0002  max mem: 21516
Epoch: [0]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 398.4353474122935  loss: 0.8615 (0.8934)  acc1: 75.0000 (78.0622)  acc5: 93.7500 (92.2776)  time: 0.0809  data: 0.0001  max mem: 21516
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 405.3140708752963  loss: 0.7731 (0.8932)  acc1: 78.1250 (78.0603)  acc5: 93.7500 (92.2692)  time: 0.0812  data: 0.0001  max mem: 21516
Epoch: [0] Total time: 0:13:43
Test:   [  0/391]  eta: 0:09:40  loss: 0.3916 (0.3916)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4838  data: 1.2454  max mem: 21516
Test:   [100/391]  eta: 0:00:26  loss: 0.6465 (0.6912)  acc1: 81.2500 (81.7141)  acc5: 96.8750 (95.9158)  time: 0.0641  data: 0.0344  max mem: 21516
Test:   [200/391]  eta: 0:00:15  loss: 1.1981 (0.7926)  acc1: 68.7500 (79.2444)  acc5: 87.5000 (94.9471)  time: 0.0589  data: 0.0193  max mem: 21516
Test:   [300/391]  eta: 0:00:06  loss: 1.2373 (0.9206)  acc1: 68.7500 (76.6923)  acc5: 87.5000 (93.4178)  time: 0.0528  data: 0.0214  max mem: 21516
Test:  Total time: 0:00:29
Test:  Acc@1 76.192 Acc@5 92.948
Number of added parameters: 36868
Epoch: [1]  [    0/10010]  eta: 5:59:28  lr: 0.01  img/s: 126.73563624311521  loss: 0.7550 (0.7550)  acc1: 84.3750 (84.3750)  acc5: 87.5000 (87.5000)  time: 2.1547  data: 1.9022  max mem: 21516
Epoch: [1]  [ 1000/10010]  eta: 0:12:45  lr: 0.01  img/s: 393.52536320056294  loss: 0.8105 (0.8932)  acc1: 75.0000 (77.9252)  acc5: 93.7500 (92.2484)  time: 0.0816  data: 0.0001  max mem: 21516
Epoch: [1]  [ 2000/10010]  eta: 0:11:12  lr: 0.01  img/s: 390.94629713237117  loss: 0.8122 (0.8930)  acc1: 75.0000 (77.9720)  acc5: 90.6250 (92.3523)  time: 0.0820  data: 0.0001  max mem: 21516
Epoch: [1]  [ 3000/10010]  eta: 0:09:45  lr: 0.01  img/s: 391.9944625683052  loss: 0.8753 (0.8934)  acc1: 78.1250 (77.9313)  acc5: 93.7500 (92.2911)  time: 0.0819  data: 0.0001  max mem: 21516
Epoch: [1]  [ 4000/10010]  eta: 0:08:22  lr: 0.01  img/s: 401.1420817779425  loss: 0.8091 (0.8902)  acc1: 75.0000 (77.9961)  acc5: 93.7500 (92.3582)  time: 0.0833  data: 0.0002  max mem: 21516
Epoch: [1]  [ 5000/10010]  eta: 0:06:59  lr: 0.01  img/s: 393.6892729443305  loss: 0.9177 (0.8916)  acc1: 78.1250 (77.9732)  acc5: 90.6250 (92.3359)  time: 0.0845  data: 0.0002  max mem: 21516
Epoch: [1]  [ 6000/10010]  eta: 0:05:36  lr: 0.01  img/s: 392.83084163573994  loss: 0.7308 (0.8925)  acc1: 81.2500 (78.0110)  acc5: 93.7500 (92.3117)  time: 0.0828  data: 0.0001  max mem: 21516
Epoch: [1]  [ 7000/10010]  eta: 0:04:12  lr: 0.01  img/s: 385.29119229289745  loss: 0.9073 (0.8918)  acc1: 78.1250 (78.0281)  acc5: 90.6250 (92.3145)  time: 0.0820  data: 0.0001  max mem: 21516
Epoch: [1]  [ 8000/10010]  eta: 0:02:48  lr: 0.01  img/s: 384.2246186172603  loss: 0.7420 (0.8921)  acc1: 78.1250 (78.0375)  acc5: 93.7500 (92.3041)  time: 0.0838  data: 0.0001  max mem: 21516
Epoch: [1]  [ 9000/10010]  eta: 0:01:24  lr: 0.01  img/s: 392.44834956622935  loss: 0.8723 (0.8927)  acc1: 75.0000 (78.0299)  acc5: 93.7500 (92.2953)  time: 0.0836  data: 0.0001  max mem: 21516
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 400.6977788392644  loss: 0.7913 (0.8915)  acc1: 78.1250 (78.0497)  acc5: 93.7500 (92.3170)  time: 0.0805  data: 0.0001  max mem: 21516
Epoch: [1] Total time: 0:13:58
Test:   [  0/391]  eta: 0:12:26  loss: 0.3952 (0.3952)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.9091  data: 1.8774  max mem: 21516
Test:   [100/391]  eta: 0:00:26  loss: 0.6477 (0.6915)  acc1: 81.2500 (81.7760)  acc5: 96.8750 (95.9158)  time: 0.0775  data: 0.0412  max mem: 21516
Test:   [200/391]  eta: 0:00:15  loss: 1.1893 (0.7925)  acc1: 68.7500 (79.3377)  acc5: 87.5000 (94.8694)  time: 0.0696  data: 0.0311  max mem: 21516
Test:   [300/391]  eta: 0:00:07  loss: 1.2261 (0.9205)  acc1: 68.7500 (76.8688)  acc5: 87.5000 (93.3762)  time: 0.0694  data: 0.0337  max mem: 21516
Test:  Total time: 0:00:28
Test:  Acc@1 76.184 Acc@5 92.946
Number of added parameters: 36868
Epoch: [2]  [    0/10010]  eta: 6:39:44  lr: 0.01  img/s: 50.70115803979402  loss: 1.1264 (1.1264)  acc1: 68.7500 (68.7500)  acc5: 90.6250 (90.6250)  time: 2.3960  data: 1.7649  max mem: 21516
Epoch: [2]  [ 1000/10010]  eta: 0:13:02  lr: 0.01  img/s: 384.3797697462627  loss: 0.8338 (0.8771)  acc1: 75.0000 (78.2624)  acc5: 90.6250 (92.4513)  time: 0.0836  data: 0.0001  max mem: 21516
Epoch: [2]  [ 2000/10010]  eta: 0:11:25  lr: 0.01  img/s: 381.7439240481127  loss: 0.9704 (0.8855)  acc1: 78.1250 (78.0875)  acc5: 90.6250 (92.3835)  time: 0.0832  data: 0.0002  max mem: 21516
Epoch: [2]  [ 3000/10010]  eta: 0:09:56  lr: 0.01  img/s: 357.24612923574864  loss: 0.7791 (0.8843)  acc1: 78.1250 (78.2010)  acc5: 90.6250 (92.3588)  time: 0.0867  data: 0.0001  max mem: 21516
Epoch: [2]  [ 4000/10010]  eta: 0:08:30  lr: 0.01  img/s: 387.3147454506628  loss: 0.7322 (0.8849)  acc1: 75.0000 (78.1890)  acc5: 93.7500 (92.3589)  time: 0.0836  data: 0.0002  max mem: 21516
Epoch: [2]  [ 5000/10010]  eta: 0:07:06  lr: 0.01  img/s: 390.2199945341528  loss: 0.9106 (0.8897)  acc1: 78.1250 (78.1244)  acc5: 90.6250 (92.2928)  time: 0.0836  data: 0.0001  max mem: 21516
Epoch: [2]  [ 6000/10010]  eta: 0:05:41  lr: 0.01  img/s: 384.09267372746757  loss: 0.7025 (0.8887)  acc1: 78.1250 (78.1281)  acc5: 93.7500 (92.3070)  time: 0.0837  data: 0.0001  max mem: 21516
Epoch: [2]  [ 7000/10010]  eta: 0:04:15  lr: 0.01  img/s: 388.0684089851125  loss: 0.7687 (0.8890)  acc1: 78.1250 (78.1112)  acc5: 93.7500 (92.3145)  time: 0.0828  data: 0.0001  max mem: 21516
Epoch: [2]  [ 8000/10010]  eta: 0:02:50  lr: 0.01  img/s: 389.3099739527437  loss: 0.8569 (0.8910)  acc1: 81.2500 (78.0715)  acc5: 93.7500 (92.2932)  time: 0.0834  data: 0.0001  max mem: 21516
Epoch: [2]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 374.32118762951  loss: 0.7860 (0.8918)  acc1: 78.1250 (78.0570)  acc5: 93.7500 (92.2776)  time: 0.0865  data: 0.0001  max mem: 21516
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 392.0436974593549  loss: 0.8326 (0.8931)  acc1: 78.1250 (78.0263)  acc5: 90.6250 (92.2573)  time: 0.0829  data: 0.0001  max mem: 21516
Epoch: [2] Total time: 0:14:11
Test:   [  0/391]  eta: 0:07:54  loss: 0.3939 (0.3939)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.2136  data: 1.1837  max mem: 21516
Test:   [100/391]  eta: 0:00:26  loss: 0.6395 (0.6907)  acc1: 81.2500 (81.8069)  acc5: 96.8750 (95.9468)  time: 0.0878  data: 0.0446  max mem: 21516
Test:   [200/391]  eta: 0:00:15  loss: 1.1752 (0.7910)  acc1: 68.7500 (79.3843)  acc5: 87.5000 (94.9316)  time: 0.0748  data: 0.0405  max mem: 21516
Test:   [300/391]  eta: 0:00:07  loss: 1.2228 (0.9195)  acc1: 68.7500 (76.8688)  acc5: 87.5000 (93.4282)  time: 0.0601  data: 0.0255  max mem: 21516
Test:  Total time: 0:00:28
Test:  Acc@1 76.214 Acc@5 92.948
Number of added parameters: 36868
Epoch: [3]  [    0/10010]  eta: 4:49:23  lr: 0.01  img/s: 62.328458238483066  loss: 0.7283 (0.7283)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 1.7346  data: 1.2212  max mem: 21516
Epoch: [3]  [ 1000/10010]  eta: 0:13:21  lr: 0.01  img/s: 386.68316911552864  loss: 0.8260 (0.8862)  acc1: 78.1250 (78.1562)  acc5: 93.7500 (92.4638)  time: 0.0878  data: 0.0001  max mem: 21516
Epoch: [3]  [ 2000/10010]  eta: 0:11:39  lr: 0.01  img/s: 380.6655605566853  loss: 0.8948 (0.8847)  acc1: 78.1250 (78.1172)  acc5: 90.6250 (92.4710)  time: 0.0849  data: 0.0001  max mem: 21516
Epoch: [3]  [ 3000/10010]  eta: 0:10:09  lr: 0.01  img/s: 373.9842958488211  loss: 0.7647 (0.8919)  acc1: 81.2500 (78.0802)  acc5: 90.6250 (92.2932)  time: 0.0861  data: 0.0001  max mem: 21516
Epoch: [3]  [ 4000/10010]  eta: 0:08:42  lr: 0.01  img/s: 378.8614430964304  loss: 0.8747 (0.8930)  acc1: 78.1250 (78.0133)  acc5: 93.7500 (92.2847)  time: 0.0856  data: 0.0001  max mem: 21516
Epoch: [3]  [ 5000/10010]  eta: 0:07:15  lr: 0.01  img/s: 359.83883923065787  loss: 0.8135 (0.8965)  acc1: 78.1250 (78.0100)  acc5: 93.7500 (92.2347)  time: 0.0888  data: 0.0001  max mem: 21516
Epoch: [3]  [ 6000/10010]  eta: 0:05:48  lr: 0.01  img/s: 380.53065390460205  loss: 0.8782 (0.8959)  acc1: 78.1250 (77.9917)  acc5: 90.6250 (92.2383)  time: 0.0842  data: 0.0001  max mem: 21516
Epoch: [3]  [ 7000/10010]  eta: 0:04:20  lr: 0.01  img/s: 374.9884137738353  loss: 0.7676 (0.8960)  acc1: 81.2500 (78.0094)  acc5: 93.7500 (92.2306)  time: 0.0877  data: 0.0002  max mem: 21516
Epoch: [3]  [ 8000/10010]  eta: 0:02:53  lr: 0.01  img/s: 382.4150164969485  loss: 0.6991 (0.8947)  acc1: 78.1250 (78.0317)  acc5: 93.7500 (92.2506)  time: 0.0842  data: 0.0001  max mem: 21516
Epoch: [3]  [ 9000/10010]  eta: 0:01:27  lr: 0.01  img/s: 360.7402207159022  loss: 0.9446 (0.8942)  acc1: 78.1250 (78.0156)  acc5: 90.6250 (92.2838)  time: 0.0876  data: 0.0001  max mem: 21516
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 382.1330228082213  loss: 0.7977 (0.8943)  acc1: 78.1250 (78.0181)  acc5: 93.7500 (92.2876)  time: 0.0844  data: 0.0001  max mem: 21516
Epoch: [3] Total time: 0:14:24
Test:   [  0/391]  eta: 0:09:20  loss: 0.3936 (0.3936)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4327  data: 1.3866  max mem: 21516
Test:   [100/391]  eta: 0:00:26  loss: 0.6466 (0.6919)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.9158)  time: 0.0803  data: 0.0444  max mem: 21516
Test:   [200/391]  eta: 0:00:15  loss: 1.1784 (0.7919)  acc1: 68.7500 (79.4310)  acc5: 87.5000 (94.9005)  time: 0.0631  data: 0.0248  max mem: 21516
Test:   [300/391]  eta: 0:00:07  loss: 1.2323 (0.9200)  acc1: 68.7500 (76.8999)  acc5: 87.5000 (93.4489)  time: 0.0517  data: 0.0150  max mem: 21516
Test:  Total time: 0:00:28
Test:  Acc@1 76.226 Acc@5 92.952
Number of added parameters: 36868
Epoch: [4]  [    0/10010]  eta: 6:43:15  lr: 0.01  img/s: 274.29158125989886  loss: 0.6829 (0.6829)  acc1: 75.0000 (75.0000)  acc5: 96.8750 (96.8750)  time: 2.4172  data: 2.3005  max mem: 21516
Epoch: [4]  [ 1000/10010]  eta: 0:13:13  lr: 0.01  img/s: 372.13031158331347  loss: 0.8979 (0.8900)  acc1: 75.0000 (78.0938)  acc5: 90.6250 (92.3420)  time: 0.0862  data: 0.0001  max mem: 21516
Epoch: [4]  [ 2000/10010]  eta: 0:11:42  lr: 0.01  img/s: 357.107354854502  loss: 0.6996 (0.8831)  acc1: 78.1250 (78.2577)  acc5: 93.7500 (92.4350)  time: 0.0868  data: 0.0001  max mem: 21516
Epoch: [4]  [ 3000/10010]  eta: 0:10:17  lr: 0.01  img/s: 359.12635189733874  loss: 0.7771 (0.8837)  acc1: 78.1250 (78.2041)  acc5: 93.7500 (92.3900)  time: 0.0901  data: 0.0001  max mem: 21516
Epoch: [4]  [ 4000/10010]  eta: 0:08:45  lr: 0.01  img/s: 376.4820353150727  loss: 0.8174 (0.8827)  acc1: 81.2500 (78.1883)  acc5: 93.7500 (92.4074)  time: 0.0858  data: 0.0001  max mem: 21516
Epoch: [4]  [ 5000/10010]  eta: 0:07:17  lr: 0.01  img/s: 377.21635362594185  loss: 0.8493 (0.8841)  acc1: 75.0000 (78.1544)  acc5: 93.7500 (92.4046)  time: 0.0868  data: 0.0001  max mem: 21516
Epoch: [4]  [ 6000/10010]  eta: 0:05:51  lr: 0.01  img/s: 350.0312378567982  loss: 0.8868 (0.8832)  acc1: 75.0000 (78.1854)  acc5: 93.7500 (92.4513)  time: 0.0880  data: 0.0002  max mem: 21516
Epoch: [4]  [ 7000/10010]  eta: 0:04:24  lr: 0.01  img/s: 379.10435855936777  loss: 0.9392 (0.8841)  acc1: 75.0000 (78.1496)  acc5: 90.6250 (92.4256)  time: 0.0851  data: 0.0001  max mem: 21516
Epoch: [4]  [ 8000/10010]  eta: 0:02:56  lr: 0.01  img/s: 347.0687374262382  loss: 0.8891 (0.8833)  acc1: 78.1250 (78.1973)  acc5: 90.6250 (92.4240)  time: 0.0856  data: 0.0001  max mem: 21516
Epoch: [4]  [ 9000/10010]  eta: 0:01:28  lr: 0.01  img/s: 376.0832765920484  loss: 0.9715 (0.8846)  acc1: 75.0000 (78.2024)  acc5: 90.6250 (92.4144)  time: 0.0858  data: 0.0002  max mem: 21516
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 383.6304828761054  loss: 0.8523 (0.8861)  acc1: 75.0000 (78.1812)  acc5: 90.6250 (92.3995)  time: 0.0862  data: 0.0001  max mem: 21516
Epoch: [4] Total time: 0:14:36
Test:   [  0/391]  eta: 0:09:41  loss: 0.3950 (0.3950)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4867  data: 1.4529  max mem: 21516
Test:   [100/391]  eta: 0:00:24  loss: 0.6401 (0.6907)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.9468)  time: 0.0677  data: 0.0276  max mem: 21516
Test:   [200/391]  eta: 0:00:15  loss: 1.1969 (0.7918)  acc1: 68.7500 (79.3377)  acc5: 87.5000 (94.9471)  time: 0.0943  data: 0.0579  max mem: 21516
Test:   [300/391]  eta: 0:00:06  loss: 1.2333 (0.9197)  acc1: 68.7500 (76.7442)  acc5: 87.5000 (93.4697)  time: 0.0595  data: 0.0192  max mem: 21516
Test:  Total time: 0:00:29
Test:  Acc@1 76.224 Acc@5 92.942
Number of added parameters: 36868
Training time 1:13:21
Experiment with model=resnet50, n_components=4, and dof=4 completed
-----------------------------------
Running experiment with n_components=4 and dof=8
[2024-11-14 10:44:15,604] torch.distributed.run: [WARNING] 
[2024-11-14 10:44:15,604] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 10:44:15,604] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 10:44:15,604] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 1): env://
| distributed init (rank 2): env://
| distributed init (rank 3): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=4, dof=8, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.6335091590881348
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 69636
Start training
Epoch: [0]  [    0/10010]  eta: 13:56:40  lr: 0.01  img/s: 11.53672004517121  loss: 1.3403 (1.3403)  acc1: 71.8750 (71.8750)  acc5: 78.1250 (78.1250)  time: 5.0150  data: 2.2412  max mem: 21517
Epoch: [0]  [ 1000/10010]  eta: 0:12:58  lr: 0.01  img/s: 402.98726043890383  loss: 0.7447 (0.9094)  acc1: 81.2500 (77.5412)  acc5: 93.7500 (91.9737)  time: 0.0806  data: 0.0001  max mem: 21517
Epoch: [0]  [ 2000/10010]  eta: 0:11:09  lr: 0.01  img/s: 371.8488531557265  loss: 0.8092 (0.9023)  acc1: 78.1250 (77.8033)  acc5: 93.7500 (92.0477)  time: 0.0813  data: 0.0002  max mem: 21517
Epoch: [0]  [ 3000/10010]  eta: 0:09:38  lr: 0.01  img/s: 398.16349245903194  loss: 0.9022 (0.9002)  acc1: 78.1250 (77.8189)  acc5: 90.6250 (92.0787)  time: 0.0803  data: 0.0001  max mem: 21517
Epoch: [0]  [ 4000/10010]  eta: 0:08:13  lr: 0.01  img/s: 396.55300906160534  loss: 0.9296 (0.8945)  acc1: 75.0000 (77.9758)  acc5: 90.6250 (92.1442)  time: 0.0803  data: 0.0001  max mem: 21517
Epoch: [0]  [ 5000/10010]  eta: 0:06:49  lr: 0.01  img/s: 397.77644478691246  loss: 0.8352 (0.8959)  acc1: 75.0000 (77.9388)  acc5: 90.6250 (92.1434)  time: 0.0814  data: 0.0001  max mem: 21517
Epoch: [0]  [ 6000/10010]  eta: 0:05:26  lr: 0.01  img/s: 396.92593961726254  loss: 0.7828 (0.8958)  acc1: 81.2500 (77.9693)  acc5: 93.7500 (92.1862)  time: 0.0803  data: 0.0001  max mem: 21517
Epoch: [0]  [ 7000/10010]  eta: 0:04:04  lr: 0.01  img/s: 382.6505111786474  loss: 0.9299 (0.8955)  acc1: 75.0000 (77.9947)  acc5: 90.6250 (92.1913)  time: 0.0806  data: 0.0001  max mem: 21517
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 397.7422603119286  loss: 0.8909 (0.8943)  acc1: 75.0000 (78.0266)  acc5: 90.6250 (92.2100)  time: 0.0800  data: 0.0001  max mem: 21517
Epoch: [0]  [ 9000/10010]  eta: 0:01:21  lr: 0.01  img/s: 398.654282888347  loss: 0.8578 (0.8928)  acc1: 78.1250 (78.0729)  acc5: 90.6250 (92.2439)  time: 0.0799  data: 0.0001  max mem: 21517
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 409.1567302269575  loss: 0.7307 (0.8919)  acc1: 78.1250 (78.0728)  acc5: 96.8750 (92.2673)  time: 0.0785  data: 0.0001  max mem: 21517
Epoch: [0] Total time: 0:13:32
Test:   [  0/391]  eta: 0:09:59  loss: 0.3905 (0.3905)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5329  data: 1.4116  max mem: 21517
Test:   [100/391]  eta: 0:00:26  loss: 0.6394 (0.6913)  acc1: 81.2500 (81.7450)  acc5: 96.8750 (95.9468)  time: 0.0673  data: 0.0336  max mem: 21517
Test:   [200/391]  eta: 0:00:15  loss: 1.1896 (0.7926)  acc1: 68.7500 (79.2600)  acc5: 87.5000 (94.9005)  time: 0.0567  data: 0.0247  max mem: 21517
Test:   [300/391]  eta: 0:00:06  loss: 1.2407 (0.9211)  acc1: 71.8750 (76.7753)  acc5: 87.5000 (93.4074)  time: 0.0540  data: 0.0185  max mem: 21517
Test:  Total time: 0:00:28
Test:  Acc@1 76.210 Acc@5 92.950
Number of added parameters: 69636
Epoch: [1]  [    0/10010]  eta: 5:13:39  lr: 0.01  img/s: 145.37795767698944  loss: 1.3025 (1.3025)  acc1: 71.8750 (71.8750)  acc5: 84.3750 (84.3750)  time: 1.8800  data: 1.6599  max mem: 21517
Epoch: [1]  [ 1000/10010]  eta: 0:12:33  lr: 0.01  img/s: 395.6995557075512  loss: 0.7853 (0.8890)  acc1: 81.2500 (78.1718)  acc5: 93.7500 (92.2453)  time: 0.0815  data: 0.0001  max mem: 21517
Epoch: [1]  [ 2000/10010]  eta: 0:11:01  lr: 0.01  img/s: 400.21626714932773  loss: 0.8228 (0.8833)  acc1: 78.1250 (78.2421)  acc5: 93.7500 (92.3523)  time: 0.0813  data: 0.0001  max mem: 21517
Epoch: [1]  [ 3000/10010]  eta: 0:09:36  lr: 0.01  img/s: 383.43540166838073  loss: 0.9370 (0.8859)  acc1: 78.1250 (78.1667)  acc5: 93.7500 (92.3609)  time: 0.0815  data: 0.0001  max mem: 21517
Epoch: [1]  [ 4000/10010]  eta: 0:08:13  lr: 0.01  img/s: 395.12176798052326  loss: 0.8647 (0.8891)  acc1: 78.1250 (78.1109)  acc5: 93.7500 (92.3121)  time: 0.0813  data: 0.0001  max mem: 21517
Epoch: [1]  [ 5000/10010]  eta: 0:06:51  lr: 0.01  img/s: 396.76166996272354  loss: 0.8863 (0.8903)  acc1: 81.2500 (78.0831)  acc5: 90.6250 (92.3140)  time: 0.0817  data: 0.0001  max mem: 21517
Epoch: [1]  [ 6000/10010]  eta: 0:05:28  lr: 0.01  img/s: 388.42217244592615  loss: 0.8608 (0.8886)  acc1: 78.1250 (78.1302)  acc5: 93.7500 (92.3377)  time: 0.0813  data: 0.0001  max mem: 21517
Epoch: [1]  [ 7000/10010]  eta: 0:04:06  lr: 0.01  img/s: 394.42508235695163  loss: 0.8749 (0.8882)  acc1: 78.1250 (78.1107)  acc5: 90.6250 (92.3462)  time: 0.0813  data: 0.0001  max mem: 21517
Epoch: [1]  [ 8000/10010]  eta: 0:02:44  lr: 0.01  img/s: 390.72550646416835  loss: 0.8520 (0.8893)  acc1: 78.1250 (78.0981)  acc5: 93.7500 (92.3303)  time: 0.0816  data: 0.0002  max mem: 21517
Epoch: [1]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 397.23019734583465  loss: 0.8933 (0.8911)  acc1: 75.0000 (78.0896)  acc5: 90.6250 (92.2953)  time: 0.0815  data: 0.0001  max mem: 21517
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 402.76233259213245  loss: 0.7330 (0.8905)  acc1: 78.1250 (78.0944)  acc5: 93.7500 (92.3073)  time: 0.0792  data: 0.0001  max mem: 21517
Epoch: [1] Total time: 0:13:39
Test:   [  0/391]  eta: 0:11:53  loss: 0.3928 (0.3928)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.8235  data: 1.7697  max mem: 21517
Test:   [100/391]  eta: 0:00:26  loss: 0.6476 (0.6914)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.9158)  time: 0.0826  data: 0.0478  max mem: 21517
Test:   [200/391]  eta: 0:00:15  loss: 1.1906 (0.7926)  acc1: 68.7500 (79.3999)  acc5: 87.5000 (94.9471)  time: 0.0777  data: 0.0418  max mem: 21517
Test:   [300/391]  eta: 0:00:06  loss: 1.2184 (0.9203)  acc1: 68.7500 (76.8169)  acc5: 87.5000 (93.4282)  time: 0.0531  data: 0.0184  max mem: 21517
Test:  Total time: 0:00:28
Test:  Acc@1 76.220 Acc@5 92.966
Number of added parameters: 69636
Epoch: [2]  [    0/10010]  eta: 6:18:56  lr: 0.01  img/s: 69.80864347786287  loss: 1.2441 (1.2441)  acc1: 81.2500 (81.2500)  acc5: 90.6250 (90.6250)  time: 2.2714  data: 1.8130  max mem: 21517
Epoch: [2]  [ 1000/10010]  eta: 0:12:47  lr: 0.01  img/s: 385.02371800020654  loss: 0.7731 (0.8674)  acc1: 78.1250 (78.5059)  acc5: 93.7500 (92.6761)  time: 0.0826  data: 0.0001  max mem: 21517
Epoch: [2]  [ 2000/10010]  eta: 0:11:12  lr: 0.01  img/s: 372.51555782526276  loss: 0.9430 (0.8847)  acc1: 75.0000 (77.9923)  acc5: 90.6250 (92.4631)  time: 0.0839  data: 0.0001  max mem: 21517
Epoch: [2]  [ 3000/10010]  eta: 0:09:46  lr: 0.01  img/s: 390.95312968783225  loss: 0.7776 (0.8812)  acc1: 81.2500 (78.1479)  acc5: 93.7500 (92.4900)  time: 0.0827  data: 0.0001  max mem: 21517
Epoch: [2]  [ 4000/10010]  eta: 0:08:21  lr: 0.01  img/s: 383.6250003572786  loss: 0.8030 (0.8831)  acc1: 78.1250 (78.1508)  acc5: 93.7500 (92.4331)  time: 0.0829  data: 0.0001  max mem: 21517
Epoch: [2]  [ 5000/10010]  eta: 0:06:57  lr: 0.01  img/s: 387.9943687541013  loss: 0.9228 (0.8843)  acc1: 78.1250 (78.1362)  acc5: 90.6250 (92.4328)  time: 0.0825  data: 0.0002  max mem: 21517
Epoch: [2]  [ 6000/10010]  eta: 0:05:33  lr: 0.01  img/s: 391.85255210629424  loss: 0.8818 (0.8835)  acc1: 75.0000 (78.1391)  acc5: 93.7500 (92.4513)  time: 0.0830  data: 0.0002  max mem: 21517
Epoch: [2]  [ 7000/10010]  eta: 0:04:10  lr: 0.01  img/s: 397.17377460554195  loss: 0.8203 (0.8849)  acc1: 78.1250 (78.1455)  acc5: 93.7500 (92.4256)  time: 0.0827  data: 0.0001  max mem: 21517
Epoch: [2]  [ 8000/10010]  eta: 0:02:47  lr: 0.01  img/s: 386.53617178140263  loss: 0.7539 (0.8862)  acc1: 81.2500 (78.1430)  acc5: 93.7500 (92.4060)  time: 0.0827  data: 0.0001  max mem: 21517
Epoch: [2]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 389.780299818204  loss: 0.7552 (0.8872)  acc1: 78.1250 (78.1431)  acc5: 93.7500 (92.3804)  time: 0.0825  data: 0.0001  max mem: 21517
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 411.1773006191353  loss: 0.9323 (0.8903)  acc1: 78.1250 (78.0934)  acc5: 90.6250 (92.3045)  time: 0.0806  data: 0.0001  max mem: 21517
Epoch: [2] Total time: 0:13:52
Test:   [  0/391]  eta: 0:09:04  loss: 0.3941 (0.3941)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3925  data: 1.3378  max mem: 21517
Test:   [100/391]  eta: 0:00:25  loss: 0.6427 (0.6911)  acc1: 81.2500 (81.6832)  acc5: 96.8750 (95.9777)  time: 0.0734  data: 0.0366  max mem: 21517
Test:   [200/391]  eta: 0:00:15  loss: 1.1707 (0.7919)  acc1: 68.7500 (79.2910)  acc5: 87.5000 (94.9316)  time: 0.0692  data: 0.0333  max mem: 21517
Test:   [300/391]  eta: 0:00:06  loss: 1.2198 (0.9197)  acc1: 68.7500 (76.8065)  acc5: 87.5000 (93.4385)  time: 0.0568  data: 0.0212  max mem: 21517
Test:  Total time: 0:00:27
Test:  Acc@1 76.212 Acc@5 92.954
Number of added parameters: 69636
Epoch: [3]  [    0/10010]  eta: 5:16:38  lr: 0.01  img/s: 41.58562455247912  loss: 0.8170 (0.8170)  acc1: 78.1250 (78.1250)  acc5: 87.5000 (87.5000)  time: 1.8980  data: 1.1285  max mem: 21517
Epoch: [3]  [ 1000/10010]  eta: 0:12:53  lr: 0.01  img/s: 381.1357822758354  loss: 0.7671 (0.8892)  acc1: 78.1250 (78.0407)  acc5: 93.7500 (92.4732)  time: 0.0835  data: 0.0001  max mem: 21517
Epoch: [3]  [ 2000/10010]  eta: 0:11:20  lr: 0.01  img/s: 383.10487466532703  loss: 0.9201 (0.8888)  acc1: 75.0000 (77.9673)  acc5: 93.7500 (92.3851)  time: 0.0842  data: 0.0001  max mem: 21517
Epoch: [3]  [ 3000/10010]  eta: 0:09:52  lr: 0.01  img/s: 383.447451496876  loss: 0.8981 (0.8939)  acc1: 78.1250 (77.8897)  acc5: 93.7500 (92.3026)  time: 0.0840  data: 0.0001  max mem: 21517
Epoch: [3]  [ 4000/10010]  eta: 0:08:27  lr: 0.01  img/s: 381.374038166464  loss: 0.8283 (0.8938)  acc1: 78.1250 (77.9344)  acc5: 90.6250 (92.2894)  time: 0.0836  data: 0.0001  max mem: 21517
Epoch: [3]  [ 5000/10010]  eta: 0:07:02  lr: 0.01  img/s: 372.0488201068321  loss: 0.8593 (0.8953)  acc1: 78.1250 (77.9532)  acc5: 93.7500 (92.3072)  time: 0.0842  data: 0.0001  max mem: 21517
Epoch: [3]  [ 6000/10010]  eta: 0:05:38  lr: 0.01  img/s: 382.83059844320906  loss: 0.8815 (0.8954)  acc1: 78.1250 (78.0167)  acc5: 93.7500 (92.2836)  time: 0.0835  data: 0.0001  max mem: 21517
Epoch: [3]  [ 7000/10010]  eta: 0:04:13  lr: 0.01  img/s: 382.48258252781324  loss: 0.6756 (0.8948)  acc1: 78.1250 (78.0130)  acc5: 93.7500 (92.2792)  time: 0.0845  data: 0.0001  max mem: 21517
Epoch: [3]  [ 8000/10010]  eta: 0:02:49  lr: 0.01  img/s: 383.860890256598  loss: 0.7498 (0.8961)  acc1: 81.2500 (77.9817)  acc5: 93.7500 (92.2525)  time: 0.0841  data: 0.0001  max mem: 21517
Epoch: [3]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 379.89410789039437  loss: 0.7953 (0.8957)  acc1: 78.1250 (77.9632)  acc5: 90.6250 (92.2613)  time: 0.0843  data: 0.0001  max mem: 21517
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 388.090850998002  loss: 0.7887 (0.8960)  acc1: 75.0000 (77.9735)  acc5: 90.6250 (92.2480)  time: 0.0813  data: 0.0001  max mem: 21517
Epoch: [3] Total time: 0:14:03
Test:   [  0/391]  eta: 0:11:06  loss: 0.3929 (0.3929)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7035  data: 1.6730  max mem: 21517
Test:   [100/391]  eta: 0:00:26  loss: 0.6492 (0.6920)  acc1: 81.2500 (81.7760)  acc5: 96.8750 (95.9158)  time: 0.0591  data: 0.0230  max mem: 21517
Test:   [200/391]  eta: 0:00:15  loss: 1.1786 (0.7915)  acc1: 68.7500 (79.3999)  acc5: 87.5000 (94.9627)  time: 0.0629  data: 0.0292  max mem: 21517
Test:   [300/391]  eta: 0:00:06  loss: 1.2377 (0.9199)  acc1: 68.7500 (76.8065)  acc5: 87.5000 (93.4385)  time: 0.0686  data: 0.0347  max mem: 21517
Test:  Total time: 0:00:27
Test:  Acc@1 76.188 Acc@5 92.956
Number of added parameters: 69636
Epoch: [4]  [    0/10010]  eta: 4:55:13  lr: 0.01  img/s: 89.58742364048015  loss: 0.8603 (0.8603)  acc1: 78.1250 (78.1250)  acc5: 93.7500 (93.7500)  time: 1.7695  data: 1.4123  max mem: 21517
Epoch: [4]  [ 1000/10010]  eta: 0:13:03  lr: 0.01  img/s: 381.8731733964583  loss: 0.9068 (0.8933)  acc1: 75.0000 (78.1000)  acc5: 93.7500 (92.1422)  time: 0.0846  data: 0.0001  max mem: 21517
Epoch: [4]  [ 2000/10010]  eta: 0:11:29  lr: 0.01  img/s: 379.6104500702837  loss: 0.7459 (0.8908)  acc1: 78.1250 (78.0688)  acc5: 93.7500 (92.2117)  time: 0.0845  data: 0.0001  max mem: 21517
Epoch: [4]  [ 3000/10010]  eta: 0:10:01  lr: 0.01  img/s: 390.816523939446  loss: 0.8328 (0.8865)  acc1: 78.1250 (78.2208)  acc5: 93.7500 (92.2942)  time: 0.0849  data: 0.0001  max mem: 21517
Epoch: [4]  [ 4000/10010]  eta: 0:08:34  lr: 0.01  img/s: 381.76021116344685  loss: 0.7985 (0.8823)  acc1: 78.1250 (78.2937)  acc5: 93.7500 (92.3652)  time: 0.0845  data: 0.0001  max mem: 21517
Epoch: [4]  [ 5000/10010]  eta: 0:07:08  lr: 0.01  img/s: 381.08167472075684  loss: 0.8481 (0.8855)  acc1: 75.0000 (78.2150)  acc5: 93.7500 (92.3434)  time: 0.0853  data: 0.0001  max mem: 21517
Epoch: [4]  [ 6000/10010]  eta: 0:05:42  lr: 0.01  img/s: 379.77371645232944  loss: 0.7331 (0.8846)  acc1: 81.2500 (78.2234)  acc5: 93.7500 (92.3836)  time: 0.0848  data: 0.0001  max mem: 21517
Epoch: [4]  [ 7000/10010]  eta: 0:04:17  lr: 0.01  img/s: 380.62238002194954  loss: 0.9815 (0.8836)  acc1: 78.1250 (78.2357)  acc5: 90.6250 (92.4029)  time: 0.0847  data: 0.0001  max mem: 21517
Epoch: [4]  [ 8000/10010]  eta: 0:02:51  lr: 0.01  img/s: 379.0765198480505  loss: 0.8572 (0.8842)  acc1: 78.1250 (78.2152)  acc5: 90.6250 (92.3869)  time: 0.0848  data: 0.0001  max mem: 21517
Epoch: [4]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 379.02941749574285  loss: 1.0475 (0.8847)  acc1: 75.0000 (78.2062)  acc5: 90.6250 (92.3599)  time: 0.0850  data: 0.0001  max mem: 21517
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 378.3285498851352  loss: 0.8800 (0.8874)  acc1: 78.1250 (78.1550)  acc5: 90.6250 (92.3264)  time: 0.0835  data: 0.0001  max mem: 21517
Epoch: [4] Total time: 0:14:14
Test:   [  0/391]  eta: 0:08:44  loss: 0.3992 (0.3992)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3422  data: 1.2679  max mem: 21517
Test:   [100/391]  eta: 0:00:25  loss: 0.6464 (0.6916)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.9158)  time: 0.0648  data: 0.0255  max mem: 21517
Test:   [200/391]  eta: 0:00:14  loss: 1.2021 (0.7922)  acc1: 68.7500 (79.3221)  acc5: 87.5000 (94.9316)  time: 0.0548  data: 0.0153  max mem: 21517
Test:   [300/391]  eta: 0:00:06  loss: 1.2242 (0.9196)  acc1: 68.7500 (76.7961)  acc5: 87.5000 (93.4801)  time: 0.0566  data: 0.0172  max mem: 21517
Test:  Total time: 0:00:28
Test:  Acc@1 76.226 Acc@5 92.960
Number of added parameters: 69636
Training time 1:11:45
Experiment with model=resnet50, n_components=4, and dof=8 completed
-----------------------------------
Running experiment with n_components=4 and dof=16
[2024-11-14 11:56:15,467] torch.distributed.run: [WARNING] 
[2024-11-14 11:56:15,467] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 11:56:15,467] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 11:56:15,467] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 2): env://
| distributed init (rank 3): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=4, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.4483363628387451
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 135172
Start training
Epoch: [0]  [    0/10010]  eta: 13:45:46  lr: 0.01  img/s: 9.979539293186534  loss: 0.7608 (0.7608)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 4.9497  data: 1.7431  max mem: 21519
Epoch: [0]  [ 1000/10010]  eta: 0:12:49  lr: 0.01  img/s: 404.07552986512525  loss: 0.7585 (0.9073)  acc1: 78.1250 (77.9595)  acc5: 90.6250 (92.0923)  time: 0.0805  data: 0.0001  max mem: 21519
Epoch: [0]  [ 2000/10010]  eta: 0:11:04  lr: 0.01  img/s: 381.63429364330153  loss: 0.8833 (0.9019)  acc1: 75.0000 (77.9735)  acc5: 90.6250 (92.0946)  time: 0.0808  data: 0.0001  max mem: 21519
Epoch: [0]  [ 3000/10010]  eta: 0:09:35  lr: 0.01  img/s: 398.87701529619096  loss: 0.8658 (0.8996)  acc1: 78.1250 (77.9459)  acc5: 96.8750 (92.1401)  time: 0.0804  data: 0.0001  max mem: 21519
Epoch: [0]  [ 4000/10010]  eta: 0:08:11  lr: 0.01  img/s: 400.7671736806588  loss: 0.9474 (0.8949)  acc1: 78.1250 (78.0258)  acc5: 90.6250 (92.2082)  time: 0.0810  data: 0.0001  max mem: 21519
Epoch: [0]  [ 5000/10010]  eta: 0:06:48  lr: 0.01  img/s: 400.32370038744546  loss: 0.9265 (0.8959)  acc1: 75.0000 (78.0063)  acc5: 93.7500 (92.2540)  time: 0.0801  data: 0.0002  max mem: 21519
Epoch: [0]  [ 6000/10010]  eta: 0:05:26  lr: 0.01  img/s: 400.6678746809559  loss: 0.9275 (0.8949)  acc1: 78.1250 (78.0110)  acc5: 93.7500 (92.2711)  time: 0.0804  data: 0.0001  max mem: 21519
Epoch: [0]  [ 7000/10010]  eta: 0:04:04  lr: 0.01  img/s: 398.1800295480571  loss: 0.9354 (0.8943)  acc1: 75.0000 (78.0380)  acc5: 90.6250 (92.2774)  time: 0.0802  data: 0.0001  max mem: 21519
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 399.5229219068598  loss: 0.8637 (0.8943)  acc1: 78.1250 (78.0285)  acc5: 93.7500 (92.2728)  time: 0.0799  data: 0.0001  max mem: 21519
Epoch: [0]  [ 9000/10010]  eta: 0:01:21  lr: 0.01  img/s: 397.0304389239589  loss: 0.8211 (0.8930)  acc1: 81.2500 (78.0681)  acc5: 93.7500 (92.3040)  time: 0.0805  data: 0.0001  max mem: 21519
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 416.8925665014226  loss: 0.7313 (0.8915)  acc1: 81.2500 (78.1109)  acc5: 93.7500 (92.3267)  time: 0.0787  data: 0.0001  max mem: 21519
Epoch: [0] Total time: 0:13:32
Test:   [  0/391]  eta: 0:09:29  loss: 0.3924 (0.3924)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4571  data: 1.3861  max mem: 21519
Test:   [100/391]  eta: 0:00:26  loss: 0.6408 (0.6916)  acc1: 81.2500 (81.7141)  acc5: 96.8750 (95.8540)  time: 0.0554  data: 0.0222  max mem: 21519
Test:   [200/391]  eta: 0:00:14  loss: 1.1931 (0.7922)  acc1: 68.7500 (79.2755)  acc5: 87.5000 (94.8539)  time: 0.0611  data: 0.0212  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2317 (0.9207)  acc1: 68.7500 (76.7234)  acc5: 87.5000 (93.3762)  time: 0.0647  data: 0.0355  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.208 Acc@5 92.938
Number of added parameters: 135172
Epoch: [1]  [    0/10010]  eta: 4:45:27  lr: 0.01  img/s: 105.93708231613228  loss: 0.6104 (0.6104)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 1.7110  data: 1.4089  max mem: 21519
Epoch: [1]  [ 1000/10010]  eta: 0:12:34  lr: 0.01  img/s: 396.85904198698995  loss: 0.8792 (0.8913)  acc1: 78.1250 (78.0626)  acc5: 90.6250 (92.2296)  time: 0.0815  data: 0.0001  max mem: 21519
Epoch: [1]  [ 2000/10010]  eta: 0:11:03  lr: 0.01  img/s: 392.68028285629856  loss: 0.8842 (0.8845)  acc1: 78.1250 (78.0391)  acc5: 93.7500 (92.3804)  time: 0.0816  data: 0.0001  max mem: 21519
Epoch: [1]  [ 3000/10010]  eta: 0:09:38  lr: 0.01  img/s: 401.4336286362032  loss: 0.9306 (0.8859)  acc1: 75.0000 (78.0365)  acc5: 90.6250 (92.3630)  time: 0.0817  data: 0.0001  max mem: 21519
Epoch: [1]  [ 4000/10010]  eta: 0:08:14  lr: 0.01  img/s: 395.07059408767526  loss: 0.7689 (0.8879)  acc1: 78.1250 (78.0453)  acc5: 90.6250 (92.3004)  time: 0.0818  data: 0.0001  max mem: 21519
Epoch: [1]  [ 5000/10010]  eta: 0:06:51  lr: 0.01  img/s: 391.16277741347903  loss: 1.0361 (0.8916)  acc1: 71.8750 (77.9888)  acc5: 90.6250 (92.2653)  time: 0.0816  data: 0.0001  max mem: 21519
Epoch: [1]  [ 6000/10010]  eta: 0:05:29  lr: 0.01  img/s: 398.08200829870594  loss: 0.7859 (0.8903)  acc1: 81.2500 (78.0120)  acc5: 93.7500 (92.2794)  time: 0.0813  data: 0.0001  max mem: 21519
Epoch: [1]  [ 7000/10010]  eta: 0:04:07  lr: 0.01  img/s: 393.3973315825263  loss: 0.8725 (0.8916)  acc1: 75.0000 (78.0076)  acc5: 93.7500 (92.2699)  time: 0.0815  data: 0.0001  max mem: 21519
Epoch: [1]  [ 8000/10010]  eta: 0:02:44  lr: 0.01  img/s: 394.8218917766109  loss: 0.9692 (0.8928)  acc1: 78.1250 (78.0090)  acc5: 90.6250 (92.2615)  time: 0.0817  data: 0.0001  max mem: 21519
Epoch: [1]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 399.2103935658878  loss: 0.8946 (0.8929)  acc1: 75.0000 (78.0379)  acc5: 90.6250 (92.2460)  time: 0.0819  data: 0.0001  max mem: 21519
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 403.9077213826144  loss: 0.9145 (0.8913)  acc1: 78.1250 (78.0463)  acc5: 90.6250 (92.2855)  time: 0.0791  data: 0.0001  max mem: 21519
Epoch: [1] Total time: 0:13:41
Test:   [  0/391]  eta: 0:11:10  loss: 0.3959 (0.3959)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7153  data: 1.6666  max mem: 21519
Test:   [100/391]  eta: 0:00:26  loss: 0.6507 (0.6915)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (96.0087)  time: 0.0784  data: 0.0453  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1853 (0.7923)  acc1: 68.7500 (79.2910)  acc5: 87.5000 (94.9160)  time: 0.0661  data: 0.0339  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2275 (0.9202)  acc1: 68.7500 (76.7130)  acc5: 87.5000 (93.4385)  time: 0.0560  data: 0.0237  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.168 Acc@5 92.960
Number of added parameters: 135172
Epoch: [2]  [    0/10010]  eta: 6:47:28  lr: 0.01  img/s: 273.39650905328085  loss: 0.8834 (0.8834)  acc1: 78.1250 (78.1250)  acc5: 90.6250 (90.6250)  time: 2.4424  data: 2.3253  max mem: 21519
Epoch: [2]  [ 1000/10010]  eta: 0:12:49  lr: 0.01  img/s: 378.6455420517508  loss: 0.7277 (0.8712)  acc1: 81.2500 (78.2436)  acc5: 93.7500 (92.4607)  time: 0.0827  data: 0.0002  max mem: 21519
Epoch: [2]  [ 2000/10010]  eta: 0:11:14  lr: 0.01  img/s: 388.4660166074783  loss: 0.8783 (0.8860)  acc1: 78.1250 (78.0126)  acc5: 90.6250 (92.3101)  time: 0.0829  data: 0.0001  max mem: 21519
Epoch: [2]  [ 3000/10010]  eta: 0:09:47  lr: 0.01  img/s: 386.9574172418366  loss: 0.7787 (0.8838)  acc1: 81.2500 (78.0521)  acc5: 93.7500 (92.3015)  time: 0.0830  data: 0.0001  max mem: 21519
Epoch: [2]  [ 4000/10010]  eta: 0:08:22  lr: 0.01  img/s: 380.19649766870054  loss: 0.7308 (0.8855)  acc1: 84.3750 (78.0570)  acc5: 93.7500 (92.2988)  time: 0.0845  data: 0.0001  max mem: 21519
Epoch: [2]  [ 5000/10010]  eta: 0:06:58  lr: 0.01  img/s: 381.6994130227055  loss: 0.8989 (0.8876)  acc1: 75.0000 (78.0394)  acc5: 93.7500 (92.3053)  time: 0.0830  data: 0.0001  max mem: 21519
Epoch: [2]  [ 6000/10010]  eta: 0:05:34  lr: 0.01  img/s: 392.7710640290296  loss: 0.8247 (0.8874)  acc1: 78.1250 (78.0787)  acc5: 93.7500 (92.3273)  time: 0.0831  data: 0.0001  max mem: 21519
Epoch: [2]  [ 7000/10010]  eta: 0:04:11  lr: 0.01  img/s: 392.2258595245401  loss: 0.7868 (0.8866)  acc1: 78.1250 (78.1076)  acc5: 90.6250 (92.3573)  time: 0.0852  data: 0.0001  max mem: 21519
Epoch: [2]  [ 8000/10010]  eta: 0:02:47  lr: 0.01  img/s: 372.47834110846236  loss: 0.7982 (0.8875)  acc1: 81.2500 (78.1063)  acc5: 93.7500 (92.3455)  time: 0.0833  data: 0.0001  max mem: 21519
Epoch: [2]  [ 9000/10010]  eta: 0:01:24  lr: 0.01  img/s: 384.87025391773125  loss: 0.7600 (0.8871)  acc1: 78.1250 (78.1365)  acc5: 93.7500 (92.3588)  time: 0.0843  data: 0.0002  max mem: 21519
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 366.37975623404805  loss: 0.9261 (0.8892)  acc1: 78.1250 (78.1222)  acc5: 93.7500 (92.3067)  time: 0.0813  data: 0.0001  max mem: 21519
Epoch: [2] Total time: 0:13:57
Test:   [  0/391]  eta: 0:08:39  loss: 0.3936 (0.3936)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3280  data: 1.2912  max mem: 21519
Test:   [100/391]  eta: 0:00:25  loss: 0.6494 (0.6912)  acc1: 81.2500 (81.7450)  acc5: 96.8750 (95.9158)  time: 0.0772  data: 0.0412  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1870 (0.7916)  acc1: 68.7500 (79.3221)  acc5: 87.5000 (94.9471)  time: 0.0521  data: 0.0189  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2160 (0.9195)  acc1: 68.7500 (76.8480)  acc5: 87.5000 (93.4593)  time: 0.0684  data: 0.0293  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.242 Acc@5 92.948
Number of added parameters: 135172
Epoch: [3]  [    0/10010]  eta: 5:14:59  lr: 0.01  img/s: 169.20575576572512  loss: 0.9857 (0.9857)  acc1: 84.3750 (84.3750)  acc5: 90.6250 (90.6250)  time: 1.8881  data: 1.6989  max mem: 21519
Epoch: [3]  [ 1000/10010]  eta: 0:13:07  lr: 0.01  img/s: 381.3827076300565  loss: 0.7936 (0.8829)  acc1: 78.1250 (78.2905)  acc5: 93.7500 (92.3857)  time: 0.0841  data: 0.0001  max mem: 21519
Epoch: [3]  [ 2000/10010]  eta: 0:11:37  lr: 0.01  img/s: 372.23971067870696  loss: 0.8954 (0.8825)  acc1: 78.1250 (78.1531)  acc5: 90.6250 (92.4147)  time: 0.0889  data: 0.0001  max mem: 21519
Epoch: [3]  [ 3000/10010]  eta: 0:10:06  lr: 0.01  img/s: 355.4702021833899  loss: 0.8790 (0.8889)  acc1: 78.1250 (78.1646)  acc5: 90.6250 (92.2849)  time: 0.0875  data: 0.0001  max mem: 21519
Epoch: [3]  [ 4000/10010]  eta: 0:08:38  lr: 0.01  img/s: 381.017847561893  loss: 0.6637 (0.8906)  acc1: 81.2500 (78.0688)  acc5: 93.7500 (92.2363)  time: 0.0839  data: 0.0001  max mem: 21519
Epoch: [3]  [ 5000/10010]  eta: 0:07:10  lr: 0.01  img/s: 380.02103147075894  loss: 0.8486 (0.8950)  acc1: 78.1250 (77.9925)  acc5: 93.7500 (92.2097)  time: 0.0845  data: 0.0001  max mem: 21519
Epoch: [3]  [ 6000/10010]  eta: 0:05:44  lr: 0.01  img/s: 378.58679972808534  loss: 0.8067 (0.8949)  acc1: 78.1250 (77.9865)  acc5: 93.7500 (92.2336)  time: 0.0851  data: 0.0001  max mem: 21519
Epoch: [3]  [ 7000/10010]  eta: 0:04:18  lr: 0.01  img/s: 382.3856000410255  loss: 0.7892 (0.8935)  acc1: 78.1250 (78.0536)  acc5: 93.7500 (92.2649)  time: 0.0852  data: 0.0001  max mem: 21519
Epoch: [3]  [ 8000/10010]  eta: 0:02:52  lr: 0.01  img/s: 378.5846639870249  loss: 0.6478 (0.8926)  acc1: 81.2500 (78.0656)  acc5: 93.7500 (92.2818)  time: 0.0846  data: 0.0001  max mem: 21519
Epoch: [3]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 382.1591360130293  loss: 0.8705 (0.8919)  acc1: 78.1250 (78.0788)  acc5: 90.6250 (92.3116)  time: 0.0841  data: 0.0001  max mem: 21519
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 378.13029967516644  loss: 0.8645 (0.8922)  acc1: 78.1250 (78.0638)  acc5: 93.7500 (92.3298)  time: 0.0822  data: 0.0001  max mem: 21519
Epoch: [3] Total time: 0:14:16
Test:   [  0/391]  eta: 0:09:16  loss: 0.3978 (0.3978)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4241  data: 1.3789  max mem: 21519
Test:   [100/391]  eta: 0:00:25  loss: 0.6550 (0.6917)  acc1: 81.2500 (81.8069)  acc5: 96.8750 (95.9468)  time: 0.0674  data: 0.0277  max mem: 21519
Test:   [200/391]  eta: 0:00:14  loss: 1.1726 (0.7913)  acc1: 68.7500 (79.3377)  acc5: 87.5000 (94.9005)  time: 0.0605  data: 0.0250  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2280 (0.9200)  acc1: 68.7500 (76.7961)  acc5: 87.5000 (93.4178)  time: 0.0732  data: 0.0383  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.222 Acc@5 92.962
Number of added parameters: 135172
Epoch: [4]  [    0/10010]  eta: 5:32:04  lr: 0.01  img/s: 178.37214785124505  loss: 0.6216 (0.6216)  acc1: 78.1250 (78.1250)  acc5: 96.8750 (96.8750)  time: 1.9905  data: 1.8110  max mem: 21519
Epoch: [4]  [ 1000/10010]  eta: 0:13:09  lr: 0.01  img/s: 369.9547347675685  loss: 0.9232 (0.8987)  acc1: 78.1250 (78.0313)  acc5: 90.6250 (92.1828)  time: 0.0854  data: 0.0001  max mem: 21519
Epoch: [4]  [ 2000/10010]  eta: 0:11:33  lr: 0.01  img/s: 372.92128843679933  loss: 0.7376 (0.8868)  acc1: 78.1250 (78.1625)  acc5: 93.7500 (92.4210)  time: 0.0853  data: 0.0001  max mem: 21519
Epoch: [4]  [ 3000/10010]  eta: 0:10:04  lr: 0.01  img/s: 382.49457254325296  loss: 0.9832 (0.8890)  acc1: 78.1250 (78.1406)  acc5: 90.6250 (92.3557)  time: 0.0852  data: 0.0002  max mem: 21519
Epoch: [4]  [ 4000/10010]  eta: 0:08:37  lr: 0.01  img/s: 377.43168882589816  loss: 0.9181 (0.8870)  acc1: 78.1250 (78.2445)  acc5: 90.6250 (92.3582)  time: 0.0851  data: 0.0001  max mem: 21519
Epoch: [4]  [ 5000/10010]  eta: 0:07:10  lr: 0.01  img/s: 376.29731972636534  loss: 0.9415 (0.8894)  acc1: 78.1250 (78.2181)  acc5: 93.7500 (92.3247)  time: 0.0852  data: 0.0001  max mem: 21519
Epoch: [4]  [ 6000/10010]  eta: 0:05:44  lr: 0.01  img/s: 376.70816270969516  loss: 0.8540 (0.8887)  acc1: 78.1250 (78.2239)  acc5: 93.7500 (92.3450)  time: 0.0854  data: 0.0001  max mem: 21519
Epoch: [4]  [ 7000/10010]  eta: 0:04:18  lr: 0.01  img/s: 369.68062931053475  loss: 0.8782 (0.8884)  acc1: 78.1250 (78.2357)  acc5: 93.7500 (92.3390)  time: 0.0855  data: 0.0001  max mem: 21519
Epoch: [4]  [ 8000/10010]  eta: 0:02:52  lr: 0.01  img/s: 377.07116769865263  loss: 0.7412 (0.8883)  acc1: 78.1250 (78.2199)  acc5: 90.6250 (92.3217)  time: 0.0857  data: 0.0001  max mem: 21519
Epoch: [4]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 386.48274591108037  loss: 0.9788 (0.8886)  acc1: 75.0000 (78.2076)  acc5: 90.6250 (92.3099)  time: 0.0853  data: 0.0002  max mem: 21519
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 390.25857176087464  loss: 0.9027 (0.8918)  acc1: 78.1250 (78.0975)  acc5: 90.6250 (92.2723)  time: 0.0829  data: 0.0001  max mem: 21519
Epoch: [4] Total time: 0:14:19
Test:   [  0/391]  eta: 0:10:56  loss: 0.3975 (0.3975)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6784  data: 1.6328  max mem: 21519
Test:   [100/391]  eta: 0:00:25  loss: 0.6435 (0.6909)  acc1: 81.2500 (81.7760)  acc5: 96.8750 (95.9777)  time: 0.0703  data: 0.0295  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1951 (0.7917)  acc1: 68.7500 (79.2755)  acc5: 87.5000 (94.9160)  time: 0.0597  data: 0.0233  max mem: 21519
Test:   [300/391]  eta: 0:00:07  loss: 1.2168 (0.9197)  acc1: 68.7500 (76.7442)  acc5: 87.5000 (93.4282)  time: 0.0581  data: 0.0205  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.222 Acc@5 92.956
Number of added parameters: 135172
Training time 1:12:11
Experiment with model=resnet50, n_components=4, and dof=16 completed
-----------------------------------
Running experiment with n_components=4 and dof=32
[2024-11-14 13:08:38,491] torch.distributed.run: [WARNING] 
[2024-11-14 13:08:38,491] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 13:08:38,491] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 13:08:38,491] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 3): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=4, dof=32, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.7060620784759521
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 266244
Start training
Epoch: [0]  [    0/10010]  eta: 14:00:50  lr: 0.01  img/s: 10.57890477713184  loss: 1.0047 (1.0047)  acc1: 68.7500 (68.7500)  acc5: 93.7500 (93.7500)  time: 5.0401  data: 2.0151  max mem: 21511
Epoch: [0]  [ 1000/10010]  eta: 0:12:51  lr: 0.01  img/s: 399.8538074937363  loss: 0.8387 (0.9046)  acc1: 81.2500 (78.0157)  acc5: 93.7500 (92.0642)  time: 0.0807  data: 0.0001  max mem: 21511
Epoch: [0]  [ 2000/10010]  eta: 0:11:06  lr: 0.01  img/s: 378.59854673466623  loss: 0.8535 (0.9039)  acc1: 78.1250 (77.9844)  acc5: 93.7500 (92.0305)  time: 0.0811  data: 0.0001  max mem: 21511
Epoch: [0]  [ 3000/10010]  eta: 0:09:37  lr: 0.01  img/s: 401.2152286206237  loss: 0.8622 (0.9015)  acc1: 78.1250 (77.9292)  acc5: 90.6250 (92.1037)  time: 0.0807  data: 0.0001  max mem: 21511
Epoch: [0]  [ 4000/10010]  eta: 0:08:12  lr: 0.01  img/s: 400.73606267615725  loss: 0.8645 (0.8994)  acc1: 78.1250 (77.9664)  acc5: 90.6250 (92.1293)  time: 0.0813  data: 0.0001  max mem: 21511
Epoch: [0]  [ 5000/10010]  eta: 0:06:49  lr: 0.01  img/s: 400.2508782288703  loss: 0.8961 (0.9015)  acc1: 78.1250 (77.9125)  acc5: 90.6250 (92.1291)  time: 0.0810  data: 0.0001  max mem: 21511
Epoch: [0]  [ 6000/10010]  eta: 0:05:26  lr: 0.01  img/s: 403.7036208213772  loss: 0.8872 (0.9004)  acc1: 75.0000 (77.9146)  acc5: 90.6250 (92.1747)  time: 0.0800  data: 0.0001  max mem: 21511
Epoch: [0]  [ 7000/10010]  eta: 0:04:04  lr: 0.01  img/s: 383.0338092560936  loss: 0.9727 (0.8990)  acc1: 75.0000 (77.9371)  acc5: 90.6250 (92.1748)  time: 0.0806  data: 0.0001  max mem: 21511
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 392.0860722663496  loss: 0.8595 (0.8990)  acc1: 78.1250 (77.9395)  acc5: 93.7500 (92.1693)  time: 0.0803  data: 0.0001  max mem: 21511
Epoch: [0]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 395.11246265031866  loss: 1.0302 (0.8985)  acc1: 75.0000 (77.9667)  acc5: 90.6250 (92.1571)  time: 0.0801  data: 0.0001  max mem: 21511
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 401.48646433464353  loss: 0.8606 (0.8974)  acc1: 78.1250 (78.0138)  acc5: 90.6250 (92.1877)  time: 0.0793  data: 0.0001  max mem: 21511
Epoch: [0] Total time: 0:13:33
Test:   [  0/391]  eta: 0:09:56  loss: 0.3907 (0.3907)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5246  data: 1.3803  max mem: 21511
Test:   [100/391]  eta: 0:00:27  loss: 0.6441 (0.6913)  acc1: 81.2500 (81.6522)  acc5: 96.8750 (95.9468)  time: 0.0562  data: 0.0208  max mem: 21511
Test:   [200/391]  eta: 0:00:15  loss: 1.1965 (0.7931)  acc1: 68.7500 (79.2444)  acc5: 87.5000 (94.8539)  time: 0.0689  data: 0.0380  max mem: 21511
Test:   [300/391]  eta: 0:00:07  loss: 1.2374 (0.9210)  acc1: 68.7500 (76.7546)  acc5: 87.5000 (93.4074)  time: 0.0636  data: 0.0297  max mem: 21511
Test:  Total time: 0:00:28
Test:  Acc@1 76.174 Acc@5 92.928
Number of added parameters: 266244
Epoch: [1]  [    0/10010]  eta: 5:24:20  lr: 0.01  img/s: 53.995774242187736  loss: 0.5606 (0.5606)  acc1: 90.6250 (90.6250)  acc5: 96.8750 (96.8750)  time: 1.9441  data: 1.3515  max mem: 21511
Epoch: [1]  [ 1000/10010]  eta: 0:12:37  lr: 0.01  img/s: 396.01128276545774  loss: 0.7797 (0.8908)  acc1: 78.1250 (78.1718)  acc5: 93.7500 (92.3358)  time: 0.0820  data: 0.0001  max mem: 21511
Epoch: [1]  [ 2000/10010]  eta: 0:11:05  lr: 0.01  img/s: 390.8495282469423  loss: 0.7732 (0.8935)  acc1: 78.1250 (78.1719)  acc5: 90.6250 (92.2711)  time: 0.0819  data: 0.0001  max mem: 21511
Epoch: [1]  [ 3000/10010]  eta: 0:09:40  lr: 0.01  img/s: 398.50632715957744  loss: 0.8220 (0.8937)  acc1: 75.0000 (78.1542)  acc5: 93.7500 (92.2786)  time: 0.0818  data: 0.0001  max mem: 21511
Epoch: [1]  [ 4000/10010]  eta: 0:08:17  lr: 0.01  img/s: 395.086875252048  loss: 0.8103 (0.8912)  acc1: 78.1250 (78.1359)  acc5: 93.7500 (92.2933)  time: 0.0820  data: 0.0001  max mem: 21511
Epoch: [1]  [ 5000/10010]  eta: 0:06:53  lr: 0.01  img/s: 395.07059408767526  loss: 0.8733 (0.8925)  acc1: 78.1250 (78.0913)  acc5: 90.6250 (92.2803)  time: 0.0818  data: 0.0001  max mem: 21511
Epoch: [1]  [ 6000/10010]  eta: 0:05:30  lr: 0.01  img/s: 387.27786546324376  loss: 0.5944 (0.8936)  acc1: 81.2500 (78.0828)  acc5: 93.7500 (92.2732)  time: 0.0845  data: 0.0001  max mem: 21511
Epoch: [1]  [ 7000/10010]  eta: 0:04:08  lr: 0.01  img/s: 392.70441046527276  loss: 0.8686 (0.8926)  acc1: 81.2500 (78.0643)  acc5: 93.7500 (92.3212)  time: 0.0817  data: 0.0001  max mem: 21511
Epoch: [1]  [ 8000/10010]  eta: 0:02:45  lr: 0.01  img/s: 392.3978657778947  loss: 0.9620 (0.8939)  acc1: 78.1250 (78.0086)  acc5: 90.6250 (92.3033)  time: 0.0818  data: 0.0001  max mem: 21511
Epoch: [1]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 393.61538123154253  loss: 0.8906 (0.8959)  acc1: 78.1250 (77.9917)  acc5: 90.6250 (92.2627)  time: 0.0819  data: 0.0001  max mem: 21511
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 418.8374831878622  loss: 0.8066 (0.8942)  acc1: 78.1250 (78.0013)  acc5: 93.7500 (92.2830)  time: 0.0795  data: 0.0001  max mem: 21511
Epoch: [1] Total time: 0:13:44
Test:   [  0/391]  eta: 0:09:14  loss: 0.3914 (0.3914)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4179  data: 1.3883  max mem: 21511
Test:   [100/391]  eta: 0:00:25  loss: 0.6484 (0.6918)  acc1: 81.2500 (81.8069)  acc5: 96.8750 (95.9468)  time: 0.0768  data: 0.0394  max mem: 21511
Test:   [200/391]  eta: 0:00:14  loss: 1.1903 (0.7931)  acc1: 68.7500 (79.3688)  acc5: 87.5000 (94.8694)  time: 0.0552  data: 0.0228  max mem: 21511
Test:   [300/391]  eta: 0:00:06  loss: 1.2309 (0.9205)  acc1: 68.7500 (76.8272)  acc5: 87.5000 (93.4178)  time: 0.0590  data: 0.0232  max mem: 21511
Test:  Total time: 0:00:27
Test:  Acc@1 76.198 Acc@5 92.946
Number of added parameters: 266244
Epoch: [2]  [    0/10010]  eta: 6:58:38  lr: 0.01  img/s: 45.63940384177256  loss: 1.5837 (1.5837)  acc1: 68.7500 (68.7500)  acc5: 84.3750 (84.3750)  time: 2.5093  data: 1.8082  max mem: 21511
Epoch: [2]  [ 1000/10010]  eta: 0:13:00  lr: 0.01  img/s: 365.4360775536987  loss: 0.8155 (0.8779)  acc1: 78.1250 (78.2717)  acc5: 90.6250 (92.2796)  time: 0.0869  data: 0.0001  max mem: 21511
Epoch: [2]  [ 2000/10010]  eta: 0:11:29  lr: 0.01  img/s: 382.53054710033405  loss: 0.9450 (0.8872)  acc1: 75.0000 (78.1203)  acc5: 90.6250 (92.2586)  time: 0.0836  data: 0.0001  max mem: 21511
Epoch: [2]  [ 3000/10010]  eta: 0:10:00  lr: 0.01  img/s: 380.98648272729855  loss: 0.7991 (0.8902)  acc1: 78.1250 (78.1448)  acc5: 93.7500 (92.2547)  time: 0.0833  data: 0.0001  max mem: 21511
Epoch: [2]  [ 4000/10010]  eta: 0:08:32  lr: 0.01  img/s: 391.0032423929034  loss: 0.7992 (0.8918)  acc1: 78.1250 (78.0820)  acc5: 90.6250 (92.2894)  time: 0.0837  data: 0.0002  max mem: 21511
Epoch: [2]  [ 5000/10010]  eta: 0:07:05  lr: 0.01  img/s: 386.288089105064  loss: 0.9535 (0.8955)  acc1: 75.0000 (78.0113)  acc5: 93.7500 (92.2447)  time: 0.0830  data: 0.0001  max mem: 21511
Epoch: [2]  [ 6000/10010]  eta: 0:05:39  lr: 0.01  img/s: 386.4237719997812  loss: 0.8264 (0.8947)  acc1: 78.1250 (78.0313)  acc5: 90.6250 (92.2299)  time: 0.0839  data: 0.0001  max mem: 21511
Epoch: [2]  [ 7000/10010]  eta: 0:04:14  lr: 0.01  img/s: 385.97704573885284  loss: 0.9627 (0.8949)  acc1: 75.0000 (78.0295)  acc5: 90.6250 (92.2551)  time: 0.0836  data: 0.0001  max mem: 21511
Epoch: [2]  [ 8000/10010]  eta: 0:02:49  lr: 0.01  img/s: 383.6908009273685  loss: 0.7244 (0.8947)  acc1: 81.2500 (78.0027)  acc5: 93.7500 (92.2459)  time: 0.0834  data: 0.0001  max mem: 21511
Epoch: [2]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 385.5889452288952  loss: 0.7841 (0.8949)  acc1: 81.2500 (77.9802)  acc5: 93.7500 (92.2398)  time: 0.0831  data: 0.0001  max mem: 21511
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 392.59987890098256  loss: 0.7974 (0.8954)  acc1: 78.1250 (77.9913)  acc5: 93.7500 (92.2330)  time: 0.0812  data: 0.0001  max mem: 21511
Epoch: [2] Total time: 0:14:03
Test:   [  0/391]  eta: 0:10:01  loss: 0.3964 (0.3964)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5391  data: 1.5086  max mem: 21511
Test:   [100/391]  eta: 0:00:25  loss: 0.6407 (0.6912)  acc1: 81.2500 (81.7450)  acc5: 96.8750 (95.9468)  time: 0.0695  data: 0.0343  max mem: 21511
Test:   [200/391]  eta: 0:00:15  loss: 1.1841 (0.7919)  acc1: 68.7500 (79.2755)  acc5: 87.5000 (94.9160)  time: 0.0734  data: 0.0399  max mem: 21511
Test:   [300/391]  eta: 0:00:06  loss: 1.2319 (0.9194)  acc1: 68.7500 (76.7650)  acc5: 87.5000 (93.4385)  time: 0.0585  data: 0.0226  max mem: 21511
Test:  Total time: 0:00:27
Test:  Acc@1 76.204 Acc@5 92.966
Number of added parameters: 266244
Epoch: [3]  [    0/10010]  eta: 4:37:20  lr: 0.01  img/s: 215.4989908850508  loss: 0.6538 (0.6538)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6624  data: 1.5139  max mem: 21511
Epoch: [3]  [ 1000/10010]  eta: 0:13:04  lr: 0.01  img/s: 381.42280902676146  loss: 0.9023 (0.8998)  acc1: 75.0000 (77.9689)  acc5: 93.7500 (92.2172)  time: 0.0849  data: 0.0001  max mem: 21511
Epoch: [3]  [ 2000/10010]  eta: 0:11:29  lr: 0.01  img/s: 375.2882879104348  loss: 0.9225 (0.9040)  acc1: 75.0000 (77.8017)  acc5: 90.6250 (92.2664)  time: 0.0849  data: 0.0001  max mem: 21511
Epoch: [3]  [ 3000/10010]  eta: 0:10:01  lr: 0.01  img/s: 381.8242873033168  loss: 0.7569 (0.9047)  acc1: 81.2500 (77.8345)  acc5: 93.7500 (92.2036)  time: 0.0848  data: 0.0001  max mem: 21511
Epoch: [3]  [ 4000/10010]  eta: 0:08:34  lr: 0.01  img/s: 378.01954063454957  loss: 0.8635 (0.9036)  acc1: 78.1250 (77.8618)  acc5: 93.7500 (92.2090)  time: 0.0849  data: 0.0001  max mem: 21511
Epoch: [3]  [ 5000/10010]  eta: 0:07:07  lr: 0.01  img/s: 385.12093840026625  loss: 0.8553 (0.9029)  acc1: 78.1250 (77.8451)  acc5: 93.7500 (92.1872)  time: 0.0852  data: 0.0001  max mem: 21511
Epoch: [3]  [ 6000/10010]  eta: 0:05:42  lr: 0.01  img/s: 385.419534915776  loss: 0.8007 (0.9015)  acc1: 81.2500 (77.8500)  acc5: 93.7500 (92.1924)  time: 0.0845  data: 0.0001  max mem: 21511
Epoch: [3]  [ 7000/10010]  eta: 0:04:16  lr: 0.01  img/s: 375.1393394283095  loss: 0.7204 (0.8997)  acc1: 81.2500 (77.8799)  acc5: 93.7500 (92.2096)  time: 0.0849  data: 0.0001  max mem: 21511
Epoch: [3]  [ 8000/10010]  eta: 0:02:51  lr: 0.01  img/s: 384.2389180894798  loss: 0.7052 (0.8964)  acc1: 78.1250 (77.9426)  acc5: 93.7500 (92.2506)  time: 0.0849  data: 0.0001  max mem: 21511
Epoch: [3]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 376.85306917793986  loss: 0.8677 (0.8941)  acc1: 78.1250 (77.9660)  acc5: 93.7500 (92.2932)  time: 0.0847  data: 0.0001  max mem: 21511
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 401.91927939582325  loss: 0.8838 (0.8929)  acc1: 78.1250 (77.9906)  acc5: 90.6250 (92.3101)  time: 0.0828  data: 0.0001  max mem: 21511
Epoch: [3] Total time: 0:14:12
Test:   [  0/391]  eta: 0:09:38  loss: 0.3977 (0.3977)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4802  data: 1.4458  max mem: 21511
Test:   [100/391]  eta: 0:00:26  loss: 0.6462 (0.6924)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.9468)  time: 0.0656  data: 0.0348  max mem: 21511
Test:   [200/391]  eta: 0:00:14  loss: 1.1866 (0.7920)  acc1: 68.7500 (79.3377)  acc5: 87.5000 (94.9316)  time: 0.0641  data: 0.0282  max mem: 21511
Test:   [300/391]  eta: 0:00:06  loss: 1.2282 (0.9199)  acc1: 68.7500 (76.8169)  acc5: 87.5000 (93.4593)  time: 0.0545  data: 0.0192  max mem: 21511
Test:  Total time: 0:00:28
Test:  Acc@1 76.208 Acc@5 92.960
Number of added parameters: 266244
Epoch: [4]  [    0/10010]  eta: 5:38:02  lr: 0.01  img/s: 232.44586302745859  loss: 0.7223 (0.7223)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 2.0263  data: 1.8886  max mem: 21511
Epoch: [4]  [ 1000/10010]  eta: 0:13:15  lr: 0.01  img/s: 365.20042011547736  loss: 0.7018 (0.8925)  acc1: 81.2500 (77.7847)  acc5: 93.7500 (92.3889)  time: 0.0864  data: 0.0001  max mem: 21511
Epoch: [4]  [ 2000/10010]  eta: 0:11:39  lr: 0.01  img/s: 376.0274334894771  loss: 0.9120 (0.8965)  acc1: 78.1250 (77.8423)  acc5: 93.7500 (92.2164)  time: 0.0860  data: 0.0001  max mem: 21511
Epoch: [4]  [ 3000/10010]  eta: 0:10:10  lr: 0.01  img/s: 374.55099722891197  loss: 0.8954 (0.8930)  acc1: 78.1250 (78.0115)  acc5: 90.6250 (92.2567)  time: 0.0867  data: 0.0001  max mem: 21511
Epoch: [4]  [ 4000/10010]  eta: 0:08:41  lr: 0.01  img/s: 377.61220803628197  loss: 0.8084 (0.8896)  acc1: 78.1250 (78.0938)  acc5: 93.7500 (92.2879)  time: 0.0859  data: 0.0001  max mem: 21511
Epoch: [4]  [ 5000/10010]  eta: 0:07:14  lr: 0.01  img/s: 371.24305186758716  loss: 0.7573 (0.8891)  acc1: 78.1250 (78.0769)  acc5: 93.7500 (92.3034)  time: 0.0861  data: 0.0001  max mem: 21511
Epoch: [4]  [ 6000/10010]  eta: 0:05:47  lr: 0.01  img/s: 374.6482288904396  loss: 0.8454 (0.8888)  acc1: 81.2500 (78.1052)  acc5: 93.7500 (92.2924)  time: 0.0862  data: 0.0001  max mem: 21511
Epoch: [4]  [ 7000/10010]  eta: 0:04:20  lr: 0.01  img/s: 378.4064145794097  loss: 0.9140 (0.8868)  acc1: 75.0000 (78.1696)  acc5: 93.7500 (92.3163)  time: 0.0859  data: 0.0002  max mem: 21511
Epoch: [4]  [ 8000/10010]  eta: 0:02:53  lr: 0.01  img/s: 372.9326864833925  loss: 0.8533 (0.8862)  acc1: 78.1250 (78.1723)  acc5: 93.7500 (92.3447)  time: 0.0857  data: 0.0001  max mem: 21511
Epoch: [4]  [ 9000/10010]  eta: 0:01:27  lr: 0.01  img/s: 375.2263865048169  loss: 0.8691 (0.8863)  acc1: 78.1250 (78.1812)  acc5: 90.6250 (92.3481)  time: 0.0861  data: 0.0001  max mem: 21511
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 375.10264493482686  loss: 0.8030 (0.8899)  acc1: 78.1250 (78.1188)  acc5: 93.7500 (92.3098)  time: 0.0851  data: 0.0001  max mem: 21511
Epoch: [4] Total time: 0:14:26
Test:   [  0/391]  eta: 0:09:24  loss: 0.3960 (0.3960)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4432  data: 1.3959  max mem: 21511
Test:   [100/391]  eta: 0:00:25  loss: 0.6452 (0.6911)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.9777)  time: 0.0690  data: 0.0268  max mem: 21511
Test:   [200/391]  eta: 0:00:14  loss: 1.2016 (0.7918)  acc1: 68.7500 (79.3999)  acc5: 87.5000 (94.9316)  time: 0.0645  data: 0.0294  max mem: 21511
Test:   [300/391]  eta: 0:00:06  loss: 1.2355 (0.9198)  acc1: 68.7500 (76.8376)  acc5: 87.5000 (93.4489)  time: 0.0694  data: 0.0287  max mem: 21511
Test:  Total time: 0:00:28
Test:  Acc@1 76.222 Acc@5 92.972
Number of added parameters: 266244
Training time 1:12:25
Experiment with model=resnet50, n_components=4, and dof=32 completed
-----------------------------------
Running experiment with n_components=8 and dof=4
[2024-11-14 14:21:17,519] torch.distributed.run: [WARNING] 
[2024-11-14 14:21:17,519] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 14:21:17,519] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 14:21:17,519] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 3): env://
| distributed init (rank 1): env://
| distributed init (rank 2): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=8, dof=4, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.664626121520996
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 73736
Start training
Epoch: [0]  [    0/10010]  eta: 13:57:44  lr: 0.01  img/s: 9.782204729953156  loss: 1.0128 (1.0128)  acc1: 68.7500 (68.7500)  acc5: 90.6250 (90.6250)  time: 5.0214  data: 1.7501  max mem: 21509
Epoch: [0]  [ 1000/10010]  eta: 0:12:47  lr: 0.01  img/s: 403.37118470878164  loss: 0.7399 (0.8971)  acc1: 81.2500 (78.0844)  acc5: 90.6250 (92.1422)  time: 0.0804  data: 0.0001  max mem: 21509
Epoch: [0]  [ 2000/10010]  eta: 0:11:04  lr: 0.01  img/s: 345.966562701379  loss: 0.8929 (0.8982)  acc1: 78.1250 (78.0688)  acc5: 93.7500 (92.1945)  time: 0.0811  data: 0.0001  max mem: 21509
Epoch: [0]  [ 3000/10010]  eta: 0:09:35  lr: 0.01  img/s: 408.92112703519547  loss: 0.8806 (0.8983)  acc1: 78.1250 (77.9917)  acc5: 90.6250 (92.1828)  time: 0.0799  data: 0.0001  max mem: 21509
Epoch: [0]  [ 4000/10010]  eta: 0:08:10  lr: 0.01  img/s: 386.3158852142878  loss: 0.7434 (0.8966)  acc1: 78.1250 (78.0008)  acc5: 93.7500 (92.2168)  time: 0.0808  data: 0.0001  max mem: 21509
Epoch: [0]  [ 5000/10010]  eta: 0:06:47  lr: 0.01  img/s: 390.34823653956335  loss: 0.8323 (0.8964)  acc1: 75.0000 (77.9663)  acc5: 93.7500 (92.2472)  time: 0.0814  data: 0.0001  max mem: 21509
Epoch: [0]  [ 6000/10010]  eta: 0:05:25  lr: 0.01  img/s: 400.13274782147255  loss: 1.0027 (0.8944)  acc1: 78.1250 (77.9880)  acc5: 90.6250 (92.2700)  time: 0.0799  data: 0.0001  max mem: 21509
Epoch: [0]  [ 7000/10010]  eta: 0:04:04  lr: 0.01  img/s: 397.02926446879945  loss: 0.8763 (0.8934)  acc1: 81.2500 (78.0188)  acc5: 93.7500 (92.2899)  time: 0.0803  data: 0.0001  max mem: 21509
Epoch: [0]  [ 8000/10010]  eta: 0:02:42  lr: 0.01  img/s: 398.9327372920147  loss: 0.9459 (0.8930)  acc1: 75.0000 (78.0027)  acc5: 93.7500 (92.3146)  time: 0.0804  data: 0.0001  max mem: 21509
Epoch: [0]  [ 9000/10010]  eta: 0:01:21  lr: 0.01  img/s: 404.07309686237437  loss: 0.9034 (0.8924)  acc1: 78.1250 (78.0337)  acc5: 90.6250 (92.3241)  time: 0.0803  data: 0.0001  max mem: 21509
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 417.0143232645858  loss: 0.8246 (0.8916)  acc1: 78.1250 (78.0653)  acc5: 93.7500 (92.3483)  time: 0.0789  data: 0.0001  max mem: 21509
Epoch: [0] Total time: 0:13:31
Test:   [  0/391]  eta: 0:10:38  loss: 0.3942 (0.3942)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6329  data: 1.5282  max mem: 21509
Test:   [100/391]  eta: 0:00:26  loss: 0.6544 (0.6905)  acc1: 81.2500 (81.7760)  acc5: 96.8750 (95.9777)  time: 0.0711  data: 0.0394  max mem: 21509
Test:   [200/391]  eta: 0:00:15  loss: 1.1912 (0.7916)  acc1: 68.7500 (79.3377)  acc5: 87.5000 (94.8850)  time: 0.0542  data: 0.0252  max mem: 21509
Test:   [300/391]  eta: 0:00:07  loss: 1.2321 (0.9201)  acc1: 68.7500 (76.8065)  acc5: 87.5000 (93.3866)  time: 0.0735  data: 0.0415  max mem: 21509
Test:  Total time: 0:00:28
Test:  Acc@1 76.180 Acc@5 92.966
Number of added parameters: 73736
Epoch: [1]  [    0/10010]  eta: 4:46:13  lr: 0.01  img/s: 143.64531357525775  loss: 0.7599 (0.7599)  acc1: 84.3750 (84.3750)  acc5: 90.6250 (90.6250)  time: 1.7156  data: 1.4928  max mem: 21509
Epoch: [1]  [ 1000/10010]  eta: 0:12:34  lr: 0.01  img/s: 397.67744382288805  loss: 0.7883 (0.8787)  acc1: 78.1250 (78.3248)  acc5: 93.7500 (92.5106)  time: 0.0819  data: 0.0001  max mem: 21509
Epoch: [1]  [ 2000/10010]  eta: 0:11:03  lr: 0.01  img/s: 392.4793346862627  loss: 0.8938 (0.8851)  acc1: 78.1250 (78.0688)  acc5: 93.7500 (92.4272)  time: 0.0818  data: 0.0001  max mem: 21509
Epoch: [1]  [ 3000/10010]  eta: 0:09:38  lr: 0.01  img/s: 383.26240583898254  loss: 0.7664 (0.8865)  acc1: 78.1250 (78.0552)  acc5: 93.7500 (92.3578)  time: 0.0819  data: 0.0001  max mem: 21509
Epoch: [1]  [ 4000/10010]  eta: 0:08:15  lr: 0.01  img/s: 395.8220864323505  loss: 0.8967 (0.8856)  acc1: 81.2500 (78.0984)  acc5: 90.6250 (92.3964)  time: 0.0820  data: 0.0001  max mem: 21509
Epoch: [1]  [ 5000/10010]  eta: 0:06:53  lr: 0.01  img/s: 369.1681556132553  loss: 0.8577 (0.8885)  acc1: 81.2500 (78.0456)  acc5: 93.7500 (92.3447)  time: 0.0818  data: 0.0001  max mem: 21509
Epoch: [1]  [ 6000/10010]  eta: 0:05:30  lr: 0.01  img/s: 391.67073654721605  loss: 0.7210 (0.8885)  acc1: 81.2500 (78.0609)  acc5: 90.6250 (92.3294)  time: 0.0818  data: 0.0001  max mem: 21509
Epoch: [1]  [ 7000/10010]  eta: 0:04:07  lr: 0.01  img/s: 397.8920082295255  loss: 0.7691 (0.8880)  acc1: 78.1250 (78.0478)  acc5: 93.7500 (92.3399)  time: 0.0815  data: 0.0001  max mem: 21509
Epoch: [1]  [ 8000/10010]  eta: 0:02:45  lr: 0.01  img/s: 396.65027868242026  loss: 0.8978 (0.8894)  acc1: 78.1250 (78.0215)  acc5: 90.6250 (92.3185)  time: 0.0824  data: 0.0001  max mem: 21509
Epoch: [1]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 394.9961829926868  loss: 0.9703 (0.8914)  acc1: 75.0000 (78.0035)  acc5: 90.6250 (92.2901)  time: 0.0812  data: 0.0001  max mem: 21509
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 382.221169180298  loss: 0.9158 (0.8914)  acc1: 75.0000 (78.0147)  acc5: 93.7500 (92.2955)  time: 0.0815  data: 0.0001  max mem: 21509
Epoch: [1] Total time: 0:13:44
Test:   [  0/391]  eta: 0:11:45  loss: 0.3998 (0.3998)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.8039  data: 1.7553  max mem: 21509
Test:   [100/391]  eta: 0:00:25  loss: 0.6442 (0.6909)  acc1: 81.2500 (82.0235)  acc5: 96.8750 (95.8849)  time: 0.0560  data: 0.0220  max mem: 21509
Test:   [200/391]  eta: 0:00:15  loss: 1.1820 (0.7921)  acc1: 68.7500 (79.5087)  acc5: 87.5000 (94.8850)  time: 0.0752  data: 0.0433  max mem: 21509
Test:   [300/391]  eta: 0:00:06  loss: 1.2276 (0.9198)  acc1: 68.7500 (76.9518)  acc5: 87.5000 (93.3970)  time: 0.0557  data: 0.0250  max mem: 21509
Test:  Total time: 0:00:27
Test:  Acc@1 76.238 Acc@5 92.964
Number of added parameters: 73736
Epoch: [2]  [    0/10010]  eta: 5:58:57  lr: 0.01  img/s: 270.6095329880258  loss: 1.4514 (1.4514)  acc1: 62.5000 (62.5000)  acc5: 81.2500 (81.2500)  time: 2.1516  data: 2.0334  max mem: 21509
Epoch: [2]  [ 1000/10010]  eta: 0:12:49  lr: 0.01  img/s: 370.23435332022143  loss: 0.7284 (0.8673)  acc1: 81.2500 (78.4341)  acc5: 96.8750 (92.6324)  time: 0.0834  data: 0.0002  max mem: 21509
Epoch: [2]  [ 2000/10010]  eta: 0:11:21  lr: 0.01  img/s: 384.1124596835354  loss: 0.9360 (0.8843)  acc1: 78.1250 (78.1719)  acc5: 90.6250 (92.4007)  time: 0.0828  data: 0.0001  max mem: 21509
Epoch: [2]  [ 3000/10010]  eta: 0:09:57  lr: 0.01  img/s: 379.2457566535841  loss: 0.8178 (0.8854)  acc1: 78.1250 (78.1771)  acc5: 90.6250 (92.4036)  time: 0.0831  data: 0.0001  max mem: 21509
Epoch: [2]  [ 4000/10010]  eta: 0:08:30  lr: 0.01  img/s: 354.7392614363192  loss: 0.8023 (0.8898)  acc1: 81.2500 (78.1789)  acc5: 90.6250 (92.3152)  time: 0.0841  data: 0.0001  max mem: 21509
Epoch: [2]  [ 5000/10010]  eta: 0:07:04  lr: 0.01  img/s: 376.72719515652324  loss: 0.7741 (0.8904)  acc1: 78.1250 (78.1431)  acc5: 93.7500 (92.2909)  time: 0.0828  data: 0.0002  max mem: 21509
Epoch: [2]  [ 6000/10010]  eta: 0:05:38  lr: 0.01  img/s: 373.36321328129566  loss: 0.9122 (0.8896)  acc1: 78.1250 (78.1562)  acc5: 90.6250 (92.2919)  time: 0.0834  data: 0.0001  max mem: 21509
Epoch: [2]  [ 7000/10010]  eta: 0:04:14  lr: 0.01  img/s: 364.47052306288595  loss: 0.7711 (0.8896)  acc1: 78.1250 (78.1513)  acc5: 93.7500 (92.2957)  time: 0.0871  data: 0.0002  max mem: 21509
Epoch: [2]  [ 8000/10010]  eta: 0:02:49  lr: 0.01  img/s: 386.1014029566513  loss: 0.7251 (0.8898)  acc1: 81.2500 (78.1234)  acc5: 93.7500 (92.2971)  time: 0.0832  data: 0.0001  max mem: 21509
Epoch: [2]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 393.0298481676159  loss: 0.7084 (0.8908)  acc1: 78.1250 (78.1003)  acc5: 93.7500 (92.2797)  time: 0.0838  data: 0.0001  max mem: 21509
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 417.0000714585307  loss: 0.9437 (0.8920)  acc1: 75.0000 (78.0731)  acc5: 90.6250 (92.2639)  time: 0.0803  data: 0.0001  max mem: 21509
Epoch: [2] Total time: 0:14:04
Test:   [  0/391]  eta: 0:10:06  loss: 0.3959 (0.3959)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5523  data: 1.5099  max mem: 21509
Test:   [100/391]  eta: 0:00:25  loss: 0.6408 (0.6917)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.8540)  time: 0.0910  data: 0.0514  max mem: 21509
Test:   [200/391]  eta: 0:00:15  loss: 1.1856 (0.7916)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.8850)  time: 0.0590  data: 0.0230  max mem: 21509
Test:   [300/391]  eta: 0:00:06  loss: 1.2346 (0.9193)  acc1: 68.7500 (76.8065)  acc5: 87.5000 (93.4178)  time: 0.0671  data: 0.0321  max mem: 21509
Test:  Total time: 0:00:28
Test:  Acc@1 76.226 Acc@5 92.962
Number of added parameters: 73736
Epoch: [3]  [    0/10010]  eta: 5:18:30  lr: 0.01  img/s: 201.13370477711874  loss: 0.6718 (0.6718)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 1.9091  data: 1.7500  max mem: 21509
Epoch: [3]  [ 1000/10010]  eta: 0:13:35  lr: 0.01  img/s: 367.15348106892657  loss: 0.7408 (0.8866)  acc1: 78.1250 (78.2218)  acc5: 93.7500 (92.3608)  time: 0.0889  data: 0.0001  max mem: 21509
Epoch: [3]  [ 2000/10010]  eta: 0:11:56  lr: 0.01  img/s: 350.38029775781007  loss: 0.9967 (0.8897)  acc1: 75.0000 (77.9844)  acc5: 90.6250 (92.3616)  time: 0.0886  data: 0.0002  max mem: 21509
Epoch: [3]  [ 3000/10010]  eta: 0:10:23  lr: 0.01  img/s: 368.15048837955635  loss: 0.8942 (0.8943)  acc1: 78.1250 (77.9823)  acc5: 90.6250 (92.2703)  time: 0.0850  data: 0.0001  max mem: 21509
Epoch: [3]  [ 4000/10010]  eta: 0:08:52  lr: 0.01  img/s: 381.83189098460923  loss: 0.9882 (0.8954)  acc1: 81.2500 (77.9664)  acc5: 90.6250 (92.2637)  time: 0.0846  data: 0.0001  max mem: 21509
Epoch: [3]  [ 5000/10010]  eta: 0:07:26  lr: 0.01  img/s: 369.7020132601372  loss: 0.8085 (0.8976)  acc1: 78.1250 (77.9794)  acc5: 93.7500 (92.2328)  time: 0.0912  data: 0.0001  max mem: 21509
Epoch: [3]  [ 6000/10010]  eta: 0:05:55  lr: 0.01  img/s: 387.7970661912783  loss: 0.8134 (0.8966)  acc1: 78.1250 (78.0052)  acc5: 90.6250 (92.2351)  time: 0.0844  data: 0.0001  max mem: 21509
Epoch: [3]  [ 7000/10010]  eta: 0:04:24  lr: 0.01  img/s: 380.0576184125204  loss: 0.8039 (0.8951)  acc1: 78.1250 (78.0241)  acc5: 90.6250 (92.2663)  time: 0.0849  data: 0.0001  max mem: 21509
Epoch: [3]  [ 8000/10010]  eta: 0:02:56  lr: 0.01  img/s: 376.1591654965794  loss: 0.7742 (0.8942)  acc1: 81.2500 (78.0238)  acc5: 93.7500 (92.2990)  time: 0.0844  data: 0.0001  max mem: 21509
Epoch: [3]  [ 9000/10010]  eta: 0:01:28  lr: 0.01  img/s: 387.7365704001364  loss: 0.8721 (0.8948)  acc1: 78.1250 (78.0250)  acc5: 93.7500 (92.2925)  time: 0.0839  data: 0.0001  max mem: 21509
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 391.1354193076477  loss: 0.9104 (0.8946)  acc1: 78.1250 (78.0275)  acc5: 90.6250 (92.3073)  time: 0.0816  data: 0.0001  max mem: 21509
Epoch: [3] Total time: 0:14:30
Test:   [  0/391]  eta: 0:10:13  loss: 0.4015 (0.4015)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5699  data: 1.5217  max mem: 21509
Test:   [100/391]  eta: 0:00:25  loss: 0.6636 (0.6926)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.8230)  time: 0.0702  data: 0.0330  max mem: 21509
Test:   [200/391]  eta: 0:00:15  loss: 1.1756 (0.7916)  acc1: 68.7500 (79.3999)  acc5: 87.5000 (94.8539)  time: 0.0568  data: 0.0199  max mem: 21509
Test:   [300/391]  eta: 0:00:06  loss: 1.2301 (0.9196)  acc1: 68.7500 (76.8376)  acc5: 87.5000 (93.3970)  time: 0.0616  data: 0.0246  max mem: 21509
Test:  Total time: 0:00:28
Test:  Acc@1 76.230 Acc@5 92.958
Number of added parameters: 73736
Epoch: [4]  [    0/10010]  eta: 5:59:40  lr: 0.01  img/s: 209.4563250732298  loss: 0.9540 (0.9540)  acc1: 75.0000 (75.0000)  acc5: 87.5000 (87.5000)  time: 2.1559  data: 2.0031  max mem: 21509
Epoch: [4]  [ 1000/10010]  eta: 0:13:08  lr: 0.01  img/s: 371.6943868268083  loss: 0.9092 (0.8928)  acc1: 75.0000 (78.3123)  acc5: 93.7500 (92.2609)  time: 0.0850  data: 0.0001  max mem: 21509
Epoch: [4]  [ 2000/10010]  eta: 0:11:32  lr: 0.01  img/s: 380.4023115882675  loss: 0.7330 (0.8905)  acc1: 81.2500 (78.2702)  acc5: 93.7500 (92.3023)  time: 0.0847  data: 0.0001  max mem: 21509
Epoch: [4]  [ 3000/10010]  eta: 0:10:03  lr: 0.01  img/s: 375.11941866964787  loss: 0.6860 (0.8897)  acc1: 81.2500 (78.2718)  acc5: 93.7500 (92.2963)  time: 0.0847  data: 0.0001  max mem: 21509
Epoch: [4]  [ 4000/10010]  eta: 0:08:36  lr: 0.01  img/s: 377.4932583321614  loss: 0.8897 (0.8862)  acc1: 78.1250 (78.3929)  acc5: 90.6250 (92.3269)  time: 0.0860  data: 0.0001  max mem: 21509
Epoch: [4]  [ 5000/10010]  eta: 0:07:09  lr: 0.01  img/s: 382.41610608223425  loss: 0.8571 (0.8866)  acc1: 78.1250 (78.3312)  acc5: 90.6250 (92.3353)  time: 0.0852  data: 0.0001  max mem: 21509
Epoch: [4]  [ 6000/10010]  eta: 0:05:43  lr: 0.01  img/s: 373.912406847655  loss: 0.8778 (0.8886)  acc1: 78.1250 (78.2797)  acc5: 93.7500 (92.3060)  time: 0.0856  data: 0.0001  max mem: 21509
Epoch: [4]  [ 7000/10010]  eta: 0:04:18  lr: 0.01  img/s: 380.1006708938549  loss: 0.8967 (0.8869)  acc1: 81.2500 (78.3107)  acc5: 90.6250 (92.3212)  time: 0.0854  data: 0.0001  max mem: 21509
Epoch: [4]  [ 8000/10010]  eta: 0:02:52  lr: 0.01  img/s: 375.3449613378637  loss: 0.8223 (0.8874)  acc1: 75.0000 (78.2785)  acc5: 90.6250 (92.3189)  time: 0.0852  data: 0.0001  max mem: 21509
Epoch: [4]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 382.4466169912664  loss: 0.9478 (0.8872)  acc1: 78.1250 (78.2437)  acc5: 90.6250 (92.3352)  time: 0.0852  data: 0.0001  max mem: 21509
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 403.0743967445981  loss: 0.8577 (0.8893)  acc1: 78.1250 (78.1956)  acc5: 90.6250 (92.3214)  time: 0.0830  data: 0.0001  max mem: 21509
Epoch: [4] Total time: 0:14:17
Test:   [  0/391]  eta: 0:09:43  loss: 0.3988 (0.3988)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4911  data: 1.4566  max mem: 21509
Test:   [100/391]  eta: 0:00:25  loss: 0.6519 (0.6904)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.9468)  time: 0.0677  data: 0.0341  max mem: 21509
Test:   [200/391]  eta: 0:00:14  loss: 1.2124 (0.7909)  acc1: 68.7500 (79.3221)  acc5: 87.5000 (94.9316)  time: 0.0669  data: 0.0297  max mem: 21509
Test:   [300/391]  eta: 0:00:06  loss: 1.2219 (0.9193)  acc1: 68.7500 (76.7857)  acc5: 87.5000 (93.4178)  time: 0.0682  data: 0.0292  max mem: 21509
Test:  Total time: 0:00:27
Test:  Acc@1 76.230 Acc@5 92.930
Number of added parameters: 73736
Training time 1:12:32
Experiment with model=resnet50, n_components=8, and dof=4 completed
-----------------------------------
Running experiment with n_components=8 and dof=8
[2024-11-14 15:34:06,337] torch.distributed.run: [WARNING] 
[2024-11-14 15:34:06,337] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 15:34:06,337] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 15:34:06,337] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 3): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=8, dof=8, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.4208948612213135
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 139272
Start training
Epoch: [0]  [    0/10010]  eta: 14:03:21  lr: 0.01  img/s: 13.271595407843465  loss: 0.7020 (0.7020)  acc1: 81.2500 (81.2500)  acc5: 96.8750 (96.8750)  time: 5.0551  data: 2.6440  max mem: 21512
Epoch: [0]  [ 1000/10010]  eta: 0:12:49  lr: 0.01  img/s: 397.5349218807849  loss: 0.6780 (0.9014)  acc1: 81.2500 (78.1750)  acc5: 93.7500 (92.1422)  time: 0.0804  data: 0.0001  max mem: 21512
Epoch: [0]  [ 2000/10010]  eta: 0:11:05  lr: 0.01  img/s: 381.93511375439294  loss: 0.6886 (0.9003)  acc1: 81.2500 (78.0594)  acc5: 93.7500 (92.2055)  time: 0.0809  data: 0.0001  max mem: 21512
Epoch: [0]  [ 3000/10010]  eta: 0:09:36  lr: 0.01  img/s: 402.0083625864114  loss: 0.8638 (0.9027)  acc1: 75.0000 (77.9292)  acc5: 93.7500 (92.1578)  time: 0.0809  data: 0.0001  max mem: 21512
Epoch: [0]  [ 4000/10010]  eta: 0:08:12  lr: 0.01  img/s: 405.16113140338695  loss: 0.7926 (0.9002)  acc1: 78.1250 (77.9821)  acc5: 93.7500 (92.1223)  time: 0.0812  data: 0.0001  max mem: 21512
Epoch: [0]  [ 5000/10010]  eta: 0:06:49  lr: 0.01  img/s: 395.5234777893688  loss: 0.9480 (0.9026)  acc1: 75.0000 (77.9207)  acc5: 90.6250 (92.1060)  time: 0.0813  data: 0.0001  max mem: 21512
Epoch: [0]  [ 6000/10010]  eta: 0:05:26  lr: 0.01  img/s: 399.8538074937363  loss: 0.9006 (0.9014)  acc1: 75.0000 (77.9073)  acc5: 90.6250 (92.1399)  time: 0.0804  data: 0.0001  max mem: 21512
Epoch: [0]  [ 7000/10010]  eta: 0:04:04  lr: 0.01  img/s: 404.83117572540266  loss: 0.8231 (0.8974)  acc1: 78.1250 (77.9978)  acc5: 90.6250 (92.1962)  time: 0.0805  data: 0.0001  max mem: 21512
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 385.7341142794737  loss: 1.0163 (0.8966)  acc1: 75.0000 (78.0152)  acc5: 90.6250 (92.1986)  time: 0.0801  data: 0.0001  max mem: 21512
Epoch: [0]  [ 9000/10010]  eta: 0:01:21  lr: 0.01  img/s: 393.37081292735326  loss: 0.8260 (0.8951)  acc1: 78.1250 (78.0351)  acc5: 93.7500 (92.2113)  time: 0.0805  data: 0.0001  max mem: 21512
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 421.11618071090834  loss: 0.6881 (0.8940)  acc1: 78.1250 (78.0588)  acc5: 96.8750 (92.2320)  time: 0.0817  data: 0.0001  max mem: 21512
Epoch: [0] Total time: 0:13:33
Test:   [  0/391]  eta: 0:11:13  loss: 0.3923 (0.3923)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7225  data: 1.5786  max mem: 21512
Test:   [100/391]  eta: 0:00:26  loss: 0.6495 (0.6905)  acc1: 81.2500 (81.6832)  acc5: 96.8750 (96.0705)  time: 0.0740  data: 0.0382  max mem: 21512
Test:   [200/391]  eta: 0:00:15  loss: 1.1967 (0.7917)  acc1: 68.7500 (79.2755)  acc5: 87.5000 (94.9938)  time: 0.0581  data: 0.0241  max mem: 21512
Test:   [300/391]  eta: 0:00:06  loss: 1.2436 (0.9199)  acc1: 68.7500 (76.7857)  acc5: 87.5000 (93.5008)  time: 0.0562  data: 0.0202  max mem: 21512
Test:  Total time: 0:00:28
Test:  Acc@1 76.200 Acc@5 92.988
Number of added parameters: 139272
Epoch: [1]  [    0/10010]  eta: 4:46:25  lr: 0.01  img/s: 108.71952124367776  loss: 0.8689 (0.8689)  acc1: 81.2500 (81.2500)  acc5: 87.5000 (87.5000)  time: 1.7168  data: 1.4225  max mem: 21512
Epoch: [1]  [ 1000/10010]  eta: 0:12:33  lr: 0.01  img/s: 398.0099993476108  loss: 0.7268 (0.8900)  acc1: 78.1250 (77.9970)  acc5: 93.7500 (92.3139)  time: 0.0816  data: 0.0001  max mem: 21512
Epoch: [1]  [ 2000/10010]  eta: 0:11:02  lr: 0.01  img/s: 392.76646650513277  loss: 0.8691 (0.8878)  acc1: 78.1250 (77.9938)  acc5: 93.7500 (92.3882)  time: 0.0823  data: 0.0001  max mem: 21512
Epoch: [1]  [ 3000/10010]  eta: 0:09:37  lr: 0.01  img/s: 404.39816206932915  loss: 0.8652 (0.8888)  acc1: 81.2500 (78.1312)  acc5: 90.6250 (92.3546)  time: 0.0813  data: 0.0001  max mem: 21512
Epoch: [1]  [ 4000/10010]  eta: 0:08:14  lr: 0.01  img/s: 399.7549605361132  loss: 0.9610 (0.8899)  acc1: 75.0000 (78.1875)  acc5: 90.6250 (92.3105)  time: 0.0825  data: 0.0001  max mem: 21512
Epoch: [1]  [ 5000/10010]  eta: 0:06:52  lr: 0.01  img/s: 395.03222236611293  loss: 0.7216 (0.8909)  acc1: 81.2500 (78.1762)  acc5: 96.8750 (92.3122)  time: 0.0818  data: 0.0001  max mem: 21512
Epoch: [1]  [ 6000/10010]  eta: 0:05:29  lr: 0.01  img/s: 396.31296912001795  loss: 0.7107 (0.8913)  acc1: 75.0000 (78.1578)  acc5: 93.7500 (92.3049)  time: 0.0826  data: 0.0002  max mem: 21512
Epoch: [1]  [ 7000/10010]  eta: 0:04:07  lr: 0.01  img/s: 397.84718994545887  loss: 0.8416 (0.8906)  acc1: 78.1250 (78.1893)  acc5: 93.7500 (92.3033)  time: 0.0813  data: 0.0001  max mem: 21512
Epoch: [1]  [ 8000/10010]  eta: 0:02:45  lr: 0.01  img/s: 396.53074923186006  loss: 0.9966 (0.8925)  acc1: 75.0000 (78.1758)  acc5: 87.5000 (92.2756)  time: 0.0821  data: 0.0001  max mem: 21512
Epoch: [1]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 394.63847128663963  loss: 1.0148 (0.8937)  acc1: 78.1250 (78.1455)  acc5: 90.6250 (92.2592)  time: 0.0814  data: 0.0001  max mem: 21512
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 400.43119131936885  loss: 0.7569 (0.8926)  acc1: 78.1250 (78.1509)  acc5: 93.7500 (92.2851)  time: 0.0790  data: 0.0001  max mem: 21512
Epoch: [1] Total time: 0:13:42
Test:   [  0/391]  eta: 0:10:03  loss: 0.3962 (0.3962)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5434  data: 1.5057  max mem: 21512
Test:   [100/391]  eta: 0:00:26  loss: 0.6485 (0.6912)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.8849)  time: 0.0536  data: 0.0195  max mem: 21512
Test:   [200/391]  eta: 0:00:15  loss: 1.1877 (0.7922)  acc1: 68.7500 (79.3688)  acc5: 87.5000 (94.8228)  time: 0.0768  data: 0.0431  max mem: 21512
Test:   [300/391]  eta: 0:00:07  loss: 1.2319 (0.9194)  acc1: 68.7500 (76.8065)  acc5: 87.5000 (93.3451)  time: 0.0611  data: 0.0266  max mem: 21512
Test:  Total time: 0:00:28
Test:  Acc@1 76.218 Acc@5 92.932
Number of added parameters: 139272
Epoch: [2]  [    0/10010]  eta: 7:06:38  lr: 0.01  img/s: 56.418301159112644  loss: 0.9400 (0.9400)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 2.5573  data: 1.9901  max mem: 21512
Epoch: [2]  [ 1000/10010]  eta: 0:12:51  lr: 0.01  img/s: 379.7038814077176  loss: 0.8760 (0.8720)  acc1: 75.0000 (78.5152)  acc5: 90.6250 (92.5606)  time: 0.0834  data: 0.0001  max mem: 21512
Epoch: [2]  [ 2000/10010]  eta: 0:11:16  lr: 0.01  img/s: 388.29631601178045  loss: 0.8957 (0.8882)  acc1: 78.1250 (78.0953)  acc5: 90.6250 (92.3913)  time: 0.0831  data: 0.0001  max mem: 21512
Epoch: [2]  [ 3000/10010]  eta: 0:09:48  lr: 0.01  img/s: 384.2686203944675  loss: 0.7482 (0.8812)  acc1: 81.2500 (78.2343)  acc5: 93.7500 (92.4484)  time: 0.0831  data: 0.0001  max mem: 21512
Epoch: [2]  [ 4000/10010]  eta: 0:08:23  lr: 0.01  img/s: 378.92989875833564  loss: 0.9039 (0.8865)  acc1: 75.0000 (78.1289)  acc5: 93.7500 (92.4121)  time: 0.0836  data: 0.0001  max mem: 21512
Epoch: [2]  [ 5000/10010]  eta: 0:06:59  lr: 0.01  img/s: 374.7957409615508  loss: 1.0060 (0.8908)  acc1: 75.0000 (78.0938)  acc5: 90.6250 (92.3365)  time: 0.0830  data: 0.0001  max mem: 21512
Epoch: [2]  [ 6000/10010]  eta: 0:05:35  lr: 0.01  img/s: 387.4958945873223  loss: 0.6880 (0.8880)  acc1: 81.2500 (78.1724)  acc5: 93.7500 (92.3419)  time: 0.0831  data: 0.0001  max mem: 21512
Epoch: [2]  [ 7000/10010]  eta: 0:04:11  lr: 0.01  img/s: 390.02722274528946  loss: 0.8537 (0.8882)  acc1: 78.1250 (78.1705)  acc5: 93.7500 (92.3404)  time: 0.0839  data: 0.0001  max mem: 21512
Epoch: [2]  [ 8000/10010]  eta: 0:02:47  lr: 0.01  img/s: 371.8220697946938  loss: 0.8022 (0.8899)  acc1: 81.2500 (78.1141)  acc5: 93.7500 (92.3260)  time: 0.0837  data: 0.0001  max mem: 21512
Epoch: [2]  [ 9000/10010]  eta: 0:01:24  lr: 0.01  img/s: 388.3873290178455  loss: 0.8008 (0.8909)  acc1: 81.2500 (78.1063)  acc5: 93.7500 (92.3172)  time: 0.0834  data: 0.0001  max mem: 21512
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 376.61831324219366  loss: 0.9463 (0.8917)  acc1: 78.1250 (78.1009)  acc5: 90.6250 (92.2964)  time: 0.0806  data: 0.0001  max mem: 21512
Epoch: [2] Total time: 0:13:55
Test:   [  0/391]  eta: 0:08:45  loss: 0.3934 (0.3934)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3441  data: 1.3005  max mem: 21512
Test:   [100/391]  eta: 0:00:25  loss: 0.6373 (0.6913)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.9158)  time: 0.0574  data: 0.0216  max mem: 21512
Test:   [200/391]  eta: 0:00:14  loss: 1.1829 (0.7912)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.9005)  time: 0.0504  data: 0.0132  max mem: 21512
Test:   [300/391]  eta: 0:00:06  loss: 1.2441 (0.9188)  acc1: 68.7500 (76.8584)  acc5: 87.5000 (93.4282)  time: 0.0608  data: 0.0266  max mem: 21512
Test:  Total time: 0:00:27
Test:  Acc@1 76.256 Acc@5 92.954
Number of added parameters: 139272
Epoch: [3]  [    0/10010]  eta: 5:14:59  lr: 0.01  img/s: 45.54865749320678  loss: 0.9510 (0.9510)  acc1: 75.0000 (75.0000)  acc5: 90.6250 (90.6250)  time: 1.8881  data: 1.1855  max mem: 21512
Epoch: [3]  [ 1000/10010]  eta: 0:12:57  lr: 0.01  img/s: 378.3221514723582  loss: 0.9662 (0.8847)  acc1: 75.0000 (78.1094)  acc5: 93.7500 (92.4482)  time: 0.0839  data: 0.0001  max mem: 21512
Epoch: [3]  [ 2000/10010]  eta: 0:11:23  lr: 0.01  img/s: 385.4350303253078  loss: 0.8726 (0.8922)  acc1: 78.1250 (78.0469)  acc5: 93.7500 (92.3117)  time: 0.0844  data: 0.0001  max mem: 21512
Epoch: [3]  [ 3000/10010]  eta: 0:09:55  lr: 0.01  img/s: 383.138776687001  loss: 0.8455 (0.8966)  acc1: 81.2500 (78.0052)  acc5: 93.7500 (92.2713)  time: 0.0842  data: 0.0001  max mem: 21512
Epoch: [3]  [ 4000/10010]  eta: 0:08:29  lr: 0.01  img/s: 380.84810650988317  loss: 0.8482 (0.8948)  acc1: 78.1250 (77.9993)  acc5: 93.7500 (92.3019)  time: 0.0848  data: 0.0001  max mem: 21512
Epoch: [3]  [ 5000/10010]  eta: 0:07:04  lr: 0.01  img/s: 380.20295963922314  loss: 0.9100 (0.8954)  acc1: 75.0000 (78.0006)  acc5: 90.6250 (92.2815)  time: 0.0838  data: 0.0001  max mem: 21512
Epoch: [3]  [ 6000/10010]  eta: 0:05:39  lr: 0.01  img/s: 383.49346690019917  loss: 1.0135 (0.8955)  acc1: 75.0000 (77.9917)  acc5: 90.6250 (92.2669)  time: 0.0841  data: 0.0001  max mem: 21512
Epoch: [3]  [ 7000/10010]  eta: 0:04:14  lr: 0.01  img/s: 365.12690156477834  loss: 0.8600 (0.8948)  acc1: 78.1250 (78.0304)  acc5: 90.6250 (92.2707)  time: 0.0853  data: 0.0001  max mem: 21512
Epoch: [3]  [ 8000/10010]  eta: 0:02:50  lr: 0.01  img/s: 361.8216147728804  loss: 0.7524 (0.8931)  acc1: 78.1250 (78.0563)  acc5: 93.7500 (92.2853)  time: 0.0841  data: 0.0001  max mem: 21512
Epoch: [3]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 379.9306703956475  loss: 0.9396 (0.8936)  acc1: 78.1250 (78.0486)  acc5: 93.7500 (92.2887)  time: 0.0848  data: 0.0001  max mem: 21512
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 394.6338299417536  loss: 0.8527 (0.8934)  acc1: 81.2500 (78.0519)  acc5: 93.7500 (92.2920)  time: 0.0819  data: 0.0001  max mem: 21512
Epoch: [3] Total time: 0:14:07
Test:   [  0/391]  eta: 0:09:33  loss: 0.4090 (0.4090)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4675  data: 1.4143  max mem: 21512
Test:   [100/391]  eta: 0:00:26  loss: 0.6601 (0.6931)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (96.0087)  time: 0.0613  data: 0.0280  max mem: 21512
Test:   [200/391]  eta: 0:00:16  loss: 1.1906 (0.7915)  acc1: 68.7500 (79.3999)  acc5: 87.5000 (94.9782)  time: 0.0784  data: 0.0404  max mem: 21512
Test:   [300/391]  eta: 0:00:07  loss: 1.2418 (0.9199)  acc1: 68.7500 (76.7961)  acc5: 87.5000 (93.5216)  time: 0.0629  data: 0.0249  max mem: 21512
Test:  Total time: 0:00:28
Test:  Acc@1 76.222 Acc@5 92.976
Number of added parameters: 139272
Epoch: [4]  [    0/10010]  eta: 5:24:50  lr: 0.01  img/s: 97.64818847248787  loss: 0.7868 (0.7868)  acc1: 78.1250 (78.1250)  acc5: 93.7500 (93.7500)  time: 1.9471  data: 1.6193  max mem: 21512
Epoch: [4]  [ 1000/10010]  eta: 0:13:10  lr: 0.01  img/s: 372.5951852180865  loss: 1.0113 (0.8936)  acc1: 75.0000 (78.2343)  acc5: 90.6250 (92.2296)  time: 0.0851  data: 0.0001  max mem: 21512
Epoch: [4]  [ 2000/10010]  eta: 0:11:34  lr: 0.01  img/s: 382.737805051928  loss: 0.7988 (0.8923)  acc1: 78.1250 (78.0969)  acc5: 90.6250 (92.2351)  time: 0.0855  data: 0.0001  max mem: 21512
Epoch: [4]  [ 3000/10010]  eta: 0:10:04  lr: 0.01  img/s: 381.8351497978703  loss: 0.8031 (0.8883)  acc1: 78.1250 (78.1583)  acc5: 93.7500 (92.2963)  time: 0.0851  data: 0.0001  max mem: 21512
Epoch: [4]  [ 4000/10010]  eta: 0:08:37  lr: 0.01  img/s: 381.374038166464  loss: 0.7969 (0.8855)  acc1: 78.1250 (78.1711)  acc5: 96.8750 (92.3332)  time: 0.0855  data: 0.0001  max mem: 21512
Epoch: [4]  [ 5000/10010]  eta: 0:07:11  lr: 0.01  img/s: 379.23718406962126  loss: 0.9905 (0.8850)  acc1: 78.1250 (78.1681)  acc5: 90.6250 (92.3472)  time: 0.0859  data: 0.0001  max mem: 21512
Epoch: [4]  [ 6000/10010]  eta: 0:05:44  lr: 0.01  img/s: 373.5201095365845  loss: 0.8570 (0.8842)  acc1: 78.1250 (78.1802)  acc5: 93.7500 (92.3669)  time: 0.0855  data: 0.0001  max mem: 21512
Epoch: [4]  [ 7000/10010]  eta: 0:04:18  lr: 0.01  img/s: 373.66569411345466  loss: 0.7936 (0.8839)  acc1: 81.2500 (78.1902)  acc5: 90.6250 (92.3752)  time: 0.0863  data: 0.0001  max mem: 21512
Epoch: [4]  [ 8000/10010]  eta: 0:02:52  lr: 0.01  img/s: 375.19596787494373  loss: 0.8381 (0.8861)  acc1: 78.1250 (78.1547)  acc5: 93.7500 (92.3560)  time: 0.0855  data: 0.0001  max mem: 21512
Epoch: [4]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 374.99784306932355  loss: 0.9577 (0.8872)  acc1: 78.1250 (78.1184)  acc5: 90.6250 (92.3384)  time: 0.0857  data: 0.0001  max mem: 21512
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 367.9607414169826  loss: 0.9492 (0.8898)  acc1: 78.1250 (78.0453)  acc5: 90.6250 (92.3126)  time: 0.0837  data: 0.0001  max mem: 21512
Epoch: [4] Total time: 0:14:19
Test:   [  0/391]  eta: 0:09:34  loss: 0.3934 (0.3934)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4689  data: 1.4333  max mem: 21512
Test:   [100/391]  eta: 0:00:24  loss: 0.6425 (0.6903)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (95.9777)  time: 0.0781  data: 0.0402  max mem: 21512
Test:   [200/391]  eta: 0:00:15  loss: 1.2004 (0.7903)  acc1: 68.7500 (79.3843)  acc5: 87.5000 (94.9782)  time: 0.0759  data: 0.0377  max mem: 21512
Test:   [300/391]  eta: 0:00:06  loss: 1.2415 (0.9190)  acc1: 68.7500 (76.7961)  acc5: 87.5000 (93.4904)  time: 0.0589  data: 0.0243  max mem: 21512
Test:  Total time: 0:00:28
Test:  Acc@1 76.216 Acc@5 92.958
Number of added parameters: 139272
Training time 1:12:02
Experiment with model=resnet50, n_components=8, and dof=8 completed
-----------------------------------
Running experiment with n_components=8 and dof=16
[2024-11-14 16:46:25,709] torch.distributed.run: [WARNING] 
[2024-11-14 16:46:25,709] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 16:46:25,709] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 16:46:25,709] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 3): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=8, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.5532760620117188
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 270344
Start training
Epoch: [0]  [    0/10010]  eta: 13:39:42  lr: 0.01  img/s: 10.301887406493169  loss: 0.8462 (0.8462)  acc1: 78.1250 (78.1250)  acc5: 93.7500 (93.7500)  time: 4.9134  data: 1.8071  max mem: 21520
Epoch: [0]  [ 1000/10010]  eta: 0:12:46  lr: 0.01  img/s: 405.5283802157295  loss: 0.7771 (0.9013)  acc1: 78.1250 (78.1562)  acc5: 93.7500 (92.1173)  time: 0.0800  data: 0.0001  max mem: 21520
Epoch: [0]  [ 2000/10010]  eta: 0:11:03  lr: 0.01  img/s: 374.9967953464071  loss: 0.8643 (0.8961)  acc1: 78.1250 (78.1937)  acc5: 90.6250 (92.1711)  time: 0.0813  data: 0.0001  max mem: 21520
Epoch: [0]  [ 3000/10010]  eta: 0:09:34  lr: 0.01  img/s: 400.25803988930244  loss: 0.8471 (0.8969)  acc1: 78.1250 (78.0667)  acc5: 93.7500 (92.1807)  time: 0.0799  data: 0.0001  max mem: 21520
Epoch: [0]  [ 4000/10010]  eta: 0:08:10  lr: 0.01  img/s: 401.67510511903515  loss: 0.9261 (0.8984)  acc1: 78.1250 (78.1234)  acc5: 90.6250 (92.1629)  time: 0.0801  data: 0.0001  max mem: 21520
Epoch: [0]  [ 5000/10010]  eta: 0:06:47  lr: 0.01  img/s: 402.2191894945354  loss: 0.9041 (0.8963)  acc1: 75.0000 (78.1031)  acc5: 90.6250 (92.1997)  time: 0.0808  data: 0.0001  max mem: 21520
Epoch: [0]  [ 6000/10010]  eta: 0:05:25  lr: 0.01  img/s: 383.48579689937543  loss: 0.8690 (0.8955)  acc1: 75.0000 (78.1188)  acc5: 90.6250 (92.2232)  time: 0.0803  data: 0.0002  max mem: 21520
Epoch: [0]  [ 7000/10010]  eta: 0:04:03  lr: 0.01  img/s: 405.1721391893401  loss: 0.8885 (0.8943)  acc1: 78.1250 (78.1246)  acc5: 90.6250 (92.2511)  time: 0.0797  data: 0.0002  max mem: 21520
Epoch: [0]  [ 8000/10010]  eta: 0:02:42  lr: 0.01  img/s: 397.0915201685197  loss: 0.8152 (0.8940)  acc1: 78.1250 (78.0973)  acc5: 93.7500 (92.2517)  time: 0.0801  data: 0.0001  max mem: 21520
Epoch: [0]  [ 9000/10010]  eta: 0:01:21  lr: 0.01  img/s: 394.14246573733374  loss: 0.8953 (0.8926)  acc1: 78.1250 (78.1351)  acc5: 93.7500 (92.2800)  time: 0.0802  data: 0.0001  max mem: 21520
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 420.2933147117676  loss: 0.7933 (0.8936)  acc1: 78.1250 (78.1019)  acc5: 93.7500 (92.2739)  time: 0.0791  data: 0.0001  max mem: 21520
Epoch: [0] Total time: 0:13:29
Test:   [  0/391]  eta: 0:13:00  loss: 0.3900 (0.3900)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.9952  data: 1.8544  max mem: 21520
Test:   [100/391]  eta: 0:00:28  loss: 0.6434 (0.6910)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (96.0396)  time: 0.0596  data: 0.0259  max mem: 21520
Test:   [200/391]  eta: 0:00:16  loss: 1.2094 (0.7919)  acc1: 68.7500 (79.4154)  acc5: 87.5000 (94.9471)  time: 0.0687  data: 0.0343  max mem: 21520
Test:   [300/391]  eta: 0:00:07  loss: 1.2437 (0.9205)  acc1: 68.7500 (76.8480)  acc5: 87.5000 (93.4489)  time: 0.0594  data: 0.0285  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.212 Acc@5 92.968
Number of added parameters: 270344
Epoch: [1]  [    0/10010]  eta: 5:27:53  lr: 0.01  img/s: 135.84240314157321  loss: 0.5220 (0.5220)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.9653  data: 1.7298  max mem: 21520
Epoch: [1]  [ 1000/10010]  eta: 0:12:33  lr: 0.01  img/s: 390.87115478142357  loss: 0.9549 (0.8836)  acc1: 78.1250 (78.3310)  acc5: 90.6250 (92.4326)  time: 0.0826  data: 0.0001  max mem: 21520
Epoch: [1]  [ 2000/10010]  eta: 0:11:03  lr: 0.01  img/s: 393.4965199800639  loss: 0.9065 (0.8900)  acc1: 78.1250 (78.2203)  acc5: 93.7500 (92.4163)  time: 0.0823  data: 0.0001  max mem: 21520
Epoch: [1]  [ 3000/10010]  eta: 0:09:38  lr: 0.01  img/s: 386.86149766530235  loss: 0.9240 (0.8932)  acc1: 78.1250 (78.1437)  acc5: 90.6250 (92.3046)  time: 0.0827  data: 0.0001  max mem: 21520
Epoch: [1]  [ 4000/10010]  eta: 0:08:14  lr: 0.01  img/s: 398.3608458855828  loss: 0.9465 (0.8898)  acc1: 75.0000 (78.1969)  acc5: 90.6250 (92.3222)  time: 0.0813  data: 0.0001  max mem: 21520
Epoch: [1]  [ 5000/10010]  eta: 0:06:51  lr: 0.01  img/s: 395.729889581767  loss: 0.9262 (0.8904)  acc1: 78.1250 (78.1619)  acc5: 93.7500 (92.3115)  time: 0.0811  data: 0.0001  max mem: 21520
Epoch: [1]  [ 6000/10010]  eta: 0:05:29  lr: 0.01  img/s: 403.61499854152447  loss: 0.8354 (0.8906)  acc1: 78.1250 (78.1651)  acc5: 90.6250 (92.3122)  time: 0.0814  data: 0.0001  max mem: 21520
Epoch: [1]  [ 7000/10010]  eta: 0:04:07  lr: 0.01  img/s: 397.1114931135997  loss: 0.8962 (0.8902)  acc1: 78.1250 (78.1866)  acc5: 90.6250 (92.3252)  time: 0.0813  data: 0.0001  max mem: 21520
Epoch: [1]  [ 8000/10010]  eta: 0:02:44  lr: 0.01  img/s: 388.3255254143135  loss: 0.9537 (0.8922)  acc1: 75.0000 (78.1395)  acc5: 93.7500 (92.2978)  time: 0.0815  data: 0.0001  max mem: 21520
Epoch: [1]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 396.72296905851334  loss: 0.9520 (0.8937)  acc1: 71.8750 (78.1201)  acc5: 90.6250 (92.2505)  time: 0.0814  data: 0.0001  max mem: 21520
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 409.5000244081035  loss: 0.8735 (0.8922)  acc1: 78.1250 (78.1284)  acc5: 93.7500 (92.2723)  time: 0.0780  data: 0.0001  max mem: 21520
Epoch: [1] Total time: 0:13:40
Test:   [  0/391]  eta: 0:09:29  loss: 0.4045 (0.4045)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4575  data: 1.4208  max mem: 21520
Test:   [100/391]  eta: 0:00:25  loss: 0.6508 (0.6910)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.9158)  time: 0.0763  data: 0.0423  max mem: 21520
Test:   [200/391]  eta: 0:00:15  loss: 1.1855 (0.7924)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.9005)  time: 0.0718  data: 0.0362  max mem: 21520
Test:   [300/391]  eta: 0:00:06  loss: 1.2383 (0.9200)  acc1: 68.7500 (76.8065)  acc5: 87.5000 (93.3659)  time: 0.0613  data: 0.0254  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.228 Acc@5 92.922
Number of added parameters: 270344
Epoch: [2]  [    0/10010]  eta: 6:52:48  lr: 0.01  img/s: 79.43701157425492  loss: 1.1825 (1.1825)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 2.4744  data: 2.0716  max mem: 21520
Epoch: [2]  [ 1000/10010]  eta: 0:12:53  lr: 0.01  img/s: 378.1452145028554  loss: 0.8101 (0.8609)  acc1: 78.1250 (78.5059)  acc5: 93.7500 (92.7729)  time: 0.0830  data: 0.0001  max mem: 21520
Epoch: [2]  [ 2000/10010]  eta: 0:11:17  lr: 0.01  img/s: 384.17292940395225  loss: 1.0480 (0.8797)  acc1: 78.1250 (78.1141)  acc5: 90.6250 (92.4257)  time: 0.0834  data: 0.0001  max mem: 21520
Epoch: [2]  [ 3000/10010]  eta: 0:09:49  lr: 0.01  img/s: 377.3733224991073  loss: 0.7458 (0.8795)  acc1: 81.2500 (78.2135)  acc5: 90.6250 (92.3755)  time: 0.0828  data: 0.0001  max mem: 21520
Epoch: [2]  [ 4000/10010]  eta: 0:08:24  lr: 0.01  img/s: 385.2093631969876  loss: 0.8581 (0.8804)  acc1: 78.1250 (78.2406)  acc5: 90.6250 (92.3254)  time: 0.0833  data: 0.0001  max mem: 21520
Epoch: [2]  [ 5000/10010]  eta: 0:06:59  lr: 0.01  img/s: 395.13805336308747  loss: 0.8371 (0.8832)  acc1: 81.2500 (78.1781)  acc5: 93.7500 (92.3165)  time: 0.0832  data: 0.0001  max mem: 21520
Epoch: [2]  [ 6000/10010]  eta: 0:05:35  lr: 0.01  img/s: 389.365313931461  loss: 0.8060 (0.8830)  acc1: 78.1250 (78.1953)  acc5: 93.7500 (92.3195)  time: 0.0835  data: 0.0002  max mem: 21520
Epoch: [2]  [ 7000/10010]  eta: 0:04:11  lr: 0.01  img/s: 386.74110785827895  loss: 0.8458 (0.8843)  acc1: 78.1250 (78.1839)  acc5: 93.7500 (92.3056)  time: 0.0831  data: 0.0001  max mem: 21520
Epoch: [2]  [ 8000/10010]  eta: 0:02:47  lr: 0.01  img/s: 394.8671926944508  loss: 0.6756 (0.8858)  acc1: 84.3750 (78.1293)  acc5: 96.8750 (92.3060)  time: 0.0827  data: 0.0001  max mem: 21520
Epoch: [2]  [ 9000/10010]  eta: 0:01:24  lr: 0.01  img/s: 386.1580564602442  loss: 0.6885 (0.8870)  acc1: 78.1250 (78.1368)  acc5: 93.7500 (92.2904)  time: 0.0826  data: 0.0002  max mem: 21520
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 409.5237641918466  loss: 0.7836 (0.8878)  acc1: 78.1250 (78.1381)  acc5: 93.7500 (92.2811)  time: 0.0827  data: 0.0001  max mem: 21520
Epoch: [2] Total time: 0:13:56
Test:   [  0/391]  eta: 0:11:36  loss: 0.4078 (0.4078)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7822  data: 1.7391  max mem: 21520
Test:   [100/391]  eta: 0:00:26  loss: 0.6344 (0.6915)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.9468)  time: 0.0848  data: 0.0420  max mem: 21520
Test:   [200/391]  eta: 0:00:15  loss: 1.1984 (0.7914)  acc1: 68.7500 (79.4776)  acc5: 87.5000 (94.9627)  time: 0.0792  data: 0.0416  max mem: 21520
Test:   [300/391]  eta: 0:00:07  loss: 1.2262 (0.9185)  acc1: 68.7500 (76.8895)  acc5: 87.5000 (93.4801)  time: 0.0487  data: 0.0177  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.268 Acc@5 92.966
Number of added parameters: 270344
Epoch: [3]  [    0/10010]  eta: 5:58:07  lr: 0.01  img/s: 109.06246942672571  loss: 0.6979 (0.6979)  acc1: 81.2500 (81.2500)  acc5: 96.8750 (96.8750)  time: 2.1466  data: 1.8531  max mem: 21520
Epoch: [3]  [ 1000/10010]  eta: 0:13:00  lr: 0.01  img/s: 379.17504442429225  loss: 0.9593 (0.8874)  acc1: 71.8750 (78.3748)  acc5: 93.7500 (92.3358)  time: 0.0847  data: 0.0002  max mem: 21520
Epoch: [3]  [ 2000/10010]  eta: 0:11:26  lr: 0.01  img/s: 377.4879498249216  loss: 0.8197 (0.8879)  acc1: 78.1250 (78.2156)  acc5: 93.7500 (92.3132)  time: 0.0849  data: 0.0001  max mem: 21520
Epoch: [3]  [ 3000/10010]  eta: 0:09:57  lr: 0.01  img/s: 385.0524371001521  loss: 0.8363 (0.8973)  acc1: 81.2500 (78.0261)  acc5: 93.7500 (92.1557)  time: 0.0846  data: 0.0001  max mem: 21520
Epoch: [3]  [ 4000/10010]  eta: 0:08:31  lr: 0.01  img/s: 379.92744400914876  loss: 0.7187 (0.8969)  acc1: 78.1250 (77.9993)  acc5: 93.7500 (92.1871)  time: 0.0843  data: 0.0001  max mem: 21520
Epoch: [3]  [ 5000/10010]  eta: 0:07:05  lr: 0.01  img/s: 383.97509927105864  loss: 0.7689 (0.8990)  acc1: 81.2500 (77.9325)  acc5: 93.7500 (92.1666)  time: 0.0848  data: 0.0001  max mem: 21520
Epoch: [3]  [ 6000/10010]  eta: 0:05:40  lr: 0.01  img/s: 379.40978193886144  loss: 0.7903 (0.8955)  acc1: 78.1250 (78.0005)  acc5: 93.7500 (92.2070)  time: 0.0840  data: 0.0001  max mem: 21520
Epoch: [3]  [ 7000/10010]  eta: 0:04:15  lr: 0.01  img/s: 382.18525278699263  loss: 1.0039 (0.8964)  acc1: 78.1250 (78.0076)  acc5: 90.6250 (92.1815)  time: 0.0845  data: 0.0001  max mem: 21520
Epoch: [3]  [ 8000/10010]  eta: 0:02:50  lr: 0.01  img/s: 387.2789829354293  loss: 0.8427 (0.8948)  acc1: 78.1250 (78.0246)  acc5: 93.7500 (92.2228)  time: 0.0846  data: 0.0001  max mem: 21520
Epoch: [3]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 382.6526930401761  loss: 0.8247 (0.8927)  acc1: 75.0000 (78.0521)  acc5: 90.6250 (92.2634)  time: 0.0849  data: 0.0001  max mem: 21520
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 371.8303104179075  loss: 0.7614 (0.8923)  acc1: 78.1250 (78.0656)  acc5: 90.6250 (92.2876)  time: 0.0831  data: 0.0001  max mem: 21520
Epoch: [3] Total time: 0:14:08
Test:   [  0/391]  eta: 0:12:04  loss: 0.3959 (0.3959)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.8521  data: 1.7931  max mem: 21520
Test:   [100/391]  eta: 0:00:25  loss: 0.6448 (0.6925)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (95.8849)  time: 0.0665  data: 0.0299  max mem: 21520
Test:   [200/391]  eta: 0:00:15  loss: 1.1859 (0.7917)  acc1: 68.7500 (79.4465)  acc5: 87.5000 (94.9005)  time: 0.0614  data: 0.0219  max mem: 21520
Test:   [300/391]  eta: 0:00:06  loss: 1.2187 (0.9198)  acc1: 68.7500 (76.8584)  acc5: 87.5000 (93.4282)  time: 0.0664  data: 0.0240  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.254 Acc@5 92.972
Number of added parameters: 270344
Epoch: [4]  [    0/10010]  eta: 5:36:27  lr: 0.01  img/s: 159.3856837835206  loss: 0.9294 (0.9294)  acc1: 78.1250 (78.1250)  acc5: 90.6250 (90.6250)  time: 2.0167  data: 1.8160  max mem: 21520
Epoch: [4]  [ 1000/10010]  eta: 0:13:12  lr: 0.01  img/s: 375.5812849787329  loss: 0.7915 (0.8986)  acc1: 78.1250 (78.0157)  acc5: 93.7500 (92.3233)  time: 0.0861  data: 0.0001  max mem: 21520
Epoch: [4]  [ 2000/10010]  eta: 0:11:37  lr: 0.01  img/s: 374.1730056731855  loss: 0.7934 (0.8884)  acc1: 78.1250 (78.1750)  acc5: 93.7500 (92.4303)  time: 0.0857  data: 0.0002  max mem: 21520
Epoch: [4]  [ 3000/10010]  eta: 0:10:07  lr: 0.01  img/s: 379.94357648963785  loss: 0.8397 (0.8881)  acc1: 78.1250 (78.1708)  acc5: 93.7500 (92.3932)  time: 0.0857  data: 0.0001  max mem: 21520
Epoch: [4]  [ 4000/10010]  eta: 0:08:39  lr: 0.01  img/s: 374.84493746892997  loss: 0.7135 (0.8862)  acc1: 78.1250 (78.2101)  acc5: 93.7500 (92.4136)  time: 0.0855  data: 0.0001  max mem: 21520
Epoch: [4]  [ 5000/10010]  eta: 0:07:12  lr: 0.01  img/s: 376.36485182941874  loss: 0.8979 (0.8866)  acc1: 78.1250 (78.2156)  acc5: 93.7500 (92.4009)  time: 0.0854  data: 0.0001  max mem: 21520
Epoch: [4]  [ 6000/10010]  eta: 0:05:46  lr: 0.01  img/s: 374.68274258340614  loss: 0.9345 (0.8882)  acc1: 75.0000 (78.1734)  acc5: 93.7500 (92.3752)  time: 0.0859  data: 0.0001  max mem: 21520
Epoch: [4]  [ 7000/10010]  eta: 0:04:19  lr: 0.01  img/s: 375.9115856220207  loss: 0.9337 (0.8888)  acc1: 81.2500 (78.1995)  acc5: 90.6250 (92.3431)  time: 0.0856  data: 0.0002  max mem: 21520
Epoch: [4]  [ 8000/10010]  eta: 0:02:53  lr: 0.01  img/s: 379.48380055699283  loss: 0.6988 (0.8876)  acc1: 84.3750 (78.2062)  acc5: 93.7500 (92.3549)  time: 0.0856  data: 0.0002  max mem: 21520
Epoch: [4]  [ 9000/10010]  eta: 0:01:27  lr: 0.01  img/s: 376.5263940437016  loss: 0.9301 (0.8870)  acc1: 75.0000 (78.2347)  acc5: 90.6250 (92.3616)  time: 0.0861  data: 0.0001  max mem: 21520
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 391.29506222868787  loss: 0.9146 (0.8901)  acc1: 78.1250 (78.1734)  acc5: 90.6250 (92.3301)  time: 0.0858  data: 0.0001  max mem: 21520
Epoch: [4] Total time: 0:14:22
Test:   [  0/391]  eta: 0:13:25  loss: 0.3992 (0.3992)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 2.0607  data: 2.0179  max mem: 21520
Test:   [100/391]  eta: 0:00:27  loss: 0.6479 (0.6913)  acc1: 81.2500 (81.8069)  acc5: 96.8750 (95.8849)  time: 0.0776  data: 0.0372  max mem: 21520
Test:   [200/391]  eta: 0:00:15  loss: 1.1921 (0.7908)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.8539)  time: 0.0629  data: 0.0224  max mem: 21520
Test:   [300/391]  eta: 0:00:06  loss: 1.2195 (0.9190)  acc1: 68.7500 (76.8169)  acc5: 87.5000 (93.3762)  time: 0.0595  data: 0.0191  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.244 Acc@5 92.950
Number of added parameters: 270344
Training time 1:12:02
Experiment with model=resnet50, n_components=8, and dof=16 completed
-----------------------------------
Running experiment with n_components=8 and dof=32
[2024-11-14 17:58:44,878] torch.distributed.run: [WARNING] 
[2024-11-14 17:58:44,878] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 17:58:44,878] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 17:58:44,878] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=8, dof=32, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.6879990100860596
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 532488
Start training
Epoch: [0]  [    0/10010]  eta: 13:47:00  lr: 0.01  img/s: 10.98067893029589  loss: 0.9644 (0.9644)  acc1: 75.0000 (75.0000)  acc5: 96.8750 (96.8750)  time: 4.9571  data: 2.0428  max mem: 21522
Epoch: [0]  [ 1000/10010]  eta: 0:12:48  lr: 0.01  img/s: 396.97759531971406  loss: 0.9253 (0.8972)  acc1: 78.1250 (78.2030)  acc5: 93.7500 (92.1048)  time: 0.0804  data: 0.0001  max mem: 21522
Epoch: [0]  [ 2000/10010]  eta: 0:11:04  lr: 0.01  img/s: 390.0680291088326  loss: 0.7898 (0.8958)  acc1: 78.1250 (78.1578)  acc5: 93.7500 (92.1742)  time: 0.0811  data: 0.0001  max mem: 21522
Epoch: [0]  [ 3000/10010]  eta: 0:09:35  lr: 0.01  img/s: 400.9455568732767  loss: 0.8689 (0.8925)  acc1: 75.0000 (78.1281)  acc5: 93.7500 (92.2068)  time: 0.0802  data: 0.0001  max mem: 21522
Epoch: [0]  [ 4000/10010]  eta: 0:08:11  lr: 0.01  img/s: 399.6073765757397  loss: 0.7755 (0.8899)  acc1: 75.0000 (78.1726)  acc5: 93.7500 (92.2410)  time: 0.0802  data: 0.0001  max mem: 21522
Epoch: [0]  [ 5000/10010]  eta: 0:06:48  lr: 0.01  img/s: 400.36430128952776  loss: 0.8484 (0.8894)  acc1: 78.1250 (78.1756)  acc5: 90.6250 (92.2690)  time: 0.0808  data: 0.0001  max mem: 21522
Epoch: [0]  [ 6000/10010]  eta: 0:05:26  lr: 0.01  img/s: 397.9533548788804  loss: 0.8802 (0.8909)  acc1: 75.0000 (78.1661)  acc5: 93.7500 (92.2664)  time: 0.0798  data: 0.0001  max mem: 21522
Epoch: [0]  [ 7000/10010]  eta: 0:04:04  lr: 0.01  img/s: 398.51934285654903  loss: 0.8528 (0.8903)  acc1: 78.1250 (78.1705)  acc5: 90.6250 (92.2614)  time: 0.0808  data: 0.0001  max mem: 21522
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 403.91987673343607  loss: 0.9536 (0.8887)  acc1: 75.0000 (78.2105)  acc5: 90.6250 (92.2877)  time: 0.0802  data: 0.0001  max mem: 21522
Epoch: [0]  [ 9000/10010]  eta: 0:01:21  lr: 0.01  img/s: 395.9014801573958  loss: 0.9597 (0.8897)  acc1: 78.1250 (78.1906)  acc5: 90.6250 (92.2800)  time: 0.0800  data: 0.0001  max mem: 21522
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 405.5810737715569  loss: 0.8127 (0.8875)  acc1: 81.2500 (78.2362)  acc5: 93.7500 (92.3236)  time: 0.0787  data: 0.0001  max mem: 21522
Epoch: [0] Total time: 0:13:31
Test:   [  0/391]  eta: 0:09:43  loss: 0.3952 (0.3952)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4916  data: 1.3727  max mem: 21522
Test:   [100/391]  eta: 0:00:25  loss: 0.6516 (0.6909)  acc1: 81.2500 (81.8069)  acc5: 96.8750 (95.9158)  time: 0.0820  data: 0.0472  max mem: 21522
Test:   [200/391]  eta: 0:00:15  loss: 1.2036 (0.7920)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.8850)  time: 0.0584  data: 0.0240  max mem: 21522
Test:   [300/391]  eta: 0:00:06  loss: 1.2492 (0.9203)  acc1: 68.7500 (76.8584)  acc5: 87.5000 (93.3970)  time: 0.0562  data: 0.0289  max mem: 21522
Test:  Total time: 0:00:28
Test:  Acc@1 76.206 Acc@5 92.964
Number of added parameters: 532488
Epoch: [1]  [    0/10010]  eta: 5:04:33  lr: 0.01  img/s: 174.3123597373452  loss: 0.5087 (0.5087)  acc1: 84.3750 (84.3750)  acc5: 93.7500 (93.7500)  time: 1.8255  data: 1.6419  max mem: 21522
Epoch: [1]  [ 1000/10010]  eta: 0:12:37  lr: 0.01  img/s: 389.53821149537373  loss: 0.8411 (0.8928)  acc1: 75.0000 (78.2592)  acc5: 93.7500 (92.2328)  time: 0.0829  data: 0.0001  max mem: 21522
Epoch: [1]  [ 2000/10010]  eta: 0:11:07  lr: 0.01  img/s: 390.86546335610655  loss: 0.8400 (0.8857)  acc1: 78.1250 (78.3358)  acc5: 90.6250 (92.3523)  time: 0.0823  data: 0.0001  max mem: 21522
Epoch: [1]  [ 3000/10010]  eta: 0:09:43  lr: 0.01  img/s: 390.5095097745411  loss: 0.9909 (0.8930)  acc1: 75.0000 (78.1667)  acc5: 90.6250 (92.2578)  time: 0.0837  data: 0.0001  max mem: 21522
Epoch: [1]  [ 4000/10010]  eta: 0:08:18  lr: 0.01  img/s: 395.79057128449807  loss: 0.8009 (0.8909)  acc1: 78.1250 (78.2492)  acc5: 90.6250 (92.2707)  time: 0.0822  data: 0.0001  max mem: 21522
Epoch: [1]  [ 5000/10010]  eta: 0:06:54  lr: 0.01  img/s: 396.18545642388017  loss: 0.8569 (0.8922)  acc1: 81.2500 (78.2156)  acc5: 90.6250 (92.2934)  time: 0.0815  data: 0.0002  max mem: 21522
Epoch: [1]  [ 6000/10010]  eta: 0:05:31  lr: 0.01  img/s: 391.56903920716286  loss: 0.8382 (0.8908)  acc1: 75.0000 (78.2260)  acc5: 93.7500 (92.3372)  time: 0.0822  data: 0.0001  max mem: 21522
Epoch: [1]  [ 7000/10010]  eta: 0:04:08  lr: 0.01  img/s: 391.06590134320095  loss: 0.8693 (0.8904)  acc1: 78.1250 (78.2286)  acc5: 90.6250 (92.3355)  time: 0.0819  data: 0.0001  max mem: 21522
Epoch: [1]  [ 8000/10010]  eta: 0:02:46  lr: 0.01  img/s: 393.9828044230617  loss: 1.0688 (0.8905)  acc1: 78.1250 (78.2539)  acc5: 87.5000 (92.3221)  time: 0.0826  data: 0.0001  max mem: 21522
Epoch: [1]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 393.84522929211124  loss: 0.8624 (0.8901)  acc1: 75.0000 (78.2726)  acc5: 93.7500 (92.3144)  time: 0.0818  data: 0.0001  max mem: 21522
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 404.42740703466103  loss: 0.7353 (0.8898)  acc1: 81.2500 (78.2765)  acc5: 93.7500 (92.3401)  time: 0.0800  data: 0.0001  max mem: 21522
Epoch: [1] Total time: 0:13:46
Test:   [  0/391]  eta: 0:09:53  loss: 0.3990 (0.3990)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5181  data: 1.4783  max mem: 21522
Test:   [100/391]  eta: 0:00:26  loss: 0.6411 (0.6908)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (95.9158)  time: 0.0781  data: 0.0430  max mem: 21522
Test:   [200/391]  eta: 0:00:15  loss: 1.1856 (0.7927)  acc1: 68.7500 (79.2910)  acc5: 87.5000 (94.9160)  time: 0.0627  data: 0.0274  max mem: 21522
Test:   [300/391]  eta: 0:00:06  loss: 1.2316 (0.9201)  acc1: 68.7500 (76.7753)  acc5: 87.5000 (93.4178)  time: 0.0541  data: 0.0185  max mem: 21522
Test:  Total time: 0:00:28
Test:  Acc@1 76.186 Acc@5 92.962
Number of added parameters: 532488
Epoch: [2]  [    0/10010]  eta: 6:38:20  lr: 0.01  img/s: 53.362625094376156  loss: 1.2741 (1.2741)  acc1: 71.8750 (71.8750)  acc5: 90.6250 (90.6250)  time: 2.3877  data: 1.7880  max mem: 21522
Epoch: [2]  [ 1000/10010]  eta: 0:13:00  lr: 0.01  img/s: 365.5216656000218  loss: 0.9322 (0.8731)  acc1: 75.0000 (78.4528)  acc5: 90.6250 (92.3202)  time: 0.0847  data: 0.0002  max mem: 21522
Epoch: [2]  [ 2000/10010]  eta: 0:11:24  lr: 0.01  img/s: 376.75045964783254  loss: 0.8124 (0.8826)  acc1: 75.0000 (78.1453)  acc5: 93.7500 (92.2898)  time: 0.0841  data: 0.0001  max mem: 21522
Epoch: [2]  [ 3000/10010]  eta: 0:09:55  lr: 0.01  img/s: 376.03796865456707  loss: 0.8091 (0.8836)  acc1: 78.1250 (78.1177)  acc5: 93.7500 (92.3661)  time: 0.0836  data: 0.0001  max mem: 21522
Epoch: [2]  [ 4000/10010]  eta: 0:08:29  lr: 0.01  img/s: 377.67808743415424  loss: 0.7945 (0.8834)  acc1: 81.2500 (78.1633)  acc5: 93.7500 (92.3628)  time: 0.0841  data: 0.0001  max mem: 21522
Epoch: [2]  [ 5000/10010]  eta: 0:07:03  lr: 0.01  img/s: 377.3086100459907  loss: 0.8928 (0.8865)  acc1: 78.1250 (78.1088)  acc5: 90.6250 (92.3240)  time: 0.0842  data: 0.0001  max mem: 21522
Epoch: [2]  [ 6000/10010]  eta: 0:05:38  lr: 0.01  img/s: 387.8217180371069  loss: 0.8095 (0.8859)  acc1: 78.1250 (78.1505)  acc5: 93.7500 (92.3383)  time: 0.0840  data: 0.0001  max mem: 21522
Epoch: [2]  [ 7000/10010]  eta: 0:04:14  lr: 0.01  img/s: 372.8891704172918  loss: 0.7943 (0.8882)  acc1: 78.1250 (78.1040)  acc5: 93.7500 (92.3248)  time: 0.0841  data: 0.0001  max mem: 21522
Epoch: [2]  [ 8000/10010]  eta: 0:02:49  lr: 0.01  img/s: 375.4720139650426  loss: 0.7213 (0.8899)  acc1: 78.1250 (78.0524)  acc5: 93.7500 (92.3041)  time: 0.0837  data: 0.0001  max mem: 21522
Epoch: [2]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 383.2109751745207  loss: 0.8252 (0.8903)  acc1: 75.0000 (78.0563)  acc5: 90.6250 (92.2904)  time: 0.0842  data: 0.0001  max mem: 21522
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 402.29634714008677  loss: 0.8249 (0.8919)  acc1: 75.0000 (78.0397)  acc5: 90.6250 (92.2551)  time: 0.0818  data: 0.0001  max mem: 21522
Epoch: [2] Total time: 0:14:04
Test:   [  0/391]  eta: 0:11:12  loss: 0.3968 (0.3968)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7204  data: 1.6659  max mem: 21522
Test:   [100/391]  eta: 0:00:25  loss: 0.6354 (0.6908)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (95.8849)  time: 0.0714  data: 0.0374  max mem: 21522
Test:   [200/391]  eta: 0:00:14  loss: 1.1779 (0.7907)  acc1: 68.7500 (79.3843)  acc5: 87.5000 (94.9471)  time: 0.0542  data: 0.0197  max mem: 21522
Test:   [300/391]  eta: 0:00:06  loss: 1.2298 (0.9190)  acc1: 68.7500 (76.8376)  acc5: 87.5000 (93.4282)  time: 0.0823  data: 0.0433  max mem: 21522
Test:  Total time: 0:00:28
Test:  Acc@1 76.252 Acc@5 92.954
Number of added parameters: 532488
Epoch: [3]  [    0/10010]  eta: 6:04:41  lr: 0.01  img/s: 31.55623591824394  loss: 0.5893 (0.5893)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 2.1859  data: 1.1718  max mem: 21522
Epoch: [3]  [ 1000/10010]  eta: 0:13:12  lr: 0.01  img/s: 372.6976133287053  loss: 0.7796 (0.8913)  acc1: 78.1250 (78.2436)  acc5: 93.7500 (92.4544)  time: 0.0864  data: 0.0001  max mem: 21522
Epoch: [3]  [ 2000/10010]  eta: 0:11:36  lr: 0.01  img/s: 376.1960670000224  loss: 0.8504 (0.8905)  acc1: 75.0000 (78.0719)  acc5: 93.7500 (92.4522)  time: 0.0862  data: 0.0001  max mem: 21522
Epoch: [3]  [ 3000/10010]  eta: 0:10:06  lr: 0.01  img/s: 377.06269314184897  loss: 0.9881 (0.8924)  acc1: 75.0000 (78.0709)  acc5: 90.6250 (92.3890)  time: 0.0858  data: 0.0001  max mem: 21522
Epoch: [3]  [ 4000/10010]  eta: 0:08:39  lr: 0.01  img/s: 377.7514318603349  loss: 0.8900 (0.8918)  acc1: 75.0000 (78.0469)  acc5: 93.7500 (92.3379)  time: 0.0856  data: 0.0001  max mem: 21522
Epoch: [3]  [ 5000/10010]  eta: 0:07:12  lr: 0.01  img/s: 377.5166175378592  loss: 0.8096 (0.8925)  acc1: 78.1250 (78.0613)  acc5: 93.7500 (92.3434)  time: 0.0858  data: 0.0001  max mem: 21522
Epoch: [3]  [ 6000/10010]  eta: 0:05:45  lr: 0.01  img/s: 381.30469664428006  loss: 0.8632 (0.8927)  acc1: 78.1250 (78.0563)  acc5: 90.6250 (92.3294)  time: 0.0853  data: 0.0001  max mem: 21522
Epoch: [3]  [ 7000/10010]  eta: 0:04:19  lr: 0.01  img/s: 374.59281111238255  loss: 0.8685 (0.8943)  acc1: 78.1250 (78.0411)  acc5: 90.6250 (92.2899)  time: 0.0860  data: 0.0001  max mem: 21522
Epoch: [3]  [ 8000/10010]  eta: 0:02:53  lr: 0.01  img/s: 379.0144328383076  loss: 0.6785 (0.8925)  acc1: 78.1250 (78.0832)  acc5: 93.7500 (92.3056)  time: 0.0855  data: 0.0001  max mem: 21522
Epoch: [3]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 374.5583139846401  loss: 0.7797 (0.8929)  acc1: 78.1250 (78.0389)  acc5: 90.6250 (92.3092)  time: 0.0859  data: 0.0001  max mem: 21522
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 366.5158233637995  loss: 0.7478 (0.8936)  acc1: 81.2500 (78.0022)  acc5: 93.7500 (92.3173)  time: 0.0847  data: 0.0001  max mem: 21522
Epoch: [3] Total time: 0:14:21
Test:   [  0/391]  eta: 0:09:33  loss: 0.4011 (0.4011)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4666  data: 1.4281  max mem: 21522
Test:   [100/391]  eta: 0:00:25  loss: 0.6505 (0.6914)  acc1: 81.2500 (81.8069)  acc5: 96.8750 (95.9468)  time: 0.0677  data: 0.0307  max mem: 21522
Test:   [200/391]  eta: 0:00:15  loss: 1.1726 (0.7906)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.9627)  time: 0.0659  data: 0.0330  max mem: 21522
Test:   [300/391]  eta: 0:00:06  loss: 1.2219 (0.9193)  acc1: 68.7500 (76.8376)  acc5: 87.5000 (93.4593)  time: 0.0556  data: 0.0172  max mem: 21522
Test:  Total time: 0:00:28
Test:  Acc@1 76.272 Acc@5 92.968
Number of added parameters: 532488
Epoch: [4]  [    0/10010]  eta: 5:40:14  lr: 0.01  img/s: 92.61095838991378  loss: 0.5906 (0.5906)  acc1: 78.1250 (78.1250)  acc5: 100.0000 (100.0000)  time: 2.0394  data: 1.6938  max mem: 21522
Epoch: [4]  [ 1000/10010]  eta: 0:13:28  lr: 0.01  img/s: 362.726107695426  loss: 0.9436 (0.8877)  acc1: 78.1250 (78.3404)  acc5: 90.6250 (92.2890)  time: 0.0877  data: 0.0001  max mem: 21522
Epoch: [4]  [ 2000/10010]  eta: 0:11:51  lr: 0.01  img/s: 368.4415443951851  loss: 0.8480 (0.8901)  acc1: 75.0000 (78.2780)  acc5: 93.7500 (92.3445)  time: 0.0878  data: 0.0001  max mem: 21522
Epoch: [4]  [ 3000/10010]  eta: 0:10:20  lr: 0.01  img/s: 361.7114290565214  loss: 0.8730 (0.8890)  acc1: 81.2500 (78.2354)  acc5: 90.6250 (92.3046)  time: 0.0880  data: 0.0001  max mem: 21522
Epoch: [4]  [ 4000/10010]  eta: 0:08:50  lr: 0.01  img/s: 370.7682286415156  loss: 0.8461 (0.8831)  acc1: 78.1250 (78.3367)  acc5: 93.7500 (92.4058)  time: 0.0872  data: 0.0001  max mem: 21522
Epoch: [4]  [ 5000/10010]  eta: 0:07:21  lr: 0.01  img/s: 373.3902191360858  loss: 0.8040 (0.8863)  acc1: 78.1250 (78.2319)  acc5: 93.7500 (92.3553)  time: 0.0874  data: 0.0001  max mem: 21522
Epoch: [4]  [ 6000/10010]  eta: 0:05:53  lr: 0.01  img/s: 368.6621638324814  loss: 0.7225 (0.8897)  acc1: 75.0000 (78.1870)  acc5: 96.8750 (92.3049)  time: 0.0876  data: 0.0001  max mem: 21522
Epoch: [4]  [ 7000/10010]  eta: 0:04:24  lr: 0.01  img/s: 363.2051134257192  loss: 0.9252 (0.8875)  acc1: 75.0000 (78.2312)  acc5: 90.6250 (92.3261)  time: 0.0872  data: 0.0001  max mem: 21522
Epoch: [4]  [ 8000/10010]  eta: 0:02:56  lr: 0.01  img/s: 370.8409628434385  loss: 0.8230 (0.8875)  acc1: 78.1250 (78.2043)  acc5: 90.6250 (92.3240)  time: 0.0870  data: 0.0001  max mem: 21522
Epoch: [4]  [ 9000/10010]  eta: 0:01:28  lr: 0.01  img/s: 368.4587391700616  loss: 0.9052 (0.8864)  acc1: 75.0000 (78.2187)  acc5: 93.7500 (92.3276)  time: 0.0872  data: 0.0001  max mem: 21522
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 375.9147441624678  loss: 0.8350 (0.8880)  acc1: 78.1250 (78.1737)  acc5: 90.6250 (92.3080)  time: 0.0859  data: 0.0001  max mem: 21522
Epoch: [4] Total time: 0:14:39
Test:   [  0/391]  eta: 0:11:33  loss: 0.3979 (0.3979)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7745  data: 1.7229  max mem: 21522
Test:   [100/391]  eta: 0:00:23  loss: 0.6468 (0.6911)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.9777)  time: 0.0616  data: 0.0212  max mem: 21522
Test:   [200/391]  eta: 0:00:15  loss: 1.2083 (0.7920)  acc1: 68.7500 (79.4154)  acc5: 87.5000 (94.9005)  time: 0.0741  data: 0.0342  max mem: 21522
Test:   [300/391]  eta: 0:00:06  loss: 1.2150 (0.9194)  acc1: 68.7500 (76.8895)  acc5: 87.5000 (93.4385)  time: 0.0631  data: 0.0193  max mem: 21522
Test:  Total time: 0:00:27
Test:  Acc@1 76.276 Acc@5 92.952
Number of added parameters: 532488
Training time 1:12:48
Experiment with model=resnet50, n_components=8, and dof=32 completed
-----------------------------------
Running experiment with n_components=16 and dof=4
[2024-11-14 19:11:49,005] torch.distributed.run: [WARNING] 
[2024-11-14 19:11:49,005] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 19:11:49,005] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 19:11:49,005] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 1): env://
| distributed init (rank 2): env://
| distributed init (rank 3): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=16, dof=4, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.5474021434783936
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 147472
Start training
Epoch: [0]  [    0/10010]  eta: 14:04:11  lr: 0.01  img/s: 12.10688844182105  loss: 0.7351 (0.7351)  acc1: 75.0000 (75.0000)  acc5: 93.7500 (93.7500)  time: 5.0601  data: 2.4170  max mem: 21515
Epoch: [0]  [ 1000/10010]  eta: 0:12:51  lr: 0.01  img/s: 402.87839302169914  loss: 0.8633 (0.9132)  acc1: 78.1250 (77.7629)  acc5: 90.6250 (91.9768)  time: 0.0809  data: 0.0001  max mem: 21515
Epoch: [0]  [ 2000/10010]  eta: 0:11:07  lr: 0.01  img/s: 391.0784355432271  loss: 0.7716 (0.8999)  acc1: 78.1250 (78.0938)  acc5: 93.7500 (92.1086)  time: 0.0818  data: 0.0001  max mem: 21515
Epoch: [0]  [ 3000/10010]  eta: 0:09:37  lr: 0.01  img/s: 396.85434826317845  loss: 0.9086 (0.8938)  acc1: 78.1250 (78.1000)  acc5: 93.7500 (92.2130)  time: 0.0810  data: 0.0001  max mem: 21515
Epoch: [0]  [ 4000/10010]  eta: 0:08:12  lr: 0.01  img/s: 401.04619190902054  loss: 0.9693 (0.8943)  acc1: 75.0000 (78.0414)  acc5: 90.6250 (92.1965)  time: 0.0808  data: 0.0001  max mem: 21515
Epoch: [0]  [ 5000/10010]  eta: 0:06:49  lr: 0.01  img/s: 404.8812454939532  loss: 0.9649 (0.8952)  acc1: 75.0000 (78.0019)  acc5: 90.6250 (92.1934)  time: 0.0816  data: 0.0002  max mem: 21515
Epoch: [0]  [ 6000/10010]  eta: 0:05:27  lr: 0.01  img/s: 396.12933006318934  loss: 0.9525 (0.8958)  acc1: 78.1250 (77.9427)  acc5: 93.7500 (92.1987)  time: 0.0813  data: 0.0001  max mem: 21515
Epoch: [0]  [ 7000/10010]  eta: 0:04:05  lr: 0.01  img/s: 399.93363528009536  loss: 0.7827 (0.8950)  acc1: 81.2500 (77.9558)  acc5: 93.7500 (92.2292)  time: 0.0809  data: 0.0001  max mem: 21515
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 400.0289938006676  loss: 0.9375 (0.8941)  acc1: 75.0000 (77.9903)  acc5: 90.6250 (92.2541)  time: 0.0806  data: 0.0002  max mem: 21515
Epoch: [0]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 402.15049588014983  loss: 0.8517 (0.8947)  acc1: 78.1250 (77.9969)  acc5: 93.7500 (92.2422)  time: 0.0806  data: 0.0001  max mem: 21515
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 395.6330707918691  loss: 0.7167 (0.8943)  acc1: 81.2500 (78.0013)  acc5: 93.7500 (92.2611)  time: 0.0799  data: 0.0001  max mem: 21515
Epoch: [0] Total time: 0:13:35
Test:   [  0/391]  eta: 0:10:14  loss: 0.3928 (0.3928)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5717  data: 1.4849  max mem: 21515
Test:   [100/391]  eta: 0:00:27  loss: 0.6389 (0.6906)  acc1: 81.2500 (81.7450)  acc5: 96.8750 (95.9468)  time: 0.0558  data: 0.0199  max mem: 21515
Test:   [200/391]  eta: 0:00:15  loss: 1.2183 (0.7915)  acc1: 68.7500 (79.2600)  acc5: 87.5000 (94.9160)  time: 0.0503  data: 0.0166  max mem: 21515
Test:   [300/391]  eta: 0:00:07  loss: 1.2523 (0.9201)  acc1: 71.8750 (76.7857)  acc5: 87.5000 (93.4178)  time: 0.0865  data: 0.0503  max mem: 21515
Test:  Total time: 0:00:28
Test:  Acc@1 76.182 Acc@5 92.958
Number of added parameters: 147472
Epoch: [1]  [    0/10010]  eta: 4:56:29  lr: 0.01  img/s: 149.5343855806393  loss: 0.9482 (0.9482)  acc1: 75.0000 (75.0000)  acc5: 87.5000 (87.5000)  time: 1.7772  data: 1.5632  max mem: 21515
Epoch: [1]  [ 1000/10010]  eta: 0:12:36  lr: 0.01  img/s: 377.965249812732  loss: 0.7490 (0.8766)  acc1: 78.1250 (78.4653)  acc5: 93.7500 (92.4076)  time: 0.0826  data: 0.0001  max mem: 21515
Epoch: [1]  [ 2000/10010]  eta: 0:11:05  lr: 0.01  img/s: 390.79035207248756  loss: 0.9288 (0.8788)  acc1: 78.1250 (78.3296)  acc5: 90.6250 (92.4866)  time: 0.0819  data: 0.0001  max mem: 21515
Epoch: [1]  [ 3000/10010]  eta: 0:09:39  lr: 0.01  img/s: 396.37851215262395  loss: 0.8938 (0.8771)  acc1: 78.1250 (78.3333)  acc5: 90.6250 (92.4973)  time: 0.0819  data: 0.0002  max mem: 21515
Epoch: [1]  [ 4000/10010]  eta: 0:08:16  lr: 0.01  img/s: 397.3819129250492  loss: 1.0167 (0.8814)  acc1: 75.0000 (78.2140)  acc5: 87.5000 (92.4574)  time: 0.0833  data: 0.0001  max mem: 21515
Epoch: [1]  [ 5000/10010]  eta: 0:06:53  lr: 0.01  img/s: 393.17146104542843  loss: 0.7456 (0.8847)  acc1: 81.2500 (78.1937)  acc5: 90.6250 (92.4084)  time: 0.0821  data: 0.0001  max mem: 21515
Epoch: [1]  [ 6000/10010]  eta: 0:05:30  lr: 0.01  img/s: 391.6753084546335  loss: 0.7591 (0.8874)  acc1: 78.1250 (78.1807)  acc5: 93.7500 (92.3737)  time: 0.0821  data: 0.0001  max mem: 21515
Epoch: [1]  [ 7000/10010]  eta: 0:04:08  lr: 0.01  img/s: 393.7493303918491  loss: 0.8529 (0.8866)  acc1: 75.0000 (78.1906)  acc5: 93.7500 (92.3560)  time: 0.0815  data: 0.0001  max mem: 21515
Epoch: [1]  [ 8000/10010]  eta: 0:02:45  lr: 0.01  img/s: 392.7090065364832  loss: 0.7773 (0.8881)  acc1: 78.1250 (78.1629)  acc5: 93.7500 (92.3228)  time: 0.0822  data: 0.0001  max mem: 21515
Epoch: [1]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 382.07645643850435  loss: 0.9267 (0.8901)  acc1: 78.1250 (78.1201)  acc5: 90.6250 (92.3002)  time: 0.0825  data: 0.0001  max mem: 21515
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 399.5574131628145  loss: 0.8350 (0.8899)  acc1: 75.0000 (78.1225)  acc5: 93.7500 (92.3064)  time: 0.0799  data: 0.0001  max mem: 21515
Epoch: [1] Total time: 0:13:44
Test:   [  0/391]  eta: 0:11:17  loss: 0.4140 (0.4140)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7319  data: 1.6943  max mem: 21515
Test:   [100/391]  eta: 0:00:25  loss: 0.6545 (0.6921)  acc1: 81.2500 (81.7450)  acc5: 96.8750 (95.9158)  time: 0.0864  data: 0.0505  max mem: 21515
Test:   [200/391]  eta: 0:00:14  loss: 1.1697 (0.7925)  acc1: 68.7500 (79.3377)  acc5: 87.5000 (94.9471)  time: 0.0519  data: 0.0161  max mem: 21515
Test:   [300/391]  eta: 0:00:06  loss: 1.2386 (0.9201)  acc1: 68.7500 (76.7857)  acc5: 87.5000 (93.4904)  time: 0.0592  data: 0.0236  max mem: 21515
Test:  Total time: 0:00:27
Test:  Acc@1 76.236 Acc@5 92.958
Number of added parameters: 147472
Epoch: [2]  [    0/10010]  eta: 5:52:57  lr: 0.01  img/s: 253.5984264614466  loss: 1.2141 (1.2141)  acc1: 62.5000 (62.5000)  acc5: 90.6250 (90.6250)  time: 2.1157  data: 1.9895  max mem: 21515
Epoch: [2]  [ 1000/10010]  eta: 0:12:53  lr: 0.01  img/s: 387.7343301777507  loss: 0.8494 (0.8774)  acc1: 78.1250 (78.2311)  acc5: 93.7500 (92.4419)  time: 0.0839  data: 0.0001  max mem: 21515
Epoch: [2]  [ 2000/10010]  eta: 0:11:17  lr: 0.01  img/s: 382.6701488281918  loss: 0.7878 (0.8832)  acc1: 78.1250 (78.0844)  acc5: 93.7500 (92.4741)  time: 0.0832  data: 0.0002  max mem: 21515
Epoch: [2]  [ 3000/10010]  eta: 0:09:50  lr: 0.01  img/s: 381.2592049721905  loss: 0.7343 (0.8846)  acc1: 78.1250 (78.0729)  acc5: 93.7500 (92.4338)  time: 0.0834  data: 0.0001  max mem: 21515
Epoch: [2]  [ 4000/10010]  eta: 0:08:24  lr: 0.01  img/s: 380.13942646746443  loss: 0.8827 (0.8859)  acc1: 78.1250 (78.0852)  acc5: 93.7500 (92.3847)  time: 0.0836  data: 0.0001  max mem: 21515
Epoch: [2]  [ 5000/10010]  eta: 0:07:00  lr: 0.01  img/s: 389.1395353557025  loss: 0.8912 (0.8874)  acc1: 75.0000 (78.0831)  acc5: 90.6250 (92.3615)  time: 0.0833  data: 0.0001  max mem: 21515
Epoch: [2]  [ 6000/10010]  eta: 0:05:36  lr: 0.01  img/s: 385.32105751205046  loss: 0.8629 (0.8855)  acc1: 78.1250 (78.1516)  acc5: 90.6250 (92.3664)  time: 0.0836  data: 0.0001  max mem: 21515
Epoch: [2]  [ 7000/10010]  eta: 0:04:12  lr: 0.01  img/s: 384.9497308289093  loss: 0.9890 (0.8856)  acc1: 75.0000 (78.1540)  acc5: 90.6250 (92.3725)  time: 0.0835  data: 0.0002  max mem: 21515
Epoch: [2]  [ 8000/10010]  eta: 0:02:48  lr: 0.01  img/s: 381.1282062931801  loss: 0.8917 (0.8868)  acc1: 78.1250 (78.1312)  acc5: 90.6250 (92.3478)  time: 0.0839  data: 0.0002  max mem: 21515
Epoch: [2]  [ 9000/10010]  eta: 0:01:24  lr: 0.01  img/s: 382.11779175338154  loss: 0.8163 (0.8864)  acc1: 81.2500 (78.1253)  acc5: 93.7500 (92.3536)  time: 0.0833  data: 0.0001  max mem: 21515
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 387.91362980817865  loss: 0.7967 (0.8870)  acc1: 78.1250 (78.1406)  acc5: 93.7500 (92.3458)  time: 0.0809  data: 0.0001  max mem: 21515
Epoch: [2] Total time: 0:13:58
Test:   [  0/391]  eta: 0:10:09  loss: 0.4064 (0.4064)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5601  data: 1.5056  max mem: 21515
Test:   [100/391]  eta: 0:00:24  loss: 0.6425 (0.6919)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.9158)  time: 0.0702  data: 0.0320  max mem: 21515
Test:   [200/391]  eta: 0:00:15  loss: 1.1951 (0.7904)  acc1: 68.7500 (79.3843)  acc5: 87.5000 (94.9471)  time: 0.0704  data: 0.0321  max mem: 21515
Test:   [300/391]  eta: 0:00:06  loss: 1.2251 (0.9186)  acc1: 68.7500 (76.8065)  acc5: 87.5000 (93.4697)  time: 0.0533  data: 0.0193  max mem: 21515
Test:  Total time: 0:00:28
Test:  Acc@1 76.248 Acc@5 92.976
Number of added parameters: 147472
Epoch: [3]  [    0/10010]  eta: 5:10:51  lr: 0.01  img/s: 100.60944479467365  loss: 0.4658 (0.4658)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.8633  data: 1.5452  max mem: 21515
Epoch: [3]  [ 1000/10010]  eta: 0:13:00  lr: 0.01  img/s: 376.48731556802244  loss: 1.0266 (0.8817)  acc1: 75.0000 (77.8909)  acc5: 93.7500 (92.5106)  time: 0.0848  data: 0.0001  max mem: 21515
Epoch: [3]  [ 2000/10010]  eta: 0:11:25  lr: 0.01  img/s: 384.63973588885324  loss: 0.9235 (0.8842)  acc1: 78.1250 (77.9579)  acc5: 93.7500 (92.4959)  time: 0.0850  data: 0.0001  max mem: 21515
Epoch: [3]  [ 3000/10010]  eta: 0:09:57  lr: 0.01  img/s: 387.35610409325335  loss: 0.8871 (0.8936)  acc1: 78.1250 (77.9251)  acc5: 90.6250 (92.3224)  time: 0.0848  data: 0.0001  max mem: 21515
Epoch: [3]  [ 4000/10010]  eta: 0:08:31  lr: 0.01  img/s: 376.46302763075596  loss: 0.8128 (0.8913)  acc1: 78.1250 (77.9165)  acc5: 90.6250 (92.3785)  time: 0.0845  data: 0.0001  max mem: 21515
Epoch: [3]  [ 5000/10010]  eta: 0:07:05  lr: 0.01  img/s: 385.0259270096445  loss: 0.9226 (0.8909)  acc1: 75.0000 (77.9663)  acc5: 93.7500 (92.3896)  time: 0.0850  data: 0.0001  max mem: 21515
Epoch: [3]  [ 6000/10010]  eta: 0:05:40  lr: 0.01  img/s: 368.3505399656947  loss: 0.7959 (0.8903)  acc1: 75.0000 (77.9943)  acc5: 93.7500 (92.3643)  time: 0.0855  data: 0.0001  max mem: 21515
Epoch: [3]  [ 7000/10010]  eta: 0:04:15  lr: 0.01  img/s: 364.1906457153556  loss: 0.7157 (0.8910)  acc1: 81.2500 (77.9991)  acc5: 93.7500 (92.3417)  time: 0.0855  data: 0.0001  max mem: 21515
Epoch: [3]  [ 8000/10010]  eta: 0:02:50  lr: 0.01  img/s: 378.2485852778717  loss: 0.7895 (0.8901)  acc1: 81.2500 (78.0289)  acc5: 93.7500 (92.3385)  time: 0.0843  data: 0.0001  max mem: 21515
Epoch: [3]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 381.8221148785699  loss: 0.8953 (0.8900)  acc1: 78.1250 (78.0396)  acc5: 90.6250 (92.3502)  time: 0.0849  data: 0.0001  max mem: 21515
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 383.0217854105668  loss: 0.8291 (0.8911)  acc1: 78.1250 (78.0097)  acc5: 93.7500 (92.3317)  time: 0.0829  data: 0.0001  max mem: 21515
Epoch: [3] Total time: 0:14:10
Test:   [  0/391]  eta: 0:10:12  loss: 0.4052 (0.4052)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5660  data: 1.5186  max mem: 21515
Test:   [100/391]  eta: 0:00:26  loss: 0.6611 (0.6921)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (95.9468)  time: 0.0628  data: 0.0253  max mem: 21515
Test:   [200/391]  eta: 0:00:15  loss: 1.1600 (0.7906)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.9316)  time: 0.0689  data: 0.0283  max mem: 21515
Test:   [300/391]  eta: 0:00:07  loss: 1.2616 (0.9190)  acc1: 68.7500 (76.8065)  acc5: 87.5000 (93.4593)  time: 0.0703  data: 0.0362  max mem: 21515
Test:  Total time: 0:00:28
Test:  Acc@1 76.272 Acc@5 92.940
Number of added parameters: 147472
Epoch: [4]  [    0/10010]  eta: 6:15:16  lr: 0.01  img/s: 186.45986710584992  loss: 0.7134 (0.7134)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 2.2494  data: 2.0777  max mem: 21515
Epoch: [4]  [ 1000/10010]  eta: 0:13:13  lr: 0.01  img/s: 371.9972616635671  loss: 0.9505 (0.8877)  acc1: 75.0000 (78.0532)  acc5: 90.6250 (92.3920)  time: 0.0861  data: 0.0001  max mem: 21515
Epoch: [4]  [ 2000/10010]  eta: 0:11:37  lr: 0.01  img/s: 378.0035711268201  loss: 0.7802 (0.8865)  acc1: 75.0000 (78.0688)  acc5: 93.7500 (92.3398)  time: 0.0852  data: 0.0001  max mem: 21515
Epoch: [4]  [ 3000/10010]  eta: 0:10:07  lr: 0.01  img/s: 380.0091960271351  loss: 0.8461 (0.8861)  acc1: 78.1250 (78.0990)  acc5: 90.6250 (92.3213)  time: 0.0869  data: 0.0001  max mem: 21515
Epoch: [4]  [ 4000/10010]  eta: 0:08:39  lr: 0.01  img/s: 382.05687967367203  loss: 0.7360 (0.8802)  acc1: 78.1250 (78.2523)  acc5: 93.7500 (92.4269)  time: 0.0862  data: 0.0001  max mem: 21515
Epoch: [4]  [ 5000/10010]  eta: 0:07:12  lr: 0.01  img/s: 361.63151328995406  loss: 0.8077 (0.8812)  acc1: 78.1250 (78.2006)  acc5: 93.7500 (92.4378)  time: 0.0858  data: 0.0001  max mem: 21515
Epoch: [4]  [ 6000/10010]  eta: 0:05:45  lr: 0.01  img/s: 383.7983237491743  loss: 0.8739 (0.8827)  acc1: 78.1250 (78.1937)  acc5: 93.7500 (92.4226)  time: 0.0859  data: 0.0001  max mem: 21515
Epoch: [4]  [ 7000/10010]  eta: 0:04:19  lr: 0.01  img/s: 373.4276183083348  loss: 0.8534 (0.8835)  acc1: 78.1250 (78.2094)  acc5: 90.6250 (92.3922)  time: 0.0852  data: 0.0001  max mem: 21515
Epoch: [4]  [ 8000/10010]  eta: 0:02:53  lr: 0.01  img/s: 375.22219053849295  loss: 0.8879 (0.8826)  acc1: 78.1250 (78.2578)  acc5: 90.6250 (92.4013)  time: 0.0854  data: 0.0001  max mem: 21515
Epoch: [4]  [ 9000/10010]  eta: 0:01:27  lr: 0.01  img/s: 377.7822662816161  loss: 0.9557 (0.8839)  acc1: 75.0000 (78.2271)  acc5: 90.6250 (92.3758)  time: 0.0861  data: 0.0001  max mem: 21515
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 393.1968009374542  loss: 0.7660 (0.8853)  acc1: 78.1250 (78.1878)  acc5: 93.7500 (92.3661)  time: 0.0835  data: 0.0001  max mem: 21515
Epoch: [4] Total time: 0:14:22
Test:   [  0/391]  eta: 0:09:12  loss: 0.3879 (0.3879)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4123  data: 1.3753  max mem: 21515
Test:   [100/391]  eta: 0:00:25  loss: 0.6555 (0.6908)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (95.9158)  time: 0.0581  data: 0.0214  max mem: 21515
Test:   [200/391]  eta: 0:00:14  loss: 1.2261 (0.7908)  acc1: 68.7500 (79.3688)  acc5: 90.6250 (94.8694)  time: 0.0611  data: 0.0208  max mem: 21515
Test:   [300/391]  eta: 0:00:06  loss: 1.2565 (0.9196)  acc1: 68.7500 (76.8169)  acc5: 87.5000 (93.3866)  time: 0.0595  data: 0.0249  max mem: 21515
Test:  Total time: 0:00:28
Test:  Acc@1 76.194 Acc@5 92.944
Number of added parameters: 147472
Training time 1:12:15
Experiment with model=resnet50, n_components=16, and dof=4 completed
-----------------------------------
Running experiment with n_components=16 and dof=8
[2024-11-14 20:24:18,188] torch.distributed.run: [WARNING] 
[2024-11-14 20:24:18,188] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 20:24:18,188] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 20:24:18,188] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 2): env://
| distributed init (rank 3): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=16, dof=8, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.3831353187561035
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 278544
Start training
Epoch: [0]  [    0/10010]  eta: 13:54:27  lr: 0.01  img/s: 10.899621170440332  loss: 0.6909 (0.6909)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 5.0017  data: 2.0658  max mem: 21520
Epoch: [0]  [ 1000/10010]  eta: 0:12:47  lr: 0.01  img/s: 405.2859213450575  loss: 0.8606 (0.9166)  acc1: 81.2500 (77.8440)  acc5: 93.7500 (91.8550)  time: 0.0804  data: 0.0001  max mem: 21520
Epoch: [0]  [ 2000/10010]  eta: 0:11:02  lr: 0.01  img/s: 397.81299331039247  loss: 0.7503 (0.9084)  acc1: 81.2500 (77.8642)  acc5: 93.7500 (91.9696)  time: 0.0810  data: 0.0001  max mem: 21520
Epoch: [0]  [ 3000/10010]  eta: 0:09:34  lr: 0.01  img/s: 399.03355066194547  loss: 1.0354 (0.9035)  acc1: 71.8750 (77.9032)  acc5: 90.6250 (92.0849)  time: 0.0803  data: 0.0001  max mem: 21520
Epoch: [0]  [ 4000/10010]  eta: 0:08:09  lr: 0.01  img/s: 403.50093947383453  loss: 0.7558 (0.9010)  acc1: 81.2500 (77.9352)  acc5: 93.7500 (92.1363)  time: 0.0799  data: 0.0001  max mem: 21520
Epoch: [0]  [ 5000/10010]  eta: 0:06:46  lr: 0.01  img/s: 381.6353787842168  loss: 0.8731 (0.9011)  acc1: 78.1250 (77.9138)  acc5: 93.7500 (92.1516)  time: 0.0807  data: 0.0001  max mem: 21520
Epoch: [0]  [ 6000/10010]  eta: 0:05:24  lr: 0.01  img/s: 401.09892566305564  loss: 0.9114 (0.9013)  acc1: 75.0000 (77.9089)  acc5: 90.6250 (92.1539)  time: 0.0800  data: 0.0001  max mem: 21520
Epoch: [0]  [ 7000/10010]  eta: 0:04:03  lr: 0.01  img/s: 385.2624375681727  loss: 0.9438 (0.8996)  acc1: 75.0000 (77.9161)  acc5: 90.6250 (92.1917)  time: 0.0801  data: 0.0001  max mem: 21520
Epoch: [0]  [ 8000/10010]  eta: 0:02:42  lr: 0.01  img/s: 408.86258000249796  loss: 1.0008 (0.8989)  acc1: 75.0000 (77.9625)  acc5: 90.6250 (92.1908)  time: 0.0801  data: 0.0001  max mem: 21520
Epoch: [0]  [ 9000/10010]  eta: 0:01:21  lr: 0.01  img/s: 405.2455397175733  loss: 0.9017 (0.8972)  acc1: 75.0000 (77.9934)  acc5: 90.6250 (92.2082)  time: 0.0802  data: 0.0001  max mem: 21520
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 410.4831500879272  loss: 0.6894 (0.8964)  acc1: 84.3750 (77.9800)  acc5: 93.7500 (92.2336)  time: 0.0798  data: 0.0001  max mem: 21520
Epoch: [0] Total time: 0:13:28
Test:   [  0/391]  eta: 0:12:19  loss: 0.4015 (0.4015)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.8915  data: 1.7557  max mem: 21520
Test:   [100/391]  eta: 0:00:26  loss: 0.6558 (0.6905)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.9468)  time: 0.0715  data: 0.0360  max mem: 21520
Test:   [200/391]  eta: 0:00:15  loss: 1.2171 (0.7913)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.9471)  time: 0.0615  data: 0.0300  max mem: 21520
Test:   [300/391]  eta: 0:00:06  loss: 1.2321 (0.9203)  acc1: 68.7500 (76.8272)  acc5: 87.5000 (93.4178)  time: 0.0683  data: 0.0338  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.238 Acc@5 92.978
Number of added parameters: 278544
Epoch: [1]  [    0/10010]  eta: 4:52:03  lr: 0.01  img/s: 106.068353684124  loss: 1.3566 (1.3566)  acc1: 78.1250 (78.1250)  acc5: 87.5000 (87.5000)  time: 1.7506  data: 1.4489  max mem: 21520
Epoch: [1]  [ 1000/10010]  eta: 0:12:33  lr: 0.01  img/s: 396.80741713082864  loss: 0.8203 (0.8895)  acc1: 81.2500 (78.2561)  acc5: 93.7500 (92.3108)  time: 0.0813  data: 0.0001  max mem: 21520
Epoch: [1]  [ 2000/10010]  eta: 0:11:02  lr: 0.01  img/s: 397.14439410930976  loss: 0.9058 (0.8873)  acc1: 78.1250 (78.2265)  acc5: 90.6250 (92.3523)  time: 0.0821  data: 0.0002  max mem: 21520
Epoch: [1]  [ 3000/10010]  eta: 0:09:38  lr: 0.01  img/s: 391.2482961667395  loss: 0.8780 (0.8930)  acc1: 78.1250 (78.2291)  acc5: 93.7500 (92.2599)  time: 0.0817  data: 0.0001  max mem: 21520
Epoch: [1]  [ 4000/10010]  eta: 0:08:14  lr: 0.01  img/s: 394.68721200019996  loss: 0.7772 (0.8919)  acc1: 78.1250 (78.2023)  acc5: 90.6250 (92.2590)  time: 0.0817  data: 0.0001  max mem: 21520
Epoch: [1]  [ 5000/10010]  eta: 0:06:51  lr: 0.01  img/s: 389.1587163517855  loss: 0.8534 (0.8908)  acc1: 75.0000 (78.1800)  acc5: 93.7500 (92.2784)  time: 0.0815  data: 0.0001  max mem: 21520
Epoch: [1]  [ 6000/10010]  eta: 0:05:29  lr: 0.01  img/s: 396.41597504858555  loss: 0.7130 (0.8886)  acc1: 81.2500 (78.2187)  acc5: 93.7500 (92.3195)  time: 0.0814  data: 0.0001  max mem: 21520
Epoch: [1]  [ 7000/10010]  eta: 0:04:06  lr: 0.01  img/s: 390.2279362808805  loss: 1.0028 (0.8886)  acc1: 75.0000 (78.2585)  acc5: 90.6250 (92.3176)  time: 0.0817  data: 0.0001  max mem: 21520
Epoch: [1]  [ 8000/10010]  eta: 0:02:44  lr: 0.01  img/s: 392.4690057692926  loss: 0.9487 (0.8886)  acc1: 75.0000 (78.2387)  acc5: 90.6250 (92.3322)  time: 0.0817  data: 0.0001  max mem: 21520
Epoch: [1]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 394.7011401298048  loss: 0.8489 (0.8905)  acc1: 78.1250 (78.2066)  acc5: 90.6250 (92.2842)  time: 0.0816  data: 0.0001  max mem: 21520
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 397.04688202579575  loss: 0.8889 (0.8896)  acc1: 78.1250 (78.1959)  acc5: 93.7500 (92.3105)  time: 0.0802  data: 0.0001  max mem: 21520
Epoch: [1] Total time: 0:13:40
Test:   [  0/391]  eta: 0:13:08  loss: 0.3975 (0.3975)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 2.0157  data: 1.9810  max mem: 21520
Test:   [100/391]  eta: 0:00:24  loss: 0.6538 (0.6917)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.9158)  time: 0.0638  data: 0.0266  max mem: 21520
Test:   [200/391]  eta: 0:00:14  loss: 1.1638 (0.7918)  acc1: 68.7500 (79.3221)  acc5: 87.5000 (94.8850)  time: 0.0658  data: 0.0310  max mem: 21520
Test:   [300/391]  eta: 0:00:06  loss: 1.2562 (0.9189)  acc1: 68.7500 (76.7857)  acc5: 87.5000 (93.4282)  time: 0.0610  data: 0.0252  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.222 Acc@5 92.970
Number of added parameters: 278544
Epoch: [2]  [    0/10010]  eta: 6:32:41  lr: 0.01  img/s: 102.02853989229885  loss: 1.5770 (1.5770)  acc1: 65.6250 (65.6250)  acc5: 87.5000 (87.5000)  time: 2.3538  data: 2.0401  max mem: 21520
Epoch: [2]  [ 1000/10010]  eta: 0:12:49  lr: 0.01  img/s: 388.2716037954177  loss: 0.7959 (0.8852)  acc1: 81.2500 (78.2405)  acc5: 90.6250 (92.3701)  time: 0.0836  data: 0.0001  max mem: 21520
Epoch: [2]  [ 2000/10010]  eta: 0:11:16  lr: 0.01  img/s: 386.6954239402574  loss: 0.8673 (0.8905)  acc1: 75.0000 (78.1359)  acc5: 90.6250 (92.3929)  time: 0.0829  data: 0.0001  max mem: 21520
Epoch: [2]  [ 3000/10010]  eta: 0:09:49  lr: 0.01  img/s: 387.7488920859984  loss: 0.7749 (0.8922)  acc1: 81.2500 (78.0958)  acc5: 93.7500 (92.3348)  time: 0.0835  data: 0.0001  max mem: 21520
Epoch: [2]  [ 4000/10010]  eta: 0:08:23  lr: 0.01  img/s: 394.4053787202031  loss: 0.9984 (0.8945)  acc1: 75.0000 (77.9875)  acc5: 90.6250 (92.2879)  time: 0.0830  data: 0.0001  max mem: 21520
Epoch: [2]  [ 5000/10010]  eta: 0:06:59  lr: 0.01  img/s: 392.0860722663496  loss: 0.8673 (0.8959)  acc1: 75.0000 (77.9782)  acc5: 93.7500 (92.2584)  time: 0.0828  data: 0.0001  max mem: 21520
Epoch: [2]  [ 6000/10010]  eta: 0:05:35  lr: 0.01  img/s: 388.1144179052686  loss: 0.9620 (0.8939)  acc1: 78.1250 (78.0505)  acc5: 93.7500 (92.2752)  time: 0.0828  data: 0.0001  max mem: 21520
Epoch: [2]  [ 7000/10010]  eta: 0:04:11  lr: 0.01  img/s: 386.34590950567497  loss: 0.7992 (0.8949)  acc1: 75.0000 (78.0317)  acc5: 93.7500 (92.2632)  time: 0.0827  data: 0.0001  max mem: 21520
Epoch: [2]  [ 8000/10010]  eta: 0:02:47  lr: 0.01  img/s: 386.33367682361677  loss: 0.7590 (0.8963)  acc1: 81.2500 (78.0133)  acc5: 93.7500 (92.2393)  time: 0.0833  data: 0.0001  max mem: 21520
Epoch: [2]  [ 9000/10010]  eta: 0:01:24  lr: 0.01  img/s: 387.65034052115044  loss: 0.9201 (0.8975)  acc1: 78.1250 (77.9976)  acc5: 93.7500 (92.2113)  time: 0.0829  data: 0.0001  max mem: 21520
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 394.86486931758003  loss: 0.8327 (0.8998)  acc1: 78.1250 (77.9603)  acc5: 93.7500 (92.1692)  time: 0.0813  data: 0.0001  max mem: 21520
Epoch: [2] Total time: 0:13:55
Test:   [  0/391]  eta: 0:10:38  loss: 0.4054 (0.4054)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6332  data: 1.6027  max mem: 21520
Test:   [100/391]  eta: 0:00:25  loss: 0.6356 (0.6910)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (95.9158)  time: 0.0680  data: 0.0331  max mem: 21520
Test:   [200/391]  eta: 0:00:15  loss: 1.2023 (0.7909)  acc1: 68.7500 (79.3221)  acc5: 90.6250 (94.9627)  time: 0.0716  data: 0.0349  max mem: 21520
Test:   [300/391]  eta: 0:00:06  loss: 1.2474 (0.9185)  acc1: 68.7500 (76.7650)  acc5: 87.5000 (93.5216)  time: 0.0491  data: 0.0146  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.240 Acc@5 93.006
Number of added parameters: 278544
Epoch: [3]  [    0/10010]  eta: 5:22:57  lr: 0.01  img/s: 57.497126808542724  loss: 0.7544 (0.7544)  acc1: 78.1250 (78.1250)  acc5: 90.6250 (90.6250)  time: 1.9358  data: 1.3792  max mem: 21520
Epoch: [3]  [ 1000/10010]  eta: 0:13:00  lr: 0.01  img/s: 382.9889969410583  loss: 0.8470 (0.8868)  acc1: 75.0000 (77.9221)  acc5: 90.6250 (92.3608)  time: 0.0844  data: 0.0001  max mem: 21520
Epoch: [3]  [ 2000/10010]  eta: 0:11:25  lr: 0.01  img/s: 382.0862455732814  loss: 0.8509 (0.8833)  acc1: 78.1250 (78.1797)  acc5: 90.6250 (92.4116)  time: 0.0842  data: 0.0001  max mem: 21520
Epoch: [3]  [ 3000/10010]  eta: 0:09:57  lr: 0.01  img/s: 381.6581681690221  loss: 0.8473 (0.8941)  acc1: 78.1250 (78.0740)  acc5: 90.6250 (92.2318)  time: 0.0843  data: 0.0001  max mem: 21520
Epoch: [3]  [ 4000/10010]  eta: 0:08:30  lr: 0.01  img/s: 384.2235187019426  loss: 0.8245 (0.8966)  acc1: 81.2500 (78.0102)  acc5: 90.6250 (92.2269)  time: 0.0842  data: 0.0001  max mem: 21520
Epoch: [3]  [ 5000/10010]  eta: 0:07:05  lr: 0.01  img/s: 380.0769908221548  loss: 0.7389 (0.8975)  acc1: 78.1250 (77.9713)  acc5: 96.8750 (92.2447)  time: 0.0850  data: 0.0001  max mem: 21520
Epoch: [3]  [ 6000/10010]  eta: 0:05:39  lr: 0.01  img/s: 378.1974256666892  loss: 0.8944 (0.8967)  acc1: 78.1250 (77.9683)  acc5: 90.6250 (92.2466)  time: 0.0843  data: 0.0001  max mem: 21520
Epoch: [3]  [ 7000/10010]  eta: 0:04:15  lr: 0.01  img/s: 374.15840253791964  loss: 0.8516 (0.8937)  acc1: 75.0000 (78.0594)  acc5: 93.7500 (92.2712)  time: 0.0843  data: 0.0001  max mem: 21520
Epoch: [3]  [ 8000/10010]  eta: 0:02:50  lr: 0.01  img/s: 384.82832099961865  loss: 0.7771 (0.8929)  acc1: 81.2500 (78.0594)  acc5: 90.6250 (92.2752)  time: 0.0842  data: 0.0001  max mem: 21520
Epoch: [3]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 376.76209297103077  loss: 1.0024 (0.8920)  acc1: 78.1250 (78.0552)  acc5: 93.7500 (92.2977)  time: 0.0842  data: 0.0001  max mem: 21520
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 387.7444113823487  loss: 0.8820 (0.8923)  acc1: 78.1250 (78.0681)  acc5: 93.7500 (92.2970)  time: 0.0834  data: 0.0001  max mem: 21520
Epoch: [3] Total time: 0:14:07
Test:   [  0/391]  eta: 0:10:55  loss: 0.4010 (0.4010)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6753  data: 1.6245  max mem: 21520
Test:   [100/391]  eta: 0:00:26  loss: 0.6574 (0.6924)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.8849)  time: 0.0704  data: 0.0318  max mem: 21520
Test:   [200/391]  eta: 0:00:15  loss: 1.1973 (0.7915)  acc1: 68.7500 (79.3999)  acc5: 87.5000 (94.9471)  time: 0.0783  data: 0.0415  max mem: 21520
Test:   [300/391]  eta: 0:00:07  loss: 1.2391 (0.9198)  acc1: 68.7500 (76.8169)  acc5: 87.5000 (93.4593)  time: 0.0624  data: 0.0261  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.244 Acc@5 92.946
Number of added parameters: 278544
Epoch: [4]  [    0/10010]  eta: 5:21:05  lr: 0.01  img/s: 232.88589057544021  loss: 0.8272 (0.8272)  acc1: 78.1250 (78.1250)  acc5: 90.6250 (90.6250)  time: 1.9246  data: 1.7872  max mem: 21520
Epoch: [4]  [ 1000/10010]  eta: 0:13:09  lr: 0.01  img/s: 369.40997990807256  loss: 0.8007 (0.8900)  acc1: 78.1250 (78.0938)  acc5: 93.7500 (92.3670)  time: 0.0863  data: 0.0001  max mem: 21520
Epoch: [4]  [ 2000/10010]  eta: 0:11:34  lr: 0.01  img/s: 377.3680173645085  loss: 0.8027 (0.8861)  acc1: 81.2500 (78.2218)  acc5: 93.7500 (92.3507)  time: 0.0855  data: 0.0001  max mem: 21520
Epoch: [4]  [ 3000/10010]  eta: 0:10:05  lr: 0.01  img/s: 368.3454854821889  loss: 0.9266 (0.8857)  acc1: 78.1250 (78.2479)  acc5: 90.6250 (92.3119)  time: 0.0857  data: 0.0001  max mem: 21520
Epoch: [4]  [ 4000/10010]  eta: 0:08:37  lr: 0.01  img/s: 377.6610840986854  loss: 0.7934 (0.8874)  acc1: 78.1250 (78.2539)  acc5: 93.7500 (92.3230)  time: 0.0852  data: 0.0001  max mem: 21520
Epoch: [4]  [ 5000/10010]  eta: 0:07:11  lr: 0.01  img/s: 375.2064565005297  loss: 0.8511 (0.8875)  acc1: 78.1250 (78.2550)  acc5: 93.7500 (92.3315)  time: 0.0860  data: 0.0001  max mem: 21520
Epoch: [4]  [ 6000/10010]  eta: 0:05:44  lr: 0.01  img/s: 360.838173894575  loss: 0.8493 (0.8862)  acc1: 78.1250 (78.2901)  acc5: 93.7500 (92.3487)  time: 0.0855  data: 0.0003  max mem: 21520
Epoch: [4]  [ 7000/10010]  eta: 0:04:18  lr: 0.01  img/s: 378.6807961967639  loss: 0.8600 (0.8857)  acc1: 78.1250 (78.2683)  acc5: 90.6250 (92.3332)  time: 0.0858  data: 0.0001  max mem: 21520
Epoch: [4]  [ 8000/10010]  eta: 0:02:52  lr: 0.01  img/s: 378.4064145794097  loss: 0.7577 (0.8842)  acc1: 78.1250 (78.2902)  acc5: 93.7500 (92.3724)  time: 0.0855  data: 0.0001  max mem: 21520
Epoch: [4]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 372.3171545633341  loss: 0.9480 (0.8836)  acc1: 75.0000 (78.3107)  acc5: 90.6250 (92.3804)  time: 0.0855  data: 0.0001  max mem: 21520
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 382.19504749755106  loss: 0.8679 (0.8872)  acc1: 75.0000 (78.2197)  acc5: 90.6250 (92.3401)  time: 0.0851  data: 0.0001  max mem: 21520
Epoch: [4] Total time: 0:14:19
Test:   [  0/391]  eta: 0:09:22  loss: 0.3944 (0.3944)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4390  data: 1.4069  max mem: 21520
Test:   [100/391]  eta: 0:00:25  loss: 0.6567 (0.6918)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.8849)  time: 0.0632  data: 0.0251  max mem: 21520
Test:   [200/391]  eta: 0:00:15  loss: 1.2410 (0.7912)  acc1: 68.7500 (79.3377)  acc5: 87.5000 (94.8850)  time: 0.0590  data: 0.0200  max mem: 21520
Test:   [300/391]  eta: 0:00:06  loss: 1.2113 (0.9196)  acc1: 68.7500 (76.7650)  acc5: 87.5000 (93.4074)  time: 0.0604  data: 0.0213  max mem: 21520
Test:  Total time: 0:00:28
Test:  Acc@1 76.240 Acc@5 92.950
Number of added parameters: 278544
Training time 1:11:55
Experiment with model=resnet50, n_components=16, and dof=8 completed
-----------------------------------
Running experiment with n_components=16 and dof=16
[2024-11-14 21:36:27,175] torch.distributed.run: [WARNING] 
[2024-11-14 21:36:27,175] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 21:36:27,175] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 21:36:27,175] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 3): env://
| distributed init (rank 1): env://
| distributed init (rank 2): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=16, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.570486307144165
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 540688
Start training
Epoch: [0]  [    0/10010]  eta: 13:40:05  lr: 0.01  img/s: 10.630496704149662  loss: 1.1968 (1.1968)  acc1: 71.8750 (71.8750)  acc5: 84.3750 (84.3750)  time: 4.9156  data: 1.9054  max mem: 21519
Epoch: [0]  [ 1000/10010]  eta: 0:12:54  lr: 0.01  img/s: 399.7013892404592  loss: 0.7099 (0.9032)  acc1: 81.2500 (77.9283)  acc5: 93.7500 (92.0205)  time: 0.0813  data: 0.0001  max mem: 21519
Epoch: [0]  [ 2000/10010]  eta: 0:11:09  lr: 0.01  img/s: 391.3247245490301  loss: 0.8092 (0.9016)  acc1: 78.1250 (77.9095)  acc5: 93.7500 (92.0399)  time: 0.0814  data: 0.0001  max mem: 21519
Epoch: [0]  [ 3000/10010]  eta: 0:09:39  lr: 0.01  img/s: 403.5336945214458  loss: 0.8712 (0.8965)  acc1: 78.1250 (78.0073)  acc5: 93.7500 (92.1058)  time: 0.0809  data: 0.0001  max mem: 21519
Epoch: [0]  [ 4000/10010]  eta: 0:08:14  lr: 0.01  img/s: 403.4136186711952  loss: 0.8646 (0.8951)  acc1: 75.0000 (78.0336)  acc5: 90.6250 (92.1402)  time: 0.0811  data: 0.0001  max mem: 21519
Epoch: [0]  [ 5000/10010]  eta: 0:06:51  lr: 0.01  img/s: 395.61907681424276  loss: 0.8967 (0.8942)  acc1: 78.1250 (78.0400)  acc5: 90.6250 (92.1934)  time: 0.0817  data: 0.0001  max mem: 21519
Epoch: [0]  [ 6000/10010]  eta: 0:05:28  lr: 0.01  img/s: 398.09617706118064  loss: 0.8784 (0.8940)  acc1: 75.0000 (78.0636)  acc5: 93.7500 (92.2143)  time: 0.0812  data: 0.0001  max mem: 21519
Epoch: [0]  [ 7000/10010]  eta: 0:04:06  lr: 0.01  img/s: 393.9215195966213  loss: 0.9211 (0.8939)  acc1: 78.1250 (78.0714)  acc5: 93.7500 (92.2395)  time: 0.0809  data: 0.0001  max mem: 21519
Epoch: [0]  [ 8000/10010]  eta: 0:02:44  lr: 0.01  img/s: 397.9922962189795  loss: 0.9097 (0.8929)  acc1: 75.0000 (78.0688)  acc5: 90.6250 (92.2689)  time: 0.0808  data: 0.0001  max mem: 21519
Epoch: [0]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 396.5178631041889  loss: 0.7868 (0.8916)  acc1: 78.1250 (78.0903)  acc5: 93.7500 (92.2772)  time: 0.0809  data: 0.0001  max mem: 21519
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 402.810682977044  loss: 0.7937 (0.8907)  acc1: 78.1250 (78.0981)  acc5: 93.7500 (92.3048)  time: 0.0797  data: 0.0001  max mem: 21519
Epoch: [0] Total time: 0:13:37
Test:   [  0/391]  eta: 0:08:45  loss: 0.3895 (0.3895)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3435  data: 1.1872  max mem: 21519
Test:   [100/391]  eta: 0:00:26  loss: 0.6447 (0.6894)  acc1: 81.2500 (81.7760)  acc5: 96.8750 (96.0087)  time: 0.0794  data: 0.0462  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.2090 (0.7915)  acc1: 68.7500 (79.3221)  acc5: 87.5000 (94.9316)  time: 0.0717  data: 0.0363  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2583 (0.9201)  acc1: 68.7500 (76.7546)  acc5: 87.5000 (93.4593)  time: 0.0627  data: 0.0295  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.210 Acc@5 92.970
Number of added parameters: 540688
Epoch: [1]  [    0/10010]  eta: 5:07:53  lr: 0.01  img/s: 99.16718546469058  loss: 0.8853 (0.8853)  acc1: 68.7500 (68.7500)  acc5: 90.6250 (90.6250)  time: 1.8455  data: 1.5228  max mem: 21519
Epoch: [1]  [ 1000/10010]  eta: 0:12:45  lr: 0.01  img/s: 392.8848870531964  loss: 0.7798 (0.8883)  acc1: 81.2500 (78.1750)  acc5: 93.7500 (92.2702)  time: 0.0829  data: 0.0001  max mem: 21519
Epoch: [1]  [ 2000/10010]  eta: 0:11:12  lr: 0.01  img/s: 389.8720098994658  loss: 0.9129 (0.8933)  acc1: 81.2500 (77.9798)  acc5: 90.6250 (92.2351)  time: 0.0829  data: 0.0001  max mem: 21519
Epoch: [1]  [ 3000/10010]  eta: 0:09:46  lr: 0.01  img/s: 400.01349494684575  loss: 0.8060 (0.8978)  acc1: 78.1250 (77.9667)  acc5: 93.7500 (92.1745)  time: 0.0832  data: 0.0001  max mem: 21519
Epoch: [1]  [ 4000/10010]  eta: 0:08:21  lr: 0.01  img/s: 397.9639744886008  loss: 0.8538 (0.9004)  acc1: 81.2500 (77.9211)  acc5: 90.6250 (92.1473)  time: 0.0828  data: 0.0001  max mem: 21519
Epoch: [1]  [ 5000/10010]  eta: 0:06:57  lr: 0.01  img/s: 389.2072414303072  loss: 1.0003 (0.8969)  acc1: 78.1250 (78.0688)  acc5: 90.6250 (92.1941)  time: 0.0830  data: 0.0001  max mem: 21519
Epoch: [1]  [ 6000/10010]  eta: 0:05:33  lr: 0.01  img/s: 388.9331772396926  loss: 0.7219 (0.8975)  acc1: 81.2500 (78.0589)  acc5: 93.7500 (92.1977)  time: 0.0826  data: 0.0001  max mem: 21519
Epoch: [1]  [ 7000/10010]  eta: 0:04:10  lr: 0.01  img/s: 390.412956972983  loss: 0.8796 (0.8962)  acc1: 78.1250 (78.0777)  acc5: 93.7500 (92.2167)  time: 0.0825  data: 0.0002  max mem: 21519
Epoch: [1]  [ 8000/10010]  eta: 0:02:47  lr: 0.01  img/s: 393.38349531636516  loss: 0.9203 (0.8956)  acc1: 78.1250 (78.0945)  acc5: 93.7500 (92.2295)  time: 0.0833  data: 0.0001  max mem: 21519
Epoch: [1]  [ 9000/10010]  eta: 0:01:24  lr: 0.01  img/s: 393.250947105651  loss: 0.9060 (0.8964)  acc1: 75.0000 (78.0924)  acc5: 93.7500 (92.2137)  time: 0.0826  data: 0.0001  max mem: 21519
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 398.5264426859866  loss: 0.9038 (0.8960)  acc1: 81.2500 (78.0919)  acc5: 93.7500 (92.2342)  time: 0.0808  data: 0.0001  max mem: 21519
Epoch: [1] Total time: 0:13:52
Test:   [  0/391]  eta: 0:09:21  loss: 0.3982 (0.3982)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4365  data: 1.3803  max mem: 21519
Test:   [100/391]  eta: 0:00:26  loss: 0.6455 (0.6923)  acc1: 81.2500 (81.7760)  acc5: 96.8750 (95.8540)  time: 0.0630  data: 0.0279  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1746 (0.7929)  acc1: 68.7500 (79.4310)  acc5: 87.5000 (94.8850)  time: 0.0578  data: 0.0208  max mem: 21519
Test:   [300/391]  eta: 0:00:07  loss: 1.2632 (0.9204)  acc1: 68.7500 (76.8480)  acc5: 87.5000 (93.4385)  time: 0.0732  data: 0.0377  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.226 Acc@5 92.936
Number of added parameters: 540688
Epoch: [2]  [    0/10010]  eta: 6:17:46  lr: 0.01  img/s: 269.58225892948604  loss: 1.2829 (1.2829)  acc1: 71.8750 (71.8750)  acc5: 84.3750 (84.3750)  time: 2.2644  data: 2.1457  max mem: 21519
Epoch: [2]  [ 1000/10010]  eta: 0:13:04  lr: 0.01  img/s: 384.07288980967724  loss: 0.8868 (0.8775)  acc1: 78.1250 (78.2124)  acc5: 90.6250 (92.3857)  time: 0.0854  data: 0.0001  max mem: 21519
Epoch: [2]  [ 2000/10010]  eta: 0:11:28  lr: 0.01  img/s: 374.2898718045249  loss: 0.8300 (0.8875)  acc1: 78.1250 (78.1875)  acc5: 93.7500 (92.3835)  time: 0.0849  data: 0.0001  max mem: 21519
Epoch: [2]  [ 3000/10010]  eta: 0:09:59  lr: 0.01  img/s: 378.1633269469176  loss: 0.7682 (0.8815)  acc1: 81.2500 (78.2999)  acc5: 93.7500 (92.4088)  time: 0.0847  data: 0.0001  max mem: 21519
Epoch: [2]  [ 4000/10010]  eta: 0:08:32  lr: 0.01  img/s: 387.388526501726  loss: 0.8508 (0.8865)  acc1: 75.0000 (78.1890)  acc5: 93.7500 (92.3660)  time: 0.0847  data: 0.0001  max mem: 21519
Epoch: [2]  [ 5000/10010]  eta: 0:07:07  lr: 0.01  img/s: 379.41085446625186  loss: 0.9210 (0.8885)  acc1: 75.0000 (78.0956)  acc5: 90.6250 (92.3809)  time: 0.0844  data: 0.0001  max mem: 21519
Epoch: [2]  [ 6000/10010]  eta: 0:05:41  lr: 0.01  img/s: 380.61158641889534  loss: 0.8306 (0.8890)  acc1: 78.1250 (78.1089)  acc5: 93.7500 (92.3580)  time: 0.0849  data: 0.0001  max mem: 21519
Epoch: [2]  [ 7000/10010]  eta: 0:04:16  lr: 0.01  img/s: 385.13530466721187  loss: 0.7662 (0.8885)  acc1: 81.2500 (78.1125)  acc5: 93.7500 (92.3631)  time: 0.0847  data: 0.0001  max mem: 21519
Epoch: [2]  [ 8000/10010]  eta: 0:02:51  lr: 0.01  img/s: 357.6488043530396  loss: 0.8025 (0.8889)  acc1: 81.2500 (78.0781)  acc5: 90.6250 (92.3576)  time: 0.0847  data: 0.0001  max mem: 21519
Epoch: [2]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 380.81028676163913  loss: 0.7287 (0.8892)  acc1: 81.2500 (78.0767)  acc5: 96.8750 (92.3338)  time: 0.0846  data: 0.0001  max mem: 21519
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 376.406016091896  loss: 0.7973 (0.8916)  acc1: 75.0000 (78.0347)  acc5: 93.7500 (92.3030)  time: 0.0838  data: 0.0001  max mem: 21519
Epoch: [2] Total time: 0:14:11
Test:   [  0/391]  eta: 0:11:58  loss: 0.4018 (0.4018)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.8370  data: 1.7836  max mem: 21519
Test:   [100/391]  eta: 0:00:26  loss: 0.6351 (0.6921)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.9468)  time: 0.0855  data: 0.0500  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1772 (0.7916)  acc1: 68.7500 (79.3221)  acc5: 87.5000 (94.9160)  time: 0.0642  data: 0.0308  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2377 (0.9191)  acc1: 68.7500 (76.7961)  acc5: 87.5000 (93.4282)  time: 0.0617  data: 0.0246  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.232 Acc@5 92.964
Number of added parameters: 540688
Epoch: [3]  [    0/10010]  eta: 5:49:33  lr: 0.01  img/s: 79.73166176379733  loss: 0.6890 (0.6890)  acc1: 81.2500 (81.2500)  acc5: 96.8750 (96.8750)  time: 2.0953  data: 1.6939  max mem: 21519
Epoch: [3]  [ 1000/10010]  eta: 0:13:17  lr: 0.01  img/s: 368.93780288349205  loss: 0.9352 (0.8927)  acc1: 78.1250 (78.1156)  acc5: 90.6250 (92.4013)  time: 0.0866  data: 0.0001  max mem: 21519
Epoch: [3]  [ 2000/10010]  eta: 0:11:41  lr: 0.01  img/s: 380.02963952918793  loss: 0.7968 (0.8837)  acc1: 78.1250 (78.1016)  acc5: 93.7500 (92.4975)  time: 0.0867  data: 0.0001  max mem: 21519
Epoch: [3]  [ 3000/10010]  eta: 0:10:12  lr: 0.01  img/s: 377.08705851944046  loss: 0.9447 (0.8900)  acc1: 78.1250 (78.0167)  acc5: 93.7500 (92.3411)  time: 0.0863  data: 0.0001  max mem: 21519
Epoch: [3]  [ 4000/10010]  eta: 0:08:43  lr: 0.01  img/s: 366.296764896921  loss: 0.8799 (0.8926)  acc1: 78.1250 (77.9688)  acc5: 93.7500 (92.3191)  time: 0.0865  data: 0.0001  max mem: 21519
Epoch: [3]  [ 5000/10010]  eta: 0:07:16  lr: 0.01  img/s: 372.935795162478  loss: 0.8377 (0.8947)  acc1: 78.1250 (77.9525)  acc5: 93.7500 (92.2990)  time: 0.0867  data: 0.0001  max mem: 21519
Epoch: [3]  [ 6000/10010]  eta: 0:05:48  lr: 0.01  img/s: 374.6074481773094  loss: 0.7995 (0.8947)  acc1: 81.2500 (77.9703)  acc5: 93.7500 (92.2930)  time: 0.0871  data: 0.0001  max mem: 21519
Epoch: [3]  [ 7000/10010]  eta: 0:04:21  lr: 0.01  img/s: 375.0177509171633  loss: 0.8965 (0.8942)  acc1: 78.1250 (77.9889)  acc5: 93.7500 (92.2792)  time: 0.0866  data: 0.0001  max mem: 21519
Epoch: [3]  [ 8000/10010]  eta: 0:02:54  lr: 0.01  img/s: 376.45985986996743  loss: 0.7209 (0.8922)  acc1: 81.2500 (78.0289)  acc5: 93.7500 (92.3010)  time: 0.0862  data: 0.0001  max mem: 21519
Epoch: [3]  [ 9000/10010]  eta: 0:01:27  lr: 0.01  img/s: 377.2693690427  loss: 0.7638 (0.8927)  acc1: 81.2500 (78.0375)  acc5: 93.7500 (92.2842)  time: 0.0871  data: 0.0001  max mem: 21519
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 379.71999490755803  loss: 0.9090 (0.8928)  acc1: 78.1250 (78.0378)  acc5: 93.7500 (92.2730)  time: 0.0850  data: 0.0001  max mem: 21519
Epoch: [3] Total time: 0:14:29
Test:   [  0/391]  eta: 0:09:23  loss: 0.4021 (0.4021)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4410  data: 1.3879  max mem: 21519
Test:   [100/391]  eta: 0:00:24  loss: 0.6549 (0.6928)  acc1: 81.2500 (81.9616)  acc5: 96.8750 (95.9158)  time: 0.0796  data: 0.0387  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1714 (0.7910)  acc1: 68.7500 (79.4310)  acc5: 87.5000 (94.9160)  time: 0.0590  data: 0.0195  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2490 (0.9194)  acc1: 68.7500 (76.8584)  acc5: 87.5000 (93.4593)  time: 0.0808  data: 0.0419  max mem: 21519
Test:  Total time: 0:00:27
Test:  Acc@1 76.248 Acc@5 92.968
Number of added parameters: 540688
Epoch: [4]  [    0/10010]  eta: 5:50:03  lr: 0.01  img/s: 173.9188883100997  loss: 0.6193 (0.6193)  acc1: 78.1250 (78.1250)  acc5: 100.0000 (100.0000)  time: 2.0982  data: 1.9142  max mem: 21519
Epoch: [4]  [ 1000/10010]  eta: 0:13:35  lr: 0.01  img/s: 363.3663749109978  loss: 0.9460 (0.9026)  acc1: 75.0000 (77.9908)  acc5: 90.6250 (92.0611)  time: 0.0881  data: 0.0001  max mem: 21519
Epoch: [4]  [ 2000/10010]  eta: 0:11:58  lr: 0.01  img/s: 367.88711578416485  loss: 0.7622 (0.8920)  acc1: 78.1250 (78.0735)  acc5: 93.7500 (92.2289)  time: 0.0882  data: 0.0001  max mem: 21519
Epoch: [4]  [ 3000/10010]  eta: 0:10:25  lr: 0.01  img/s: 356.0964251792186  loss: 0.9216 (0.8945)  acc1: 78.1250 (78.0906)  acc5: 90.6250 (92.2182)  time: 0.0885  data: 0.0001  max mem: 21519
Epoch: [4]  [ 4000/10010]  eta: 0:08:55  lr: 0.01  img/s: 366.44877766432046  loss: 0.7728 (0.8897)  acc1: 78.1250 (78.1797)  acc5: 93.7500 (92.3160)  time: 0.0885  data: 0.0001  max mem: 21519
Epoch: [4]  [ 5000/10010]  eta: 0:07:25  lr: 0.01  img/s: 359.03796953662936  loss: 0.8658 (0.8922)  acc1: 78.1250 (78.1175)  acc5: 90.6250 (92.2778)  time: 0.0883  data: 0.0001  max mem: 21519
Epoch: [4]  [ 6000/10010]  eta: 0:05:56  lr: 0.01  img/s: 373.13382114182775  loss: 0.9192 (0.8910)  acc1: 78.1250 (78.1594)  acc5: 93.7500 (92.3070)  time: 0.0880  data: 0.0001  max mem: 21519
Epoch: [4]  [ 7000/10010]  eta: 0:04:27  lr: 0.01  img/s: 364.72010478203924  loss: 0.9241 (0.8897)  acc1: 78.1250 (78.1687)  acc5: 90.6250 (92.3158)  time: 0.0881  data: 0.0001  max mem: 21519
Epoch: [4]  [ 8000/10010]  eta: 0:02:58  lr: 0.01  img/s: 364.3359700317598  loss: 0.8107 (0.8888)  acc1: 78.1250 (78.1976)  acc5: 93.7500 (92.3221)  time: 0.0880  data: 0.0001  max mem: 21519
Epoch: [4]  [ 9000/10010]  eta: 0:01:29  lr: 0.01  img/s: 367.1374121598888  loss: 0.8063 (0.8889)  acc1: 78.1250 (78.1816)  acc5: 93.7500 (92.3057)  time: 0.0882  data: 0.0001  max mem: 21519
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 380.2751332345466  loss: 0.9105 (0.8916)  acc1: 75.0000 (78.1225)  acc5: 90.6250 (92.2823)  time: 0.0869  data: 0.0001  max mem: 21519
Epoch: [4] Total time: 0:14:48
Test:   [  0/391]  eta: 0:09:11  loss: 0.3964 (0.3964)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4113  data: 1.3578  max mem: 21519
Test:   [100/391]  eta: 0:00:25  loss: 0.6626 (0.6907)  acc1: 81.2500 (82.0235)  acc5: 96.8750 (95.7921)  time: 0.0576  data: 0.0158  max mem: 21519
Test:   [200/391]  eta: 0:00:14  loss: 1.2511 (0.7907)  acc1: 68.7500 (79.4310)  acc5: 87.5000 (94.8228)  time: 0.0672  data: 0.0261  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2270 (0.9181)  acc1: 68.7500 (76.8688)  acc5: 87.5000 (93.3970)  time: 0.0652  data: 0.0242  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.210 Acc@5 92.928
Number of added parameters: 540688
Training time 1:13:22
Experiment with model=resnet50, n_components=16, and dof=16 completed
-----------------------------------
Running experiment with n_components=16 and dof=32
[2024-11-14 22:50:01,604] torch.distributed.run: [WARNING] 
[2024-11-14 22:50:01,604] torch.distributed.run: [WARNING] *****************************************
[2024-11-14 22:50:01,604] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-14 22:50:01,604] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=16, dof=32, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.6080918312072754
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 1064976
Start training
Epoch: [0]  [    0/10010]  eta: 13:58:50  lr: 0.01  img/s: 12.481280830596711  loss: 0.6624 (0.6624)  acc1: 78.1250 (78.1250)  acc5: 96.8750 (96.8750)  time: 5.0280  data: 2.4641  max mem: 21530
Epoch: [0]  [ 1000/10010]  eta: 0:13:00  lr: 0.01  img/s: 391.360097039819  loss: 0.7132 (0.8928)  acc1: 78.1250 (78.1094)  acc5: 93.7500 (92.2265)  time: 0.0818  data: 0.0001  max mem: 21530
Epoch: [0]  [ 2000/10010]  eta: 0:11:14  lr: 0.01  img/s: 392.3359261500326  loss: 0.8499 (0.8960)  acc1: 75.0000 (77.9438)  acc5: 90.6250 (92.2242)  time: 0.0824  data: 0.0001  max mem: 21530
Epoch: [0]  [ 3000/10010]  eta: 0:09:44  lr: 0.01  img/s: 347.1396522337374  loss: 0.7573 (0.8991)  acc1: 78.1250 (77.8313)  acc5: 93.7500 (92.1880)  time: 0.0819  data: 0.0001  max mem: 21530
Epoch: [0]  [ 4000/10010]  eta: 0:08:18  lr: 0.01  img/s: 385.1397252726756  loss: 0.8439 (0.8952)  acc1: 75.0000 (77.9126)  acc5: 90.6250 (92.2199)  time: 0.0820  data: 0.0002  max mem: 21530
Epoch: [0]  [ 5000/10010]  eta: 0:06:54  lr: 0.01  img/s: 395.73572355230567  loss: 0.8862 (0.8960)  acc1: 78.1250 (77.9600)  acc5: 90.6250 (92.2066)  time: 0.0820  data: 0.0001  max mem: 21530
Epoch: [0]  [ 6000/10010]  eta: 0:05:31  lr: 0.01  img/s: 387.95287370940326  loss: 0.8759 (0.8963)  acc1: 75.0000 (77.9427)  acc5: 90.6250 (92.2148)  time: 0.0815  data: 0.0001  max mem: 21530
Epoch: [0]  [ 7000/10010]  eta: 0:04:08  lr: 0.01  img/s: 394.36250113856397  loss: 0.8635 (0.8948)  acc1: 75.0000 (77.9911)  acc5: 93.7500 (92.2359)  time: 0.0818  data: 0.0001  max mem: 21530
Epoch: [0]  [ 8000/10010]  eta: 0:02:45  lr: 0.01  img/s: 394.44594717708634  loss: 0.7973 (0.8960)  acc1: 81.2500 (77.9977)  acc5: 93.7500 (92.2174)  time: 0.0816  data: 0.0001  max mem: 21530
Epoch: [0]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 389.84143507760945  loss: 0.9056 (0.8959)  acc1: 75.0000 (78.0129)  acc5: 90.6250 (92.2144)  time: 0.0815  data: 0.0001  max mem: 21530
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 401.420421884393  loss: 0.8611 (0.8943)  acc1: 78.1250 (78.0531)  acc5: 90.6250 (92.2358)  time: 0.0789  data: 0.0001  max mem: 21530
Epoch: [0] Total time: 0:13:44
Test:   [  0/391]  eta: 0:08:55  loss: 0.3960 (0.3960)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3697  data: 1.1796  max mem: 21530
Test:   [100/391]  eta: 0:00:26  loss: 0.6518 (0.6895)  acc1: 81.2500 (81.7450)  acc5: 96.8750 (95.9468)  time: 0.0629  data: 0.0298  max mem: 21530
Test:   [200/391]  eta: 0:00:15  loss: 1.2110 (0.7909)  acc1: 68.7500 (79.2289)  acc5: 90.6250 (94.9316)  time: 0.0651  data: 0.0300  max mem: 21530
Test:   [300/391]  eta: 0:00:06  loss: 1.2537 (0.9196)  acc1: 68.7500 (76.7027)  acc5: 87.5000 (93.4178)  time: 0.0531  data: 0.0249  max mem: 21530
Test:  Total time: 0:00:28
Test:  Acc@1 76.158 Acc@5 92.984
Number of added parameters: 1064976
Epoch: [1]  [    0/10010]  eta: 5:13:45  lr: 0.01  img/s: 82.82866851062622  loss: 0.6243 (0.6243)  acc1: 87.5000 (87.5000)  acc5: 90.6250 (90.6250)  time: 1.8807  data: 1.4943  max mem: 21530
Epoch: [1]  [ 1000/10010]  eta: 0:12:55  lr: 0.01  img/s: 381.1238772954569  loss: 0.8412 (0.8868)  acc1: 78.1250 (78.0875)  acc5: 93.7500 (92.3452)  time: 0.0839  data: 0.0001  max mem: 21530
Epoch: [1]  [ 2000/10010]  eta: 0:11:21  lr: 0.01  img/s: 383.47484028753956  loss: 0.8984 (0.8833)  acc1: 78.1250 (78.2687)  acc5: 93.7500 (92.4428)  time: 0.0844  data: 0.0001  max mem: 21530
Epoch: [1]  [ 3000/10010]  eta: 0:09:53  lr: 0.01  img/s: 373.3279038265228  loss: 1.0299 (0.8859)  acc1: 75.0000 (78.2187)  acc5: 90.6250 (92.3952)  time: 0.0842  data: 0.0001  max mem: 21530
Epoch: [1]  [ 4000/10010]  eta: 0:08:28  lr: 0.01  img/s: 385.22705302917234  loss: 0.9001 (0.8887)  acc1: 78.1250 (78.1359)  acc5: 90.6250 (92.3254)  time: 0.0846  data: 0.0001  max mem: 21530
Epoch: [1]  [ 5000/10010]  eta: 0:07:03  lr: 0.01  img/s: 377.8290591553736  loss: 0.6941 (0.8896)  acc1: 78.1250 (78.1387)  acc5: 93.7500 (92.3109)  time: 0.0845  data: 0.0001  max mem: 21530
Epoch: [1]  [ 6000/10010]  eta: 0:05:38  lr: 0.01  img/s: 384.84156198657536  loss: 0.7642 (0.8899)  acc1: 78.1250 (78.1104)  acc5: 93.7500 (92.3237)  time: 0.0843  data: 0.0001  max mem: 21530
Epoch: [1]  [ 7000/10010]  eta: 0:04:14  lr: 0.01  img/s: 386.7355360708595  loss: 0.7350 (0.8891)  acc1: 81.2500 (78.1036)  acc5: 93.7500 (92.3323)  time: 0.0840  data: 0.0001  max mem: 21530
Epoch: [1]  [ 8000/10010]  eta: 0:02:49  lr: 0.01  img/s: 382.11779175338154  loss: 0.8370 (0.8905)  acc1: 78.1250 (78.1074)  acc5: 90.6250 (92.3053)  time: 0.0843  data: 0.0001  max mem: 21530
Epoch: [1]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 385.75961325665145  loss: 0.9940 (0.8919)  acc1: 75.0000 (78.0667)  acc5: 90.6250 (92.2748)  time: 0.0839  data: 0.0001  max mem: 21530
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 377.7854563366406  loss: 0.7700 (0.8905)  acc1: 84.3750 (78.0941)  acc5: 93.7500 (92.3042)  time: 0.0830  data: 0.0001  max mem: 21530
Epoch: [1] Total time: 0:14:05
Test:   [  0/391]  eta: 0:11:02  loss: 0.4034 (0.4034)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6956  data: 1.6574  max mem: 21530
Test:   [100/391]  eta: 0:00:25  loss: 0.6447 (0.6915)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.9158)  time: 0.0701  data: 0.0359  max mem: 21530
Test:   [200/391]  eta: 0:00:15  loss: 1.1750 (0.7929)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.9160)  time: 0.0733  data: 0.0381  max mem: 21530
Test:   [300/391]  eta: 0:00:06  loss: 1.2368 (0.9206)  acc1: 68.7500 (76.7753)  acc5: 87.5000 (93.4282)  time: 0.0560  data: 0.0230  max mem: 21530
Test:  Total time: 0:00:28
Test:  Acc@1 76.224 Acc@5 92.958
Number of added parameters: 1064976
Epoch: [2]  [    0/10010]  eta: 6:22:48  lr: 0.01  img/s: 118.43757875676381  loss: 0.8284 (0.8284)  acc1: 71.8750 (71.8750)  acc5: 96.8750 (96.8750)  time: 2.2946  data: 2.0244  max mem: 21530
Epoch: [2]  [ 1000/10010]  eta: 0:13:23  lr: 0.01  img/s: 368.71989231065083  loss: 0.7701 (0.8820)  acc1: 81.2500 (78.3123)  acc5: 93.7500 (92.2952)  time: 0.0867  data: 0.0001  max mem: 21530
Epoch: [2]  [ 2000/10010]  eta: 0:11:45  lr: 0.01  img/s: 367.1052785610936  loss: 0.8175 (0.8881)  acc1: 81.2500 (78.1250)  acc5: 93.7500 (92.3101)  time: 0.0864  data: 0.0001  max mem: 21530
Epoch: [2]  [ 3000/10010]  eta: 0:10:14  lr: 0.01  img/s: 371.05318187221644  loss: 0.7810 (0.8860)  acc1: 81.2500 (78.1521)  acc5: 90.6250 (92.3369)  time: 0.0865  data: 0.0001  max mem: 21530
Epoch: [2]  [ 4000/10010]  eta: 0:08:45  lr: 0.01  img/s: 366.6900566901168  loss: 0.8348 (0.8869)  acc1: 78.1250 (78.1851)  acc5: 93.7500 (92.3269)  time: 0.0871  data: 0.0001  max mem: 21530
Epoch: [2]  [ 5000/10010]  eta: 0:07:17  lr: 0.01  img/s: 367.9970607992323  loss: 0.9768 (0.8886)  acc1: 71.8750 (78.1544)  acc5: 90.6250 (92.3022)  time: 0.0871  data: 0.0001  max mem: 21530
Epoch: [2]  [ 6000/10010]  eta: 0:05:50  lr: 0.01  img/s: 372.9772491698045  loss: 0.9529 (0.8882)  acc1: 75.0000 (78.1766)  acc5: 90.6250 (92.3034)  time: 0.0871  data: 0.0001  max mem: 21530
Epoch: [2]  [ 7000/10010]  eta: 0:04:22  lr: 0.01  img/s: 373.0912952230052  loss: 0.7662 (0.8876)  acc1: 81.2500 (78.1737)  acc5: 93.7500 (92.3060)  time: 0.0870  data: 0.0001  max mem: 21530
Epoch: [2]  [ 8000/10010]  eta: 0:02:55  lr: 0.01  img/s: 367.6180782851868  loss: 0.8069 (0.8884)  acc1: 78.1250 (78.1527)  acc5: 93.7500 (92.3189)  time: 0.0871  data: 0.0001  max mem: 21530
Epoch: [2]  [ 9000/10010]  eta: 0:01:28  lr: 0.01  img/s: 361.1799714215748  loss: 0.7124 (0.8893)  acc1: 78.1250 (78.1427)  acc5: 93.7500 (92.3009)  time: 0.0877  data: 0.0001  max mem: 21530
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 380.303148278803  loss: 0.7956 (0.8906)  acc1: 78.1250 (78.1372)  acc5: 93.7500 (92.2826)  time: 0.0839  data: 0.0001  max mem: 21530
Epoch: [2] Total time: 0:14:33
Test:   [  0/391]  eta: 0:09:40  loss: 0.4089 (0.4089)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4856  data: 1.4436  max mem: 21530
Test:   [100/391]  eta: 0:00:27  loss: 0.6443 (0.6915)  acc1: 81.2500 (81.8069)  acc5: 96.8750 (95.8540)  time: 0.0809  data: 0.0407  max mem: 21530
Test:   [200/391]  eta: 0:00:15  loss: 1.1891 (0.7904)  acc1: 68.7500 (79.3066)  acc5: 87.5000 (94.9005)  time: 0.0765  data: 0.0369  max mem: 21530
Test:   [300/391]  eta: 0:00:06  loss: 1.2359 (0.9183)  acc1: 68.7500 (76.7546)  acc5: 87.5000 (93.4385)  time: 0.0699  data: 0.0334  max mem: 21530
Test:  Total time: 0:00:28
Test:  Acc@1 76.222 Acc@5 92.956
Number of added parameters: 1064976
Epoch: [3]  [    0/10010]  eta: 4:23:40  lr: 0.01  img/s: 96.63960923009573  loss: 0.8639 (0.8639)  acc1: 78.1250 (78.1250)  acc5: 84.3750 (84.3750)  time: 1.5804  data: 1.2493  max mem: 21530
Epoch: [3]  [ 1000/10010]  eta: 0:13:43  lr: 0.01  img/s: 353.9702408895031  loss: 0.9192 (0.8917)  acc1: 75.0000 (78.0157)  acc5: 90.6250 (92.3014)  time: 0.0893  data: 0.0001  max mem: 21530
Epoch: [3]  [ 2000/10010]  eta: 0:12:04  lr: 0.01  img/s: 368.2120972697744  loss: 0.8525 (0.8852)  acc1: 81.2500 (78.2531)  acc5: 93.7500 (92.4600)  time: 0.0894  data: 0.0001  max mem: 21530
Epoch: [3]  [ 3000/10010]  eta: 0:10:32  lr: 0.01  img/s: 362.1887342339182  loss: 0.7998 (0.8907)  acc1: 81.2500 (78.1604)  acc5: 90.6250 (92.3224)  time: 0.0897  data: 0.0001  max mem: 21530
Epoch: [3]  [ 4000/10010]  eta: 0:09:00  lr: 0.01  img/s: 360.5851561702425  loss: 0.8699 (0.8911)  acc1: 78.1250 (78.1219)  acc5: 93.7500 (92.3019)  time: 0.0901  data: 0.0001  max mem: 21530
Epoch: [3]  [ 5000/10010]  eta: 0:07:30  lr: 0.01  img/s: 361.14790039877084  loss: 0.9208 (0.8933)  acc1: 78.1250 (78.0825)  acc5: 90.6250 (92.3253)  time: 0.0895  data: 0.0002  max mem: 21530
Epoch: [3]  [ 6000/10010]  eta: 0:06:00  lr: 0.01  img/s: 362.82612327430303  loss: 0.7932 (0.8939)  acc1: 78.1250 (78.0745)  acc5: 93.7500 (92.3409)  time: 0.0899  data: 0.0001  max mem: 21530
Epoch: [3]  [ 7000/10010]  eta: 0:04:30  lr: 0.01  img/s: 353.7239630826319  loss: 0.8151 (0.8927)  acc1: 78.1250 (78.1228)  acc5: 90.6250 (92.3466)  time: 0.0900  data: 0.0001  max mem: 21530
Epoch: [3]  [ 8000/10010]  eta: 0:03:00  lr: 0.01  img/s: 362.9693788418425  loss: 0.7436 (0.8904)  acc1: 81.2500 (78.1590)  acc5: 96.8750 (92.3767)  time: 0.0897  data: 0.0001  max mem: 21530
Epoch: [3]  [ 9000/10010]  eta: 0:01:30  lr: 0.01  img/s: 363.93290636066354  loss: 0.8525 (0.8895)  acc1: 78.1250 (78.1785)  acc5: 93.7500 (92.3939)  time: 0.0891  data: 0.0001  max mem: 21530
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 363.09310133071466  loss: 0.8999 (0.8904)  acc1: 75.0000 (78.1400)  acc5: 93.7500 (92.3870)  time: 0.0884  data: 0.0001  max mem: 21530
Epoch: [3] Total time: 0:14:59
Test:   [  0/391]  eta: 0:08:56  loss: 0.3984 (0.3984)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3730  data: 1.3086  max mem: 21530
Test:   [100/391]  eta: 0:00:24  loss: 0.6753 (0.6928)  acc1: 81.2500 (81.8688)  acc5: 96.8750 (95.9777)  time: 0.0618  data: 0.0211  max mem: 21530
Test:   [200/391]  eta: 0:00:15  loss: 1.1704 (0.7910)  acc1: 68.7500 (79.4310)  acc5: 87.5000 (94.9316)  time: 0.0825  data: 0.0459  max mem: 21530
Test:   [300/391]  eta: 0:00:06  loss: 1.2765 (0.9191)  acc1: 68.7500 (76.8792)  acc5: 87.5000 (93.4385)  time: 0.0726  data: 0.0292  max mem: 21530
Test:  Total time: 0:00:28
Test:  Acc@1 76.248 Acc@5 92.952
Number of added parameters: 1064976
Epoch: [4]  [    0/10010]  eta: 6:29:37  lr: 0.01  img/s: 245.69986471816895  loss: 0.7804 (0.7804)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 2.3354  data: 2.2052  max mem: 21530
Epoch: [4]  [ 1000/10010]  eta: 0:14:11  lr: 0.01  img/s: 326.1424485640207  loss: 0.8820 (0.8948)  acc1: 75.0000 (77.9627)  acc5: 90.6250 (92.2609)  time: 0.0924  data: 0.0001  max mem: 21530
Epoch: [4]  [ 2000/10010]  eta: 0:12:27  lr: 0.01  img/s: 350.58713760686663  loss: 0.8000 (0.8868)  acc1: 78.1250 (78.0657)  acc5: 90.6250 (92.3288)  time: 0.0915  data: 0.0001  max mem: 21530
Epoch: [4]  [ 3000/10010]  eta: 0:10:50  lr: 0.01  img/s: 354.0626835039662  loss: 1.0897 (0.8863)  acc1: 71.8750 (78.0844)  acc5: 90.6250 (92.3786)  time: 0.0914  data: 0.0001  max mem: 21530
Epoch: [4]  [ 4000/10010]  eta: 0:09:16  lr: 0.01  img/s: 355.7000641341623  loss: 0.9122 (0.8862)  acc1: 75.0000 (78.1133)  acc5: 93.7500 (92.4152)  time: 0.0920  data: 0.0001  max mem: 21530
Epoch: [4]  [ 5000/10010]  eta: 0:07:43  lr: 0.01  img/s: 345.382541700334  loss: 0.8005 (0.8880)  acc1: 75.0000 (78.0963)  acc5: 90.6250 (92.3865)  time: 0.0919  data: 0.0001  max mem: 21530
Epoch: [4]  [ 6000/10010]  eta: 0:06:11  lr: 0.01  img/s: 347.1638955852379  loss: 0.7919 (0.8889)  acc1: 78.1250 (78.0880)  acc5: 93.7500 (92.3742)  time: 0.0919  data: 0.0001  max mem: 21530
Epoch: [4]  [ 7000/10010]  eta: 0:04:38  lr: 0.01  img/s: 349.99381463730094  loss: 0.8045 (0.8889)  acc1: 78.1250 (78.1223)  acc5: 93.7500 (92.3564)  time: 0.0921  data: 0.0001  max mem: 21530
Epoch: [4]  [ 8000/10010]  eta: 0:03:05  lr: 0.01  img/s: 348.0073325986906  loss: 0.7817 (0.8878)  acc1: 78.1250 (78.1203)  acc5: 93.7500 (92.3650)  time: 0.0921  data: 0.0001  max mem: 21530
Epoch: [4]  [ 9000/10010]  eta: 0:01:33  lr: 0.01  img/s: 351.2743870521974  loss: 0.8028 (0.8867)  acc1: 78.1250 (78.1601)  acc5: 93.7500 (92.3717)  time: 0.0922  data: 0.0001  max mem: 21530
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 349.2470271086062  loss: 0.9316 (0.8888)  acc1: 75.0000 (78.1134)  acc5: 90.6250 (92.3517)  time: 0.0894  data: 0.0001  max mem: 21530
Epoch: [4] Total time: 0:15:25
Test:   [  0/391]  eta: 0:11:47  loss: 0.3951 (0.3951)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.8099  data: 1.7407  max mem: 21530
Test:   [100/391]  eta: 0:00:26  loss: 0.6644 (0.6909)  acc1: 81.2500 (82.1163)  acc5: 96.8750 (95.9777)  time: 0.0650  data: 0.0237  max mem: 21530
Test:   [200/391]  eta: 0:00:15  loss: 1.2328 (0.7910)  acc1: 68.7500 (79.5553)  acc5: 90.6250 (94.9471)  time: 0.0428  data: 0.0058  max mem: 21530
Test:   [300/391]  eta: 0:00:07  loss: 1.2373 (0.9188)  acc1: 68.7500 (76.9726)  acc5: 87.5000 (93.4489)  time: 0.0657  data: 0.0206  max mem: 21530
Test:  Total time: 0:00:28
Test:  Acc@1 76.284 Acc@5 92.958
Number of added parameters: 1064976
Training time 1:15:12
Experiment with model=resnet50, n_components=16, and dof=32 completed
-----------------------------------
Running experiment with n_components=32 and dof=4
[2024-11-15 00:05:25,724] torch.distributed.run: [WARNING] 
[2024-11-15 00:05:25,724] torch.distributed.run: [WARNING] *****************************************
[2024-11-15 00:05:25,724] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-15 00:05:25,724] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 3): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=32, dof=4, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.5667071342468262
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 294944
Start training
Epoch: [0]  [    0/10010]  eta: 13:31:09  lr: 0.01  img/s: 10.229417978030082  loss: 0.8901 (0.8901)  acc1: 78.1250 (78.1250)  acc5: 90.6250 (90.6250)  time: 4.8621  data: 1.7338  max mem: 21515
Epoch: [0]  [ 1000/10010]  eta: 0:12:49  lr: 0.01  img/s: 396.57995851529677  loss: 0.7575 (0.8955)  acc1: 81.2500 (78.0657)  acc5: 93.7500 (92.1422)  time: 0.0809  data: 0.0001  max mem: 21515
Epoch: [0]  [ 2000/10010]  eta: 0:11:05  lr: 0.01  img/s: 387.03441036953734  loss: 0.7733 (0.8936)  acc1: 81.2500 (78.0407)  acc5: 96.8750 (92.1524)  time: 0.0816  data: 0.0001  max mem: 21515
Epoch: [0]  [ 3000/10010]  eta: 0:09:36  lr: 0.01  img/s: 400.25803988930244  loss: 0.8535 (0.8951)  acc1: 75.0000 (77.9376)  acc5: 90.6250 (92.1537)  time: 0.0802  data: 0.0001  max mem: 21515
Epoch: [0]  [ 4000/10010]  eta: 0:08:12  lr: 0.01  img/s: 403.61135736237827  loss: 0.7652 (0.8905)  acc1: 78.1250 (77.9860)  acc5: 93.7500 (92.2387)  time: 0.0807  data: 0.0001  max mem: 21515
Epoch: [0]  [ 5000/10010]  eta: 0:06:49  lr: 0.01  img/s: 396.5553523469608  loss: 0.9681 (0.8907)  acc1: 75.0000 (78.0400)  acc5: 90.6250 (92.2478)  time: 0.0811  data: 0.0001  max mem: 21515
Epoch: [0]  [ 6000/10010]  eta: 0:05:26  lr: 0.01  img/s: 396.45227398263756  loss: 0.9749 (0.8915)  acc1: 71.8750 (78.0604)  acc5: 90.6250 (92.2586)  time: 0.0805  data: 0.0001  max mem: 21515
Epoch: [0]  [ 7000/10010]  eta: 0:04:04  lr: 0.01  img/s: 399.19495807816884  loss: 0.8408 (0.8917)  acc1: 78.1250 (78.0821)  acc5: 93.7500 (92.2676)  time: 0.0808  data: 0.0002  max mem: 21515
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 394.4540618699708  loss: 0.8785 (0.8910)  acc1: 78.1250 (78.1020)  acc5: 93.7500 (92.2728)  time: 0.0803  data: 0.0001  max mem: 21515
Epoch: [0]  [ 9000/10010]  eta: 0:01:21  lr: 0.01  img/s: 402.55455813325733  loss: 0.9639 (0.8911)  acc1: 78.1250 (78.1146)  acc5: 90.6250 (92.2582)  time: 0.0803  data: 0.0001  max mem: 21515
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 423.3890879725433  loss: 0.9079 (0.8907)  acc1: 78.1250 (78.1234)  acc5: 93.7500 (92.2595)  time: 0.0791  data: 0.0001  max mem: 21515
Epoch: [0] Total time: 0:13:33
Test:   [  0/391]  eta: 0:13:50  loss: 0.4034 (0.4034)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 2.1245  data: 1.9712  max mem: 21515
Test:   [100/391]  eta: 0:00:26  loss: 0.6424 (0.6905)  acc1: 81.2500 (81.8998)  acc5: 96.8750 (95.9468)  time: 0.0683  data: 0.0320  max mem: 21515
Test:   [200/391]  eta: 0:00:15  loss: 1.2551 (0.7928)  acc1: 68.7500 (79.2910)  acc5: 87.5000 (94.9316)  time: 0.0523  data: 0.0203  max mem: 21515
Test:   [300/391]  eta: 0:00:07  loss: 1.2538 (0.9207)  acc1: 68.7500 (76.7650)  acc5: 87.5000 (93.4178)  time: 0.0556  data: 0.0203  max mem: 21515
Test:  Total time: 0:00:28
Test:  Acc@1 76.216 Acc@5 92.976
Number of added parameters: 294944
Epoch: [1]  [    0/10010]  eta: 4:56:18  lr: 0.01  img/s: 78.3420574156256  loss: 0.5857 (0.5857)  acc1: 87.5000 (87.5000)  acc5: 93.7500 (93.7500)  time: 1.7760  data: 1.3676  max mem: 21515
Epoch: [1]  [ 1000/10010]  eta: 0:12:37  lr: 0.01  img/s: 392.4391697294516  loss: 0.7848 (0.8927)  acc1: 78.1250 (78.1656)  acc5: 93.7500 (92.3608)  time: 0.0823  data: 0.0001  max mem: 21515
Epoch: [1]  [ 2000/10010]  eta: 0:11:05  lr: 0.01  img/s: 389.93204109143306  loss: 0.9018 (0.8943)  acc1: 78.1250 (78.0922)  acc5: 90.6250 (92.3288)  time: 0.0819  data: 0.0001  max mem: 21515
Epoch: [1]  [ 3000/10010]  eta: 0:09:40  lr: 0.01  img/s: 392.5378754865862  loss: 0.7825 (0.8935)  acc1: 78.1250 (78.0813)  acc5: 93.7500 (92.3484)  time: 0.0818  data: 0.0001  max mem: 21515
Epoch: [1]  [ 4000/10010]  eta: 0:08:16  lr: 0.01  img/s: 387.3952352638962  loss: 0.9011 (0.8933)  acc1: 75.0000 (78.0516)  acc5: 90.6250 (92.2949)  time: 0.0826  data: 0.0001  max mem: 21515
Epoch: [1]  [ 5000/10010]  eta: 0:06:53  lr: 0.01  img/s: 397.4219192765626  loss: 0.8559 (0.8914)  acc1: 78.1250 (78.1100)  acc5: 93.7500 (92.2984)  time: 0.0817  data: 0.0001  max mem: 21515
Epoch: [1]  [ 6000/10010]  eta: 0:05:30  lr: 0.01  img/s: 397.92031971728267  loss: 0.8331 (0.8894)  acc1: 75.0000 (78.1812)  acc5: 90.6250 (92.3294)  time: 0.0818  data: 0.0001  max mem: 21515
Epoch: [1]  [ 7000/10010]  eta: 0:04:08  lr: 0.01  img/s: 394.70578305812467  loss: 0.8823 (0.8889)  acc1: 75.0000 (78.1612)  acc5: 90.6250 (92.3332)  time: 0.0816  data: 0.0001  max mem: 21515
Epoch: [1]  [ 8000/10010]  eta: 0:02:45  lr: 0.01  img/s: 393.3489089086742  loss: 0.8589 (0.8893)  acc1: 78.1250 (78.1602)  acc5: 90.6250 (92.3221)  time: 0.0822  data: 0.0001  max mem: 21515
Epoch: [1]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 392.4793346862627  loss: 0.9296 (0.8904)  acc1: 75.0000 (78.1503)  acc5: 90.6250 (92.2939)  time: 0.0824  data: 0.0001  max mem: 21515
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 405.83370272828154  loss: 0.8268 (0.8901)  acc1: 78.1250 (78.1603)  acc5: 90.6250 (92.3101)  time: 0.0800  data: 0.0001  max mem: 21515
Epoch: [1] Total time: 0:13:44
Test:   [  0/391]  eta: 0:09:40  loss: 0.4144 (0.4144)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4859  data: 1.4546  max mem: 21515
Test:   [100/391]  eta: 0:00:25  loss: 0.6460 (0.6937)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.8230)  time: 0.0637  data: 0.0283  max mem: 21515
Test:   [200/391]  eta: 0:00:15  loss: 1.2064 (0.7932)  acc1: 65.6250 (79.3843)  acc5: 87.5000 (94.8539)  time: 0.0774  data: 0.0403  max mem: 21515
Test:   [300/391]  eta: 0:00:07  loss: 1.2963 (0.9201)  acc1: 68.7500 (76.8584)  acc5: 87.5000 (93.3970)  time: 0.0776  data: 0.0448  max mem: 21515
Test:  Total time: 0:00:28
Test:  Acc@1 76.252 Acc@5 92.944
Number of added parameters: 294944
Epoch: [2]  [    0/10010]  eta: 6:29:07  lr: 0.01  img/s: 58.03241949389616  loss: 1.5502 (1.5502)  acc1: 68.7500 (68.7500)  acc5: 81.2500 (81.2500)  time: 2.3324  data: 1.7810  max mem: 21515
Epoch: [2]  [ 1000/10010]  eta: 0:12:54  lr: 0.01  img/s: 385.1706723525884  loss: 0.8571 (0.8775)  acc1: 78.1250 (78.2592)  acc5: 90.6250 (92.5075)  time: 0.0833  data: 0.0001  max mem: 21515
Epoch: [2]  [ 2000/10010]  eta: 0:11:19  lr: 0.01  img/s: 364.453698499203  loss: 0.8776 (0.8861)  acc1: 78.1250 (77.9938)  acc5: 90.6250 (92.3882)  time: 0.0839  data: 0.0001  max mem: 21515
Epoch: [2]  [ 3000/10010]  eta: 0:09:51  lr: 0.01  img/s: 384.9166114605111  loss: 0.8493 (0.8831)  acc1: 81.2500 (78.1979)  acc5: 93.7500 (92.3942)  time: 0.0830  data: 0.0002  max mem: 21515
Epoch: [2]  [ 4000/10010]  eta: 0:08:26  lr: 0.01  img/s: 384.4942877768738  loss: 0.9018 (0.8886)  acc1: 78.1250 (78.0672)  acc5: 90.6250 (92.3035)  time: 0.0842  data: 0.0001  max mem: 21515
Epoch: [2]  [ 5000/10010]  eta: 0:07:01  lr: 0.01  img/s: 385.1463563711494  loss: 0.8805 (0.8892)  acc1: 81.2500 (78.0494)  acc5: 93.7500 (92.3097)  time: 0.0838  data: 0.0001  max mem: 21515
Epoch: [2]  [ 6000/10010]  eta: 0:05:37  lr: 0.01  img/s: 384.24881834760475  loss: 0.8514 (0.8884)  acc1: 78.1250 (78.1000)  acc5: 93.7500 (92.3054)  time: 0.0835  data: 0.0001  max mem: 21515
Epoch: [2]  [ 7000/10010]  eta: 0:04:12  lr: 0.01  img/s: 391.8468320653031  loss: 0.7839 (0.8913)  acc1: 81.2500 (78.0594)  acc5: 93.7500 (92.2560)  time: 0.0839  data: 0.0001  max mem: 21515
Epoch: [2]  [ 8000/10010]  eta: 0:02:48  lr: 0.01  img/s: 381.1411938764209  loss: 0.6641 (0.8922)  acc1: 84.3750 (78.0387)  acc5: 93.7500 (92.2443)  time: 0.0838  data: 0.0001  max mem: 21515
Epoch: [2]  [ 9000/10010]  eta: 0:01:24  lr: 0.01  img/s: 383.07425864086537  loss: 0.7299 (0.8930)  acc1: 84.3750 (78.0396)  acc5: 93.7500 (92.2325)  time: 0.0838  data: 0.0001  max mem: 21515
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 393.34429784714933  loss: 0.8442 (0.8948)  acc1: 78.1250 (78.0328)  acc5: 93.7500 (92.2177)  time: 0.0820  data: 0.0001  max mem: 21515
Epoch: [2] Total time: 0:14:00
Test:   [  0/391]  eta: 0:10:49  loss: 0.4225 (0.4225)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6600  data: 1.6077  max mem: 21515
Test:   [100/391]  eta: 0:00:25  loss: 0.6513 (0.6933)  acc1: 81.2500 (81.8069)  acc5: 96.8750 (95.9468)  time: 0.0631  data: 0.0273  max mem: 21515
Test:   [200/391]  eta: 0:00:14  loss: 1.2073 (0.7919)  acc1: 68.7500 (79.3688)  acc5: 87.5000 (94.9627)  time: 0.0548  data: 0.0187  max mem: 21515
Test:   [300/391]  eta: 0:00:06  loss: 1.2550 (0.9198)  acc1: 68.7500 (76.7961)  acc5: 87.5000 (93.4489)  time: 0.0683  data: 0.0310  max mem: 21515
Test:  Total time: 0:00:27
Test:  Acc@1 76.252 Acc@5 92.978
Number of added parameters: 294944
Epoch: [3]  [    0/10010]  eta: 4:49:16  lr: 0.01  img/s: 83.37395547847348  loss: 0.8822 (0.8822)  acc1: 81.2500 (81.2500)  acc5: 84.3750 (84.3750)  time: 1.7339  data: 1.3500  max mem: 21515
Epoch: [3]  [ 1000/10010]  eta: 0:13:05  lr: 0.01  img/s: 372.2644892162954  loss: 0.8677 (0.8869)  acc1: 75.0000 (78.1063)  acc5: 93.7500 (92.3795)  time: 0.0848  data: 0.0001  max mem: 21515
Epoch: [3]  [ 2000/10010]  eta: 0:11:30  lr: 0.01  img/s: 378.05041884256366  loss: 0.9241 (0.8842)  acc1: 78.1250 (78.1109)  acc5: 93.7500 (92.3523)  time: 0.0855  data: 0.0001  max mem: 21515
Epoch: [3]  [ 3000/10010]  eta: 0:10:01  lr: 0.01  img/s: 378.982326847436  loss: 0.7559 (0.8888)  acc1: 81.2500 (78.1000)  acc5: 93.7500 (92.3046)  time: 0.0861  data: 0.0001  max mem: 21515
Epoch: [3]  [ 4000/10010]  eta: 0:08:34  lr: 0.01  img/s: 384.31593354675033  loss: 0.8296 (0.8916)  acc1: 78.1250 (77.9993)  acc5: 93.7500 (92.2519)  time: 0.0848  data: 0.0001  max mem: 21515
Epoch: [3]  [ 5000/10010]  eta: 0:07:08  lr: 0.01  img/s: 377.62920697086844  loss: 0.9356 (0.8950)  acc1: 78.1250 (78.0006)  acc5: 90.6250 (92.2241)  time: 0.0858  data: 0.0001  max mem: 21515
Epoch: [3]  [ 6000/10010]  eta: 0:05:42  lr: 0.01  img/s: 378.61349852467436  loss: 0.8635 (0.8944)  acc1: 75.0000 (78.0328)  acc5: 90.6250 (92.2112)  time: 0.0849  data: 0.0001  max mem: 21515
Epoch: [3]  [ 7000/10010]  eta: 0:04:17  lr: 0.01  img/s: 373.22409118590053  loss: 0.7533 (0.8943)  acc1: 78.1250 (78.0563)  acc5: 93.7500 (92.2292)  time: 0.0851  data: 0.0001  max mem: 21515
Epoch: [3]  [ 8000/10010]  eta: 0:02:51  lr: 0.01  img/s: 384.8890163398505  loss: 0.7761 (0.8933)  acc1: 81.2500 (78.0633)  acc5: 93.7500 (92.2572)  time: 0.0848  data: 0.0001  max mem: 21515
Epoch: [3]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 369.4781136531934  loss: 0.8511 (0.8922)  acc1: 78.1250 (78.0691)  acc5: 90.6250 (92.2613)  time: 0.0850  data: 0.0001  max mem: 21515
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 379.11399598904046  loss: 0.8704 (0.8921)  acc1: 75.0000 (78.0722)  acc5: 90.6250 (92.2636)  time: 0.0831  data: 0.0001  max mem: 21515
Epoch: [3] Total time: 0:14:14
Test:   [  0/391]  eta: 0:09:30  loss: 0.3977 (0.3977)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4599  data: 1.3990  max mem: 21515
Test:   [100/391]  eta: 0:00:25  loss: 0.6502 (0.6931)  acc1: 81.2500 (81.9616)  acc5: 96.8750 (95.9158)  time: 0.0693  data: 0.0287  max mem: 21515
Test:   [200/391]  eta: 0:00:15  loss: 1.1733 (0.7900)  acc1: 68.7500 (79.4154)  acc5: 87.5000 (94.9627)  time: 0.0696  data: 0.0335  max mem: 21515
Test:   [300/391]  eta: 0:00:06  loss: 1.2865 (0.9195)  acc1: 68.7500 (76.8065)  acc5: 87.5000 (93.4593)  time: 0.0638  data: 0.0285  max mem: 21515
Test:  Total time: 0:00:28
Test:  Acc@1 76.298 Acc@5 92.956
Number of added parameters: 294944
Epoch: [4]  [    0/10010]  eta: 5:06:38  lr: 0.01  img/s: 175.3228780504372  loss: 0.7006 (0.7006)  acc1: 78.1250 (78.1250)  acc5: 93.7500 (93.7500)  time: 1.8380  data: 1.6554  max mem: 21515
Epoch: [4]  [ 1000/10010]  eta: 0:13:17  lr: 0.01  img/s: 369.2148700766391  loss: 0.8724 (0.8986)  acc1: 78.1250 (78.1312)  acc5: 90.6250 (92.1766)  time: 0.0871  data: 0.0001  max mem: 21515
Epoch: [4]  [ 2000/10010]  eta: 0:11:41  lr: 0.01  img/s: 372.42563015416715  loss: 0.8585 (0.8962)  acc1: 78.1250 (78.1219)  acc5: 93.7500 (92.1930)  time: 0.0863  data: 0.0001  max mem: 21515
Epoch: [4]  [ 3000/10010]  eta: 0:10:11  lr: 0.01  img/s: 373.10270366437425  loss: 0.8566 (0.8917)  acc1: 78.1250 (78.1625)  acc5: 93.7500 (92.2390)  time: 0.0861  data: 0.0001  max mem: 21515
Epoch: [4]  [ 4000/10010]  eta: 0:08:42  lr: 0.01  img/s: 355.6208977844194  loss: 0.7654 (0.8892)  acc1: 78.1250 (78.2133)  acc5: 93.7500 (92.2660)  time: 0.0861  data: 0.0001  max mem: 21515
Epoch: [4]  [ 5000/10010]  eta: 0:07:15  lr: 0.01  img/s: 380.13942646746443  loss: 0.8301 (0.8902)  acc1: 78.1250 (78.1575)  acc5: 90.6250 (92.2740)  time: 0.0865  data: 0.0001  max mem: 21515
Epoch: [4]  [ 6000/10010]  eta: 0:05:48  lr: 0.01  img/s: 375.1078865658127  loss: 0.7723 (0.8905)  acc1: 78.1250 (78.1620)  acc5: 93.7500 (92.2680)  time: 0.0863  data: 0.0001  max mem: 21515
Epoch: [4]  [ 7000/10010]  eta: 0:04:21  lr: 0.01  img/s: 373.77807978077556  loss: 0.7569 (0.8897)  acc1: 81.2500 (78.1620)  acc5: 93.7500 (92.2609)  time: 0.0861  data: 0.0001  max mem: 21515
Epoch: [4]  [ 8000/10010]  eta: 0:02:54  lr: 0.01  img/s: 373.82388591800355  loss: 0.7675 (0.8900)  acc1: 78.1250 (78.1285)  acc5: 93.7500 (92.2502)  time: 0.0862  data: 0.0001  max mem: 21515
Epoch: [4]  [ 9000/10010]  eta: 0:01:27  lr: 0.01  img/s: 376.82979201293745  loss: 0.9694 (0.8891)  acc1: 78.1250 (78.1215)  acc5: 90.6250 (92.2724)  time: 0.0860  data: 0.0001  max mem: 21515
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 385.16514572356715  loss: 1.0047 (0.8907)  acc1: 75.0000 (78.0969)  acc5: 90.6250 (92.2720)  time: 0.0855  data: 0.0001  max mem: 21515
Epoch: [4] Total time: 0:14:27
Test:   [  0/391]  eta: 0:08:44  loss: 0.3698 (0.3698)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3403  data: 1.3071  max mem: 21515
Test:   [100/391]  eta: 0:00:26  loss: 0.6503 (0.6920)  acc1: 81.2500 (82.0235)  acc5: 96.8750 (95.9468)  time: 0.0498  data: 0.0156  max mem: 21515
Test:   [200/391]  eta: 0:00:15  loss: 1.2456 (0.7903)  acc1: 68.7500 (79.4621)  acc5: 90.6250 (94.9471)  time: 0.0554  data: 0.0157  max mem: 21515
Test:   [300/391]  eta: 0:00:07  loss: 1.2129 (0.9203)  acc1: 68.7500 (76.7961)  acc5: 87.5000 (93.4178)  time: 0.0703  data: 0.0323  max mem: 21515
Test:  Total time: 0:00:28
Test:  Acc@1 76.218 Acc@5 92.940
Number of added parameters: 294944
Training time 1:12:25
Experiment with model=resnet50, n_components=32, and dof=4 completed
-----------------------------------
Running experiment with n_components=32 and dof=8
[2024-11-15 01:18:04,831] torch.distributed.run: [WARNING] 
[2024-11-15 01:18:04,831] torch.distributed.run: [WARNING] *****************************************
[2024-11-15 01:18:04,831] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-15 01:18:04,831] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=32, dof=8, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.6133668422698975
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 557088
Start training
Epoch: [0]  [    0/10010]  eta: 13:50:57  lr: 0.01  img/s: 10.905931458042573  loss: 0.9034 (0.9034)  acc1: 75.0000 (75.0000)  acc5: 93.7500 (93.7500)  time: 4.9808  data: 2.0465  max mem: 21519
Epoch: [0]  [ 1000/10010]  eta: 0:12:52  lr: 0.01  img/s: 397.1432189798732  loss: 0.8604 (0.8952)  acc1: 78.1250 (77.9783)  acc5: 90.6250 (92.2827)  time: 0.0809  data: 0.0002  max mem: 21519
Epoch: [0]  [ 2000/10010]  eta: 0:11:08  lr: 0.01  img/s: 379.13648523060147  loss: 0.9803 (0.8986)  acc1: 78.1250 (77.8455)  acc5: 90.6250 (92.1961)  time: 0.0818  data: 0.0001  max mem: 21519
Epoch: [0]  [ 3000/10010]  eta: 0:09:39  lr: 0.01  img/s: 400.07430502977803  loss: 0.8756 (0.8998)  acc1: 78.1250 (77.8470)  acc5: 93.7500 (92.1464)  time: 0.0812  data: 0.0001  max mem: 21519
Epoch: [0]  [ 4000/10010]  eta: 0:08:14  lr: 0.01  img/s: 401.39521140744904  loss: 0.9031 (0.8950)  acc1: 78.1250 (77.9461)  acc5: 90.6250 (92.1988)  time: 0.0818  data: 0.0001  max mem: 21519
Epoch: [0]  [ 5000/10010]  eta: 0:06:50  lr: 0.01  img/s: 400.0623800269455  loss: 0.8043 (0.8972)  acc1: 78.1250 (77.9182)  acc5: 93.7500 (92.1622)  time: 0.0819  data: 0.0002  max mem: 21519
Epoch: [0]  [ 6000/10010]  eta: 0:05:27  lr: 0.01  img/s: 399.8204560687529  loss: 0.9299 (0.8955)  acc1: 78.1250 (77.9214)  acc5: 93.7500 (92.2206)  time: 0.0800  data: 0.0001  max mem: 21519
Epoch: [0]  [ 7000/10010]  eta: 0:04:05  lr: 0.01  img/s: 397.7304739242397  loss: 0.8530 (0.8930)  acc1: 75.0000 (77.9969)  acc5: 90.6250 (92.2649)  time: 0.0803  data: 0.0001  max mem: 21519
Epoch: [0]  [ 8000/10010]  eta: 0:02:43  lr: 0.01  img/s: 401.366403310985  loss: 0.9801 (0.8924)  acc1: 78.1250 (78.0449)  acc5: 90.6250 (92.2803)  time: 0.0800  data: 0.0001  max mem: 21519
Epoch: [0]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 395.51998114013765  loss: 0.7731 (0.8907)  acc1: 78.1250 (78.0778)  acc5: 93.7500 (92.2929)  time: 0.0810  data: 0.0001  max mem: 21519
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 401.99270997750693  loss: 0.7664 (0.8907)  acc1: 78.1250 (78.0850)  acc5: 93.7500 (92.2711)  time: 0.0787  data: 0.0001  max mem: 21519
Epoch: [0] Total time: 0:13:34
Test:   [  0/391]  eta: 0:09:55  loss: 0.4028 (0.4028)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5235  data: 1.2977  max mem: 21519
Test:   [100/391]  eta: 0:00:26  loss: 0.6428 (0.6909)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.9158)  time: 0.0724  data: 0.0409  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.2035 (0.7920)  acc1: 68.7500 (79.3999)  acc5: 87.5000 (94.9160)  time: 0.0672  data: 0.0348  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2686 (0.9204)  acc1: 68.7500 (76.8272)  acc5: 87.5000 (93.5008)  time: 0.0400  data: 0.0088  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.246 Acc@5 92.976
Number of added parameters: 557088
Epoch: [1]  [    0/10010]  eta: 5:34:22  lr: 0.01  img/s: 35.97624487634062  loss: 0.6281 (0.6281)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 2.0042  data: 1.1147  max mem: 21519
Epoch: [1]  [ 1000/10010]  eta: 0:12:38  lr: 0.01  img/s: 389.98075922885823  loss: 0.8665 (0.8808)  acc1: 71.8750 (78.2062)  acc5: 90.6250 (92.3733)  time: 0.0822  data: 0.0001  max mem: 21519
Epoch: [1]  [ 2000/10010]  eta: 0:11:07  lr: 0.01  img/s: 390.9656566598116  loss: 0.8542 (0.8849)  acc1: 78.1250 (78.1656)  acc5: 93.7500 (92.3944)  time: 0.0824  data: 0.0001  max mem: 21519
Epoch: [1]  [ 3000/10010]  eta: 0:09:41  lr: 0.01  img/s: 391.7187468990596  loss: 0.9134 (0.8852)  acc1: 78.1250 (78.2895)  acc5: 90.6250 (92.3744)  time: 0.0825  data: 0.0001  max mem: 21519
Epoch: [1]  [ 4000/10010]  eta: 0:08:17  lr: 0.01  img/s: 384.1619334932366  loss: 0.9392 (0.8871)  acc1: 78.1250 (78.2289)  acc5: 90.6250 (92.3480)  time: 0.0825  data: 0.0001  max mem: 21519
Epoch: [1]  [ 5000/10010]  eta: 0:06:54  lr: 0.01  img/s: 394.6721243023577  loss: 0.9933 (0.8880)  acc1: 75.0000 (78.1894)  acc5: 93.7500 (92.3697)  time: 0.0822  data: 0.0001  max mem: 21519
Epoch: [1]  [ 6000/10010]  eta: 0:05:31  lr: 0.01  img/s: 391.9772905155193  loss: 0.8502 (0.8873)  acc1: 81.2500 (78.1406)  acc5: 93.7500 (92.3851)  time: 0.0821  data: 0.0001  max mem: 21519
Epoch: [1]  [ 7000/10010]  eta: 0:04:08  lr: 0.01  img/s: 386.2414006451854  loss: 0.7723 (0.8865)  acc1: 78.1250 (78.1665)  acc5: 96.8750 (92.3881)  time: 0.0821  data: 0.0001  max mem: 21519
Epoch: [1]  [ 8000/10010]  eta: 0:02:46  lr: 0.01  img/s: 386.7355360708595  loss: 1.0625 (0.8885)  acc1: 78.1250 (78.1172)  acc5: 90.6250 (92.3541)  time: 0.0823  data: 0.0001  max mem: 21519
Epoch: [1]  [ 9000/10010]  eta: 0:01:23  lr: 0.01  img/s: 393.3454506023955  loss: 0.9789 (0.8903)  acc1: 71.8750 (78.0899)  acc5: 90.6250 (92.3193)  time: 0.0819  data: 0.0001  max mem: 21519
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 405.6926332079943  loss: 0.8250 (0.8899)  acc1: 81.2500 (78.0900)  acc5: 90.6250 (92.3158)  time: 0.0804  data: 0.0001  max mem: 21519
Epoch: [1] Total time: 0:13:46
Test:   [  0/391]  eta: 0:10:07  loss: 0.4007 (0.4007)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5545  data: 1.5144  max mem: 21519
Test:   [100/391]  eta: 0:00:25  loss: 0.6488 (0.6929)  acc1: 81.2500 (81.9926)  acc5: 96.8750 (95.8540)  time: 0.0860  data: 0.0494  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1560 (0.7935)  acc1: 68.7500 (79.4310)  acc5: 87.5000 (94.8850)  time: 0.0759  data: 0.0366  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2778 (0.9207)  acc1: 68.7500 (76.8999)  acc5: 87.5000 (93.3762)  time: 0.0538  data: 0.0129  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.280 Acc@5 92.922
Number of added parameters: 557088
Epoch: [2]  [    0/10010]  eta: 6:39:17  lr: 0.01  img/s: 62.172694042817525  loss: 0.7759 (0.7759)  acc1: 78.1250 (78.1250)  acc5: 96.8750 (96.8750)  time: 2.3933  data: 1.8786  max mem: 21519
Epoch: [2]  [ 1000/10010]  eta: 0:12:58  lr: 0.01  img/s: 378.1622614610012  loss: 0.7441 (0.8728)  acc1: 81.2500 (78.4247)  acc5: 93.7500 (92.5949)  time: 0.0839  data: 0.0001  max mem: 21519
Epoch: [2]  [ 2000/10010]  eta: 0:11:23  lr: 0.01  img/s: 377.9184232014642  loss: 0.7967 (0.8765)  acc1: 78.1250 (78.2749)  acc5: 90.6250 (92.5928)  time: 0.0843  data: 0.0001  max mem: 21519
Epoch: [2]  [ 3000/10010]  eta: 0:09:55  lr: 0.01  img/s: 377.173952019244  loss: 0.7684 (0.8763)  acc1: 81.2500 (78.3416)  acc5: 93.7500 (92.5546)  time: 0.0840  data: 0.0001  max mem: 21519
Epoch: [2]  [ 4000/10010]  eta: 0:08:29  lr: 0.01  img/s: 370.7948603901396  loss: 0.7777 (0.8789)  acc1: 81.2500 (78.2828)  acc5: 93.7500 (92.5198)  time: 0.0847  data: 0.0001  max mem: 21519
Epoch: [2]  [ 5000/10010]  eta: 0:07:04  lr: 0.01  img/s: 379.9683156208066  loss: 0.8995 (0.8821)  acc1: 75.0000 (78.2437)  acc5: 93.7500 (92.4659)  time: 0.0845  data: 0.0001  max mem: 21519
Epoch: [2]  [ 6000/10010]  eta: 0:05:39  lr: 0.01  img/s: 385.585622026614  loss: 0.9467 (0.8811)  acc1: 78.1250 (78.2703)  acc5: 90.6250 (92.4648)  time: 0.0840  data: 0.0001  max mem: 21519
Epoch: [2]  [ 7000/10010]  eta: 0:04:14  lr: 0.01  img/s: 381.22888322075977  loss: 0.7759 (0.8828)  acc1: 78.1250 (78.2803)  acc5: 93.7500 (92.4221)  time: 0.0846  data: 0.0001  max mem: 21519
Epoch: [2]  [ 8000/10010]  eta: 0:02:49  lr: 0.01  img/s: 388.64486836466403  loss: 0.7752 (0.8846)  acc1: 81.2500 (78.2297)  acc5: 93.7500 (92.3970)  time: 0.0845  data: 0.0001  max mem: 21519
Epoch: [2]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 388.5267402512064  loss: 0.8212 (0.8860)  acc1: 78.1250 (78.1962)  acc5: 93.7500 (92.3786)  time: 0.0843  data: 0.0001  max mem: 21519
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 377.5707795441055  loss: 0.8330 (0.8877)  acc1: 81.2500 (78.1556)  acc5: 93.7500 (92.3348)  time: 0.0826  data: 0.0001  max mem: 21519
Epoch: [2] Total time: 0:14:05
Test:   [  0/391]  eta: 0:12:10  loss: 0.4116 (0.4116)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.8671  data: 1.8269  max mem: 21519
Test:   [100/391]  eta: 0:00:27  loss: 0.6499 (0.6902)  acc1: 81.2500 (81.7141)  acc5: 96.8750 (95.9158)  time: 0.0649  data: 0.0274  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1950 (0.7893)  acc1: 68.7500 (79.3221)  acc5: 90.6250 (94.9782)  time: 0.0491  data: 0.0137  max mem: 21519
Test:   [300/391]  eta: 0:00:07  loss: 1.2282 (0.9178)  acc1: 68.7500 (76.8065)  acc5: 90.6250 (93.5112)  time: 0.0758  data: 0.0345  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.290 Acc@5 92.976
Number of added parameters: 557088
Epoch: [3]  [    0/10010]  eta: 5:08:24  lr: 0.01  img/s: 77.64511152056137  loss: 0.6805 (0.6805)  acc1: 81.2500 (81.2500)  acc5: 96.8750 (96.8750)  time: 1.8486  data: 1.4365  max mem: 21519
Epoch: [3]  [ 1000/10010]  eta: 0:13:10  lr: 0.01  img/s: 370.31709524335065  loss: 0.8487 (0.8955)  acc1: 78.1250 (77.7597)  acc5: 90.6250 (92.3389)  time: 0.0860  data: 0.0001  max mem: 21519
Epoch: [3]  [ 2000/10010]  eta: 0:11:35  lr: 0.01  img/s: 376.2319211082519  loss: 0.8521 (0.8932)  acc1: 75.0000 (77.8423)  acc5: 93.7500 (92.2570)  time: 0.0859  data: 0.0001  max mem: 21519
Epoch: [3]  [ 3000/10010]  eta: 0:10:06  lr: 0.01  img/s: 373.7395696715035  loss: 0.8173 (0.8989)  acc1: 81.2500 (77.8126)  acc5: 93.7500 (92.1995)  time: 0.0861  data: 0.0001  max mem: 21519
Epoch: [3]  [ 4000/10010]  eta: 0:08:38  lr: 0.01  img/s: 374.8920526120268  loss: 0.8166 (0.9004)  acc1: 78.1250 (77.7923)  acc5: 93.7500 (92.1504)  time: 0.0855  data: 0.0001  max mem: 21519
Epoch: [3]  [ 5000/10010]  eta: 0:07:12  lr: 0.01  img/s: 373.14315739723935  loss: 0.8631 (0.8996)  acc1: 78.1250 (77.7994)  acc5: 93.7500 (92.1759)  time: 0.0862  data: 0.0002  max mem: 21519
Epoch: [3]  [ 6000/10010]  eta: 0:05:45  lr: 0.01  img/s: 376.6584759413815  loss: 0.8839 (0.8978)  acc1: 75.0000 (77.8589)  acc5: 93.7500 (92.1893)  time: 0.0858  data: 0.0001  max mem: 21519
Epoch: [3]  [ 7000/10010]  eta: 0:04:19  lr: 0.01  img/s: 377.41470766877376  loss: 0.8389 (0.8958)  acc1: 81.2500 (77.9228)  acc5: 93.7500 (92.1971)  time: 0.0859  data: 0.0001  max mem: 21519
Epoch: [3]  [ 8000/10010]  eta: 0:02:53  lr: 0.01  img/s: 373.55545536017456  loss: 0.8001 (0.8953)  acc1: 78.1250 (77.9235)  acc5: 93.7500 (92.2350)  time: 0.0859  data: 0.0001  max mem: 21519
Epoch: [3]  [ 9000/10010]  eta: 0:01:26  lr: 0.01  img/s: 369.8048944459445  loss: 0.8108 (0.8946)  acc1: 78.1250 (77.9420)  acc5: 90.6250 (92.2564)  time: 0.0860  data: 0.0001  max mem: 21519
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 401.96742756856804  loss: 0.8796 (0.8956)  acc1: 78.1250 (77.9131)  acc5: 90.6250 (92.2567)  time: 0.0837  data: 0.0001  max mem: 21519
Epoch: [3] Total time: 0:14:22
Test:   [  0/391]  eta: 0:11:35  loss: 0.3956 (0.3956)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7779  data: 1.7230  max mem: 21519
Test:   [100/391]  eta: 0:00:25  loss: 0.6662 (0.6926)  acc1: 81.2500 (82.1163)  acc5: 96.8750 (95.9158)  time: 0.0701  data: 0.0323  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.1770 (0.7913)  acc1: 68.7500 (79.4776)  acc5: 87.5000 (94.8850)  time: 0.0752  data: 0.0324  max mem: 21519
Test:   [300/391]  eta: 0:00:07  loss: 1.2514 (0.9197)  acc1: 68.7500 (76.8272)  acc5: 87.5000 (93.3762)  time: 0.0640  data: 0.0241  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.212 Acc@5 92.926
Number of added parameters: 557088
Epoch: [4]  [    0/10010]  eta: 5:53:42  lr: 0.01  img/s: 258.6407314981645  loss: 0.7912 (0.7912)  acc1: 71.8750 (71.8750)  acc5: 96.8750 (96.8750)  time: 2.1201  data: 1.9964  max mem: 21519
Epoch: [4]  [ 1000/10010]  eta: 0:13:30  lr: 0.01  img/s: 355.8745429525201  loss: 0.8328 (0.8908)  acc1: 75.0000 (77.8971)  acc5: 93.7500 (92.2390)  time: 0.0879  data: 0.0001  max mem: 21519
Epoch: [4]  [ 2000/10010]  eta: 0:11:52  lr: 0.01  img/s: 364.71118526348397  loss: 0.8525 (0.8942)  acc1: 78.1250 (78.0032)  acc5: 93.7500 (92.1492)  time: 0.0874  data: 0.0001  max mem: 21519
Epoch: [4]  [ 3000/10010]  eta: 0:10:20  lr: 0.01  img/s: 370.1087788575021  loss: 0.9181 (0.8936)  acc1: 75.0000 (77.9823)  acc5: 90.6250 (92.1682)  time: 0.0880  data: 0.0001  max mem: 21519
Epoch: [4]  [ 4000/10010]  eta: 0:08:51  lr: 0.01  img/s: 370.1475651257839  loss: 0.7779 (0.8866)  acc1: 78.1250 (78.1070)  acc5: 93.7500 (92.2769)  time: 0.0880  data: 0.0001  max mem: 21519
Epoch: [4]  [ 5000/10010]  eta: 0:07:22  lr: 0.01  img/s: 357.1805306437448  loss: 0.7368 (0.8863)  acc1: 78.1250 (78.1444)  acc5: 93.7500 (92.3059)  time: 0.0877  data: 0.0001  max mem: 21519
Epoch: [4]  [ 6000/10010]  eta: 0:05:53  lr: 0.01  img/s: 368.53967730952144  loss: 0.7936 (0.8876)  acc1: 81.2500 (78.1526)  acc5: 93.7500 (92.3159)  time: 0.0880  data: 0.0001  max mem: 21519
Epoch: [4]  [ 7000/10010]  eta: 0:04:25  lr: 0.01  img/s: 364.3211357066272  loss: 0.9369 (0.8901)  acc1: 75.0000 (78.1031)  acc5: 90.6250 (92.3056)  time: 0.0876  data: 0.0001  max mem: 21519
Epoch: [4]  [ 8000/10010]  eta: 0:02:57  lr: 0.01  img/s: 375.68431011414594  loss: 0.8495 (0.8894)  acc1: 75.0000 (78.1117)  acc5: 90.6250 (92.2982)  time: 0.0884  data: 0.0001  max mem: 21519
Epoch: [4]  [ 9000/10010]  eta: 0:01:28  lr: 0.01  img/s: 372.9751762505662  loss: 1.0238 (0.8897)  acc1: 78.1250 (78.0889)  acc5: 90.6250 (92.2922)  time: 0.0875  data: 0.0001  max mem: 21519
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 380.53496943647434  loss: 0.7836 (0.8904)  acc1: 78.1250 (78.0659)  acc5: 93.7500 (92.3008)  time: 0.0870  data: 0.0001  max mem: 21519
Epoch: [4] Total time: 0:14:41
Test:   [  0/391]  eta: 0:09:35  loss: 0.3913 (0.3913)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4721  data: 1.4066  max mem: 21519
Test:   [100/391]  eta: 0:00:26  loss: 0.6652 (0.6928)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.8230)  time: 0.0630  data: 0.0228  max mem: 21519
Test:   [200/391]  eta: 0:00:15  loss: 1.2489 (0.7927)  acc1: 68.7500 (79.3843)  acc5: 90.6250 (94.8383)  time: 0.0735  data: 0.0374  max mem: 21519
Test:   [300/391]  eta: 0:00:06  loss: 1.2340 (0.9210)  acc1: 68.7500 (76.8272)  acc5: 87.5000 (93.3659)  time: 0.0572  data: 0.0159  max mem: 21519
Test:  Total time: 0:00:28
Test:  Acc@1 76.192 Acc@5 92.940
Number of added parameters: 557088
Training time 1:12:54
Experiment with model=resnet50, n_components=32, and dof=8 completed
-----------------------------------
Running experiment with n_components=32 and dof=16
[2024-11-15 02:31:13,949] torch.distributed.run: [WARNING] 
[2024-11-15 02:31:13,949] torch.distributed.run: [WARNING] *****************************************
[2024-11-15 02:31:13,949] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-15 02:31:13,949] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
| distributed init (rank 2): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=32, dof=16, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.4006102085113525
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 1081376
Start training
Epoch: [0]  [    0/10010]  eta: 13:34:02  lr: 0.01  img/s: 10.77134539286463  loss: 0.6961 (0.6961)  acc1: 84.3750 (84.3750)  acc5: 93.7500 (93.7500)  time: 4.8794  data: 1.9086  max mem: 21529
Epoch: [0]  [ 1000/10010]  eta: 0:12:58  lr: 0.01  img/s: 388.614485703945  loss: 0.8313 (0.8901)  acc1: 78.1250 (78.4840)  acc5: 93.7500 (92.1641)  time: 0.0816  data: 0.0001  max mem: 21529
Epoch: [0]  [ 2000/10010]  eta: 0:11:13  lr: 0.01  img/s: 382.5272764064286  loss: 0.7727 (0.8970)  acc1: 78.1250 (78.2843)  acc5: 93.7500 (92.1196)  time: 0.0821  data: 0.0001  max mem: 21529
Epoch: [0]  [ 3000/10010]  eta: 0:09:43  lr: 0.01  img/s: 388.4637679481576  loss: 0.8556 (0.8993)  acc1: 81.2500 (78.1302)  acc5: 93.7500 (92.1703)  time: 0.0820  data: 0.0001  max mem: 21529
Epoch: [0]  [ 4000/10010]  eta: 0:08:18  lr: 0.01  img/s: 396.3539309750141  loss: 0.8379 (0.8968)  acc1: 78.1250 (78.1664)  acc5: 93.7500 (92.2051)  time: 0.0822  data: 0.0001  max mem: 21529
Epoch: [0]  [ 5000/10010]  eta: 0:06:53  lr: 0.01  img/s: 397.5384542476497  loss: 0.9309 (0.8954)  acc1: 71.8750 (78.1587)  acc5: 90.6250 (92.2653)  time: 0.0819  data: 0.0001  max mem: 21529
Epoch: [0]  [ 6000/10010]  eta: 0:05:30  lr: 0.01  img/s: 388.0549450231732  loss: 0.8381 (0.8950)  acc1: 78.1250 (78.1521)  acc5: 90.6250 (92.2820)  time: 0.0818  data: 0.0001  max mem: 21529
Epoch: [0]  [ 7000/10010]  eta: 0:04:07  lr: 0.01  img/s: 394.72783845941194  loss: 0.8538 (0.8930)  acc1: 78.1250 (78.1835)  acc5: 90.6250 (92.3042)  time: 0.0820  data: 0.0001  max mem: 21529
Epoch: [0]  [ 8000/10010]  eta: 0:02:45  lr: 0.01  img/s: 375.65171441925816  loss: 0.9940 (0.8939)  acc1: 75.0000 (78.1734)  acc5: 90.6250 (92.2892)  time: 0.0813  data: 0.0001  max mem: 21529
Epoch: [0]  [ 9000/10010]  eta: 0:01:22  lr: 0.01  img/s: 395.0589655060767  loss: 0.7904 (0.8912)  acc1: 78.1250 (78.2090)  acc5: 93.7500 (92.3359)  time: 0.0815  data: 0.0001  max mem: 21529
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 414.3878182368306  loss: 0.7693 (0.8899)  acc1: 78.1250 (78.2222)  acc5: 93.7500 (92.3520)  time: 0.0797  data: 0.0001  max mem: 21529
Epoch: [0] Total time: 0:13:43
Test:   [  0/391]  eta: 0:12:27  loss: 0.4118 (0.4118)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.9124  data: 1.8467  max mem: 21529
Test:   [100/391]  eta: 0:00:24  loss: 0.6474 (0.6917)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.8849)  time: 0.0634  data: 0.0306  max mem: 21529
Test:   [200/391]  eta: 0:00:14  loss: 1.2349 (0.7916)  acc1: 68.7500 (79.3377)  acc5: 87.5000 (94.8383)  time: 0.0615  data: 0.0254  max mem: 21529
Test:   [300/391]  eta: 0:00:06  loss: 1.2492 (0.9209)  acc1: 68.7500 (76.7650)  acc5: 87.5000 (93.3451)  time: 0.0617  data: 0.0286  max mem: 21529
Test:  Total time: 0:00:27
Test:  Acc@1 76.272 Acc@5 92.958
Number of added parameters: 1081376
Epoch: [1]  [    0/10010]  eta: 5:21:07  lr: 0.01  img/s: 81.17488942742973  loss: 0.8541 (0.8541)  acc1: 84.3750 (84.3750)  acc5: 87.5000 (87.5000)  time: 1.9248  data: 1.5306  max mem: 21529
Epoch: [1]  [ 1000/10010]  eta: 0:12:57  lr: 0.01  img/s: 376.7409420086454  loss: 0.7686 (0.8944)  acc1: 78.1250 (78.1188)  acc5: 93.7500 (92.2265)  time: 0.0848  data: 0.0001  max mem: 21529
Epoch: [1]  [ 2000/10010]  eta: 0:11:22  lr: 0.01  img/s: 379.95971034022  loss: 0.6812 (0.8859)  acc1: 81.2500 (78.1953)  acc5: 93.7500 (92.3991)  time: 0.0841  data: 0.0001  max mem: 21529
Epoch: [1]  [ 3000/10010]  eta: 0:09:54  lr: 0.01  img/s: 384.9442105383918  loss: 0.8145 (0.8927)  acc1: 78.1250 (78.1323)  acc5: 90.6250 (92.3505)  time: 0.0843  data: 0.0001  max mem: 21529
Epoch: [1]  [ 4000/10010]  eta: 0:08:29  lr: 0.01  img/s: 386.1502795048032  loss: 1.0210 (0.8950)  acc1: 78.1250 (78.0953)  acc5: 90.6250 (92.2926)  time: 0.0842  data: 0.0001  max mem: 21529
Epoch: [1]  [ 5000/10010]  eta: 0:07:03  lr: 0.01  img/s: 383.74674916227315  loss: 0.7741 (0.8946)  acc1: 75.0000 (78.0775)  acc5: 93.7500 (92.2965)  time: 0.0839  data: 0.0001  max mem: 21529
Epoch: [1]  [ 6000/10010]  eta: 0:05:38  lr: 0.01  img/s: 373.2438111446671  loss: 0.7329 (0.8920)  acc1: 78.1250 (78.1495)  acc5: 93.7500 (92.3221)  time: 0.0846  data: 0.0001  max mem: 21529
Epoch: [1]  [ 7000/10010]  eta: 0:04:14  lr: 0.01  img/s: 381.2613709961481  loss: 0.8058 (0.8915)  acc1: 78.1250 (78.1259)  acc5: 93.7500 (92.3234)  time: 0.0840  data: 0.0001  max mem: 21529
Epoch: [1]  [ 8000/10010]  eta: 0:02:49  lr: 0.01  img/s: 378.70857681379425  loss: 0.8951 (0.8931)  acc1: 75.0000 (78.0922)  acc5: 93.7500 (92.2807)  time: 0.0839  data: 0.0001  max mem: 21529
Epoch: [1]  [ 9000/10010]  eta: 0:01:25  lr: 0.01  img/s: 383.98608448866787  loss: 0.9025 (0.8942)  acc1: 75.0000 (78.0365)  acc5: 93.7500 (92.2665)  time: 0.0844  data: 0.0001  max mem: 21529
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 391.39091054895385  loss: 0.7798 (0.8926)  acc1: 78.1250 (78.0753)  acc5: 90.6250 (92.2964)  time: 0.0820  data: 0.0001  max mem: 21529
Epoch: [1] Total time: 0:14:05
Test:   [  0/391]  eta: 0:09:03  loss: 0.3939 (0.3939)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3910  data: 1.3602  max mem: 21529
Test:   [100/391]  eta: 0:00:25  loss: 0.6481 (0.6939)  acc1: 81.2500 (81.7450)  acc5: 96.8750 (95.7921)  time: 0.0859  data: 0.0498  max mem: 21529
Test:   [200/391]  eta: 0:00:15  loss: 1.1441 (0.7934)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.8850)  time: 0.0738  data: 0.0408  max mem: 21529
Test:   [300/391]  eta: 0:00:07  loss: 1.2555 (0.9202)  acc1: 68.7500 (76.6507)  acc5: 87.5000 (93.4074)  time: 0.0623  data: 0.0266  max mem: 21529
Test:  Total time: 0:00:28
Test:  Acc@1 76.166 Acc@5 92.938
Number of added parameters: 1081376
Epoch: [2]  [    0/10010]  eta: 6:21:39  lr: 0.01  img/s: 109.31892230015076  loss: 1.5323 (1.5323)  acc1: 75.0000 (75.0000)  acc5: 81.2500 (81.2500)  time: 2.2877  data: 1.9950  max mem: 21529
Epoch: [2]  [ 1000/10010]  eta: 0:13:24  lr: 0.01  img/s: 371.29748286918056  loss: 0.8286 (0.8715)  acc1: 78.1250 (78.4840)  acc5: 93.7500 (92.5075)  time: 0.0867  data: 0.0002  max mem: 21529
Epoch: [2]  [ 2000/10010]  eta: 0:11:45  lr: 0.01  img/s: 376.29520973864675  loss: 1.0158 (0.8842)  acc1: 75.0000 (78.1156)  acc5: 90.6250 (92.4834)  time: 0.0867  data: 0.0001  max mem: 21529
Epoch: [2]  [ 3000/10010]  eta: 0:10:14  lr: 0.01  img/s: 365.54655336764984  loss: 0.8743 (0.8843)  acc1: 78.1250 (78.2073)  acc5: 93.7500 (92.4484)  time: 0.0867  data: 0.0001  max mem: 21529
Epoch: [2]  [ 4000/10010]  eta: 0:08:45  lr: 0.01  img/s: 368.562953606195  loss: 0.8187 (0.8877)  acc1: 78.1250 (78.1664)  acc5: 93.7500 (92.4042)  time: 0.0878  data: 0.0001  max mem: 21529
Epoch: [2]  [ 5000/10010]  eta: 0:07:17  lr: 0.01  img/s: 365.0653277266125  loss: 0.9908 (0.8904)  acc1: 75.0000 (78.0600)  acc5: 90.6250 (92.3603)  time: 0.0865  data: 0.0001  max mem: 21529
Epoch: [2]  [ 6000/10010]  eta: 0:05:50  lr: 0.01  img/s: 376.67856050336917  loss: 0.9345 (0.8901)  acc1: 78.1250 (78.0427)  acc5: 90.6250 (92.3278)  time: 0.0864  data: 0.0001  max mem: 21529
Epoch: [2]  [ 7000/10010]  eta: 0:04:22  lr: 0.01  img/s: 372.11999423317917  loss: 0.8347 (0.8903)  acc1: 78.1250 (78.0540)  acc5: 93.7500 (92.3270)  time: 0.0871  data: 0.0001  max mem: 21529
Epoch: [2]  [ 8000/10010]  eta: 0:02:55  lr: 0.01  img/s: 369.43031570834825  loss: 0.7589 (0.8909)  acc1: 78.1250 (78.0438)  acc5: 93.7500 (92.3119)  time: 0.0870  data: 0.0001  max mem: 21529
Epoch: [2]  [ 9000/10010]  eta: 0:01:28  lr: 0.01  img/s: 368.05962765621956  loss: 0.7455 (0.8919)  acc1: 78.1250 (78.0177)  acc5: 93.7500 (92.3113)  time: 0.0869  data: 0.0001  max mem: 21529
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 397.10444360944524  loss: 0.9128 (0.8922)  acc1: 78.1250 (78.0228)  acc5: 90.6250 (92.3111)  time: 0.0848  data: 0.0001  max mem: 21529
Epoch: [2] Total time: 0:14:32
Test:   [  0/391]  eta: 0:08:44  loss: 0.4080 (0.4080)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.3408  data: 1.2982  max mem: 21529
Test:   [100/391]  eta: 0:00:25  loss: 0.6444 (0.6915)  acc1: 81.2500 (82.1163)  acc5: 96.8750 (95.8540)  time: 0.0715  data: 0.0274  max mem: 21529
Test:   [200/391]  eta: 0:00:15  loss: 1.2134 (0.7903)  acc1: 68.7500 (79.4932)  acc5: 90.6250 (94.9471)  time: 0.0656  data: 0.0263  max mem: 21529
Test:   [300/391]  eta: 0:00:06  loss: 1.2342 (0.9184)  acc1: 68.7500 (76.8272)  acc5: 87.5000 (93.4385)  time: 0.0561  data: 0.0185  max mem: 21529
Test:  Total time: 0:00:28
Test:  Acc@1 76.260 Acc@5 92.964
Number of added parameters: 1081376
Epoch: [3]  [    0/10010]  eta: 5:47:20  lr: 0.01  img/s: 71.89055653188343  loss: 0.9076 (0.9076)  acc1: 81.2500 (81.2500)  acc5: 87.5000 (87.5000)  time: 2.0819  data: 1.6368  max mem: 21529
Epoch: [3]  [ 1000/10010]  eta: 0:13:45  lr: 0.01  img/s: 357.2318666226618  loss: 0.8823 (0.8791)  acc1: 75.0000 (78.3779)  acc5: 93.7500 (92.5169)  time: 0.0898  data: 0.0001  max mem: 21529
Epoch: [3]  [ 2000/10010]  eta: 0:12:06  lr: 0.01  img/s: 362.8055273230543  loss: 0.8887 (0.8802)  acc1: 75.0000 (78.2937)  acc5: 93.7500 (92.4788)  time: 0.0901  data: 0.0001  max mem: 21529
Epoch: [3]  [ 3000/10010]  eta: 0:10:32  lr: 0.01  img/s: 356.05674932883414  loss: 0.8767 (0.8866)  acc1: 78.1250 (78.2010)  acc5: 90.6250 (92.3786)  time: 0.0897  data: 0.0001  max mem: 21529
Epoch: [3]  [ 4000/10010]  eta: 0:09:01  lr: 0.01  img/s: 363.6085358155865  loss: 0.6445 (0.8880)  acc1: 84.3750 (78.2031)  acc5: 93.7500 (92.3613)  time: 0.0895  data: 0.0001  max mem: 21529
Epoch: [3]  [ 5000/10010]  eta: 0:07:31  lr: 0.01  img/s: 359.90155766915416  loss: 0.8743 (0.8908)  acc1: 78.1250 (78.1906)  acc5: 93.7500 (92.3422)  time: 0.0899  data: 0.0001  max mem: 21529
Epoch: [3]  [ 6000/10010]  eta: 0:06:00  lr: 0.01  img/s: 358.9736314935021  loss: 0.8115 (0.8918)  acc1: 78.1250 (78.1724)  acc5: 93.7500 (92.3393)  time: 0.0896  data: 0.0001  max mem: 21529
Epoch: [3]  [ 7000/10010]  eta: 0:04:30  lr: 0.01  img/s: 358.1307298017733  loss: 0.7579 (0.8923)  acc1: 81.2500 (78.1411)  acc5: 93.7500 (92.3149)  time: 0.0896  data: 0.0001  max mem: 21529
Epoch: [3]  [ 8000/10010]  eta: 0:03:00  lr: 0.01  img/s: 359.89094224272003  loss: 0.7311 (0.8931)  acc1: 81.2500 (78.1176)  acc5: 93.7500 (92.2869)  time: 0.0893  data: 0.0001  max mem: 21529
Epoch: [3]  [ 9000/10010]  eta: 0:01:30  lr: 0.01  img/s: 351.303808865716  loss: 0.7810 (0.8918)  acc1: 78.1250 (78.1437)  acc5: 93.7500 (92.3029)  time: 0.0897  data: 0.0001  max mem: 21529
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 366.78124470532936  loss: 0.8675 (0.8914)  acc1: 78.1250 (78.1331)  acc5: 90.6250 (92.3186)  time: 0.0878  data: 0.0001  max mem: 21529
Epoch: [3] Total time: 0:14:59
Test:   [  0/391]  eta: 0:09:14  loss: 0.4062 (0.4062)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4191  data: 1.3664  max mem: 21529
Test:   [100/391]  eta: 0:00:25  loss: 0.6811 (0.6930)  acc1: 81.2500 (82.0235)  acc5: 96.8750 (95.9468)  time: 0.0657  data: 0.0307  max mem: 21529
Test:   [200/391]  eta: 0:00:14  loss: 1.1883 (0.7907)  acc1: 68.7500 (79.4776)  acc5: 87.5000 (94.9160)  time: 0.0613  data: 0.0186  max mem: 21529
Test:   [300/391]  eta: 0:00:06  loss: 1.2930 (0.9200)  acc1: 68.7500 (76.8895)  acc5: 87.5000 (93.4593)  time: 0.0801  data: 0.0362  max mem: 21529
Test:  Total time: 0:00:28
Test:  Acc@1 76.262 Acc@5 92.962
Number of added parameters: 1081376
Epoch: [4]  [    0/10010]  eta: 5:48:40  lr: 0.01  img/s: 214.36799023812148  loss: 0.6613 (0.6613)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 2.0899  data: 1.9406  max mem: 21529
Epoch: [4]  [ 1000/10010]  eta: 0:14:09  lr: 0.01  img/s: 346.0709325921208  loss: 0.8310 (0.8878)  acc1: 78.1250 (78.1874)  acc5: 93.7500 (92.3264)  time: 0.0919  data: 0.0001  max mem: 21529
Epoch: [4]  [ 2000/10010]  eta: 0:12:26  lr: 0.01  img/s: 352.21371457662525  loss: 0.6918 (0.8895)  acc1: 81.2500 (78.1125)  acc5: 93.7500 (92.2882)  time: 0.0919  data: 0.0001  max mem: 21529
Epoch: [4]  [ 3000/10010]  eta: 0:10:51  lr: 0.01  img/s: 352.6514414234516  loss: 0.9281 (0.8916)  acc1: 78.1250 (78.0386)  acc5: 90.6250 (92.2338)  time: 0.0923  data: 0.0001  max mem: 21529
Epoch: [4]  [ 4000/10010]  eta: 0:09:16  lr: 0.01  img/s: 350.75113547867807  loss: 0.8665 (0.8876)  acc1: 78.1250 (78.1336)  acc5: 93.7500 (92.3050)  time: 0.0917  data: 0.0001  max mem: 21529
Epoch: [4]  [ 5000/10010]  eta: 0:07:43  lr: 0.01  img/s: 350.1727882282345  loss: 0.8400 (0.8877)  acc1: 78.1250 (78.1462)  acc5: 90.6250 (92.3209)  time: 0.0921  data: 0.0001  max mem: 21529
Epoch: [4]  [ 6000/10010]  eta: 0:06:10  lr: 0.01  img/s: 353.9207712449668  loss: 0.8177 (0.8891)  acc1: 78.1250 (78.2047)  acc5: 93.7500 (92.2961)  time: 0.0914  data: 0.0001  max mem: 21529
Epoch: [4]  [ 7000/10010]  eta: 0:04:38  lr: 0.01  img/s: 346.56330012755564  loss: 0.8157 (0.8874)  acc1: 81.2500 (78.2393)  acc5: 93.7500 (92.3100)  time: 0.0922  data: 0.0001  max mem: 21529
Epoch: [4]  [ 8000/10010]  eta: 0:03:05  lr: 0.01  img/s: 346.97273444063853  loss: 0.8339 (0.8865)  acc1: 78.1250 (78.2332)  acc5: 93.7500 (92.3283)  time: 0.0919  data: 0.0001  max mem: 21529
Epoch: [4]  [ 9000/10010]  eta: 0:01:33  lr: 0.01  img/s: 351.3295569958223  loss: 0.9691 (0.8860)  acc1: 78.1250 (78.2403)  acc5: 90.6250 (92.3425)  time: 0.0922  data: 0.0001  max mem: 21529
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 347.344480358996  loss: 1.0004 (0.8897)  acc1: 78.1250 (78.1766)  acc5: 87.5000 (92.3020)  time: 0.0906  data: 0.0001  max mem: 21529
Epoch: [4] Total time: 0:15:24
Test:   [  0/391]  eta: 0:10:23  loss: 0.3830 (0.3830)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5944  data: 1.5367  max mem: 21529
Test:   [100/391]  eta: 0:00:27  loss: 0.6783 (0.6921)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.9777)  time: 0.0553  data: 0.0119  max mem: 21529
Test:   [200/391]  eta: 0:00:15  loss: 1.2811 (0.7920)  acc1: 68.7500 (79.3532)  acc5: 90.6250 (94.9316)  time: 0.0671  data: 0.0190  max mem: 21529
Test:   [300/391]  eta: 0:00:07  loss: 1.2620 (0.9208)  acc1: 68.7500 (76.7753)  acc5: 87.5000 (93.4385)  time: 0.0537  data: 0.0129  max mem: 21529
Test:  Total time: 0:00:28
Test:  Acc@1 76.220 Acc@5 92.930
Number of added parameters: 1081376
Training time 1:15:09
Experiment with model=resnet50, n_components=32, and dof=16 completed
-----------------------------------
Running experiment with n_components=32 and dof=32
[2024-11-15 03:46:38,350] torch.distributed.run: [WARNING] 
[2024-11-15 03:46:38,350] torch.distributed.run: [WARNING] *****************************************
[2024-11-15 03:46:38,350] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2024-11-15 03:46:38,350] torch.distributed.run: [WARNING] *****************************************
| distributed init (rank 0): env://
| distributed init (rank 2): env://
| distributed init (rank 1): env://
| distributed init (rank 3): env://
Namespace(data_path='/home/cs/Documents/datasets/imagenet', model='resnet50', device='cuda', n_components=32, dof=32, batch_size=32, epochs=5, workers=16, opt='sgd', lr=0.01, momentum=0.9, weight_decay=0.0001, norm_weight_decay=None, bias_weight_decay=None, transformer_embedding_decay=None, label_smoothing=0.0, mixup_alpha=0.0, cutmix_alpha=0.0, lr_scheduler='steplr', lr_warmup_epochs=0, lr_warmup_method='constant', lr_warmup_decay=0.01, lr_step_size=30, lr_gamma=0.1, lr_min=0.0, print_freq=1000, output_dir='resnet50', resume='', start_epoch=0, cache_dataset=False, sync_bn=False, test_only=False, auto_augment=None, ra_magnitude=9, augmix_severity=3, random_erase=0.0, amp=False, world_size=4, dist_url='env://', model_ema=False, model_ema_steps=32, model_ema_decay=0.99998, use_deterministic_algorithms=False, interpolation='bilinear', val_resize_size=256, val_crop_size=224, train_crop_size=224, clip_grad_norm=None, ra_sampler=False, ra_reps=3, weights='ResNet50_Weights.IMAGENET1K_V1', rank=0, gpu=0, distributed=True, dist_backend='nccl')
Loading data
Loading training data
Took 1.5722181797027588
Loading validation data
Creating data loaders
Creating model
Number of added parameters: 2129952
Start training
Epoch: [0]  [    0/10010]  eta: 14:02:21  lr: 0.01  img/s: 10.58377318137505  loss: 1.0359 (1.0359)  acc1: 62.5000 (62.5000)  acc5: 93.7500 (93.7500)  time: 5.0491  data: 2.0256  max mem: 21541
Epoch: [0]  [ 1000/10010]  eta: 0:13:09  lr: 0.01  img/s: 393.9862739457416  loss: 0.7958 (0.9075)  acc1: 78.1250 (77.9876)  acc5: 93.7500 (91.8706)  time: 0.0826  data: 0.0001  max mem: 21541
Epoch: [0]  [ 2000/10010]  eta: 0:11:22  lr: 0.01  img/s: 383.3904953425064  loss: 0.9255 (0.9070)  acc1: 75.0000 (78.0391)  acc5: 93.7500 (91.9821)  time: 0.0830  data: 0.0001  max mem: 21541
Epoch: [0]  [ 3000/10010]  eta: 0:09:51  lr: 0.01  img/s: 392.67224097880086  loss: 0.9502 (0.8988)  acc1: 75.0000 (78.1229)  acc5: 93.7500 (92.0391)  time: 0.0823  data: 0.0001  max mem: 21541
Epoch: [0]  [ 4000/10010]  eta: 0:08:24  lr: 0.01  img/s: 385.0667982568131  loss: 0.7743 (0.8951)  acc1: 78.1250 (78.1516)  acc5: 93.7500 (92.1387)  time: 0.0830  data: 0.0001  max mem: 21541
Epoch: [0]  [ 5000/10010]  eta: 0:06:59  lr: 0.01  img/s: 387.0991529358833  loss: 0.8777 (0.8960)  acc1: 78.1250 (78.1462)  acc5: 93.7500 (92.1666)  time: 0.0828  data: 0.0001  max mem: 21541
Epoch: [0]  [ 6000/10010]  eta: 0:05:34  lr: 0.01  img/s: 384.60997618713304  loss: 0.8399 (0.8948)  acc1: 78.1250 (78.1286)  acc5: 93.7500 (92.2211)  time: 0.0827  data: 0.0001  max mem: 21541
Epoch: [0]  [ 7000/10010]  eta: 0:04:10  lr: 0.01  img/s: 387.893450321805  loss: 0.8799 (0.8938)  acc1: 75.0000 (78.1134)  acc5: 93.7500 (92.2600)  time: 0.0824  data: 0.0001  max mem: 21541
Epoch: [0]  [ 8000/10010]  eta: 0:02:47  lr: 0.01  img/s: 386.7689692037704  loss: 0.8507 (0.8942)  acc1: 75.0000 (78.0934)  acc5: 93.7500 (92.2478)  time: 0.0822  data: 0.0001  max mem: 21541
Epoch: [0]  [ 9000/10010]  eta: 0:01:24  lr: 0.01  img/s: 387.8822404032055  loss: 0.8540 (0.8950)  acc1: 78.1250 (78.0750)  acc5: 93.7500 (92.2422)  time: 0.0824  data: 0.0001  max mem: 21541
Epoch: [0]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 418.6415223812628  loss: 0.7240 (0.8944)  acc1: 81.2500 (78.0825)  acc5: 93.7500 (92.2380)  time: 0.0804  data: 0.0001  max mem: 21541
Epoch: [0] Total time: 0:13:53
Test:   [  0/391]  eta: 0:10:12  loss: 0.4112 (0.4112)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5675  data: 1.4418  max mem: 21541
Test:   [100/391]  eta: 0:00:25  loss: 0.6464 (0.6907)  acc1: 81.2500 (81.9307)  acc5: 96.8750 (95.9158)  time: 0.0883  data: 0.0497  max mem: 21541
Test:   [200/391]  eta: 0:00:15  loss: 1.2122 (0.7918)  acc1: 68.7500 (79.3221)  acc5: 87.5000 (94.9160)  time: 0.0694  data: 0.0341  max mem: 21541
Test:   [300/391]  eta: 0:00:06  loss: 1.2511 (0.9198)  acc1: 71.8750 (76.7753)  acc5: 87.5000 (93.4178)  time: 0.0550  data: 0.0157  max mem: 21541
Test:  Total time: 0:00:28
Test:  Acc@1 76.198 Acc@5 92.944
Number of added parameters: 2129952
Epoch: [1]  [    0/10010]  eta: 5:52:29  lr: 0.01  img/s: 172.643734580526  loss: 0.6591 (0.6591)  acc1: 87.5000 (87.5000)  acc5: 96.8750 (96.8750)  time: 2.1128  data: 1.9274  max mem: 21541
Epoch: [1]  [ 1000/10010]  eta: 0:13:22  lr: 0.01  img/s: 366.28476926015884  loss: 0.9039 (0.8870)  acc1: 75.0000 (78.2405)  acc5: 93.7500 (92.3046)  time: 0.0868  data: 0.0001  max mem: 21541
Epoch: [1]  [ 2000/10010]  eta: 0:11:45  lr: 0.01  img/s: 368.28484249807923  loss: 0.7787 (0.8889)  acc1: 75.0000 (78.1859)  acc5: 93.7500 (92.3929)  time: 0.0867  data: 0.0001  max mem: 21541
Epoch: [1]  [ 3000/10010]  eta: 0:10:14  lr: 0.01  img/s: 368.1757354312738  loss: 0.8096 (0.8872)  acc1: 81.2500 (78.2593)  acc5: 93.7500 (92.3911)  time: 0.0870  data: 0.0001  max mem: 21541
Epoch: [1]  [ 4000/10010]  eta: 0:08:45  lr: 0.01  img/s: 359.89866249074896  loss: 0.9734 (0.8884)  acc1: 78.1250 (78.1961)  acc5: 90.6250 (92.3511)  time: 0.0872  data: 0.0001  max mem: 21541
Epoch: [1]  [ 5000/10010]  eta: 0:07:17  lr: 0.01  img/s: 373.35178890329183  loss: 0.8656 (0.8932)  acc1: 81.2500 (78.0613)  acc5: 90.6250 (92.2790)  time: 0.0866  data: 0.0001  max mem: 21541
Epoch: [1]  [ 6000/10010]  eta: 0:05:50  lr: 0.01  img/s: 366.7211156467046  loss: 0.8154 (0.8911)  acc1: 81.2500 (78.0792)  acc5: 93.7500 (92.3294)  time: 0.0865  data: 0.0001  max mem: 21541
Epoch: [1]  [ 7000/10010]  eta: 0:04:22  lr: 0.01  img/s: 362.5634550812959  loss: 0.6828 (0.8927)  acc1: 78.1250 (78.0621)  acc5: 93.7500 (92.3078)  time: 0.0869  data: 0.0001  max mem: 21541
Epoch: [1]  [ 8000/10010]  eta: 0:02:55  lr: 0.01  img/s: 370.59623875173605  loss: 0.8882 (0.8932)  acc1: 78.1250 (78.0766)  acc5: 93.7500 (92.3006)  time: 0.0869  data: 0.0001  max mem: 21541
Epoch: [1]  [ 9000/10010]  eta: 0:01:28  lr: 0.01  img/s: 370.66992916223643  loss: 0.8701 (0.8940)  acc1: 75.0000 (78.0642)  acc5: 90.6250 (92.2679)  time: 0.0874  data: 0.0001  max mem: 21541
Epoch: [1]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 376.19079491340625  loss: 0.7528 (0.8941)  acc1: 78.1250 (78.0628)  acc5: 93.7500 (92.2845)  time: 0.0854  data: 0.0001  max mem: 21541
Epoch: [1] Total time: 0:14:33
Test:   [  0/391]  eta: 0:11:07  loss: 0.3971 (0.3971)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.7078  data: 1.6541  max mem: 21541
Test:   [100/391]  eta: 0:00:26  loss: 0.6256 (0.6931)  acc1: 81.2500 (81.8379)  acc5: 96.8750 (95.8849)  time: 0.0744  data: 0.0375  max mem: 21541
Test:   [200/391]  eta: 0:00:14  loss: 1.1737 (0.7933)  acc1: 68.7500 (79.3532)  acc5: 87.5000 (94.8383)  time: 0.0675  data: 0.0292  max mem: 21541
Test:   [300/391]  eta: 0:00:06  loss: 1.2362 (0.9207)  acc1: 68.7500 (76.7650)  acc5: 87.5000 (93.3866)  time: 0.0476  data: 0.0114  max mem: 21541
Test:  Total time: 0:00:28
Test:  Acc@1 76.260 Acc@5 92.938
Number of added parameters: 2129952
Epoch: [2]  [    0/10010]  eta: 6:26:55  lr: 0.01  img/s: 244.6411668316227  loss: 1.2225 (1.2225)  acc1: 75.0000 (75.0000)  acc5: 90.6250 (90.6250)  time: 2.3192  data: 2.1884  max mem: 21541
Epoch: [2]  [ 1000/10010]  eta: 0:14:00  lr: 0.01  img/s: 357.4030931788164  loss: 0.8619 (0.8688)  acc1: 78.1250 (78.4247)  acc5: 90.6250 (92.6667)  time: 0.0905  data: 0.0001  max mem: 21541
Epoch: [2]  [ 2000/10010]  eta: 0:12:17  lr: 0.01  img/s: 356.5609115277228  loss: 0.8317 (0.8748)  acc1: 78.1250 (78.4045)  acc5: 93.7500 (92.6006)  time: 0.0909  data: 0.0001  max mem: 21541
Epoch: [2]  [ 3000/10010]  eta: 0:10:42  lr: 0.01  img/s: 353.35518826447066  loss: 0.7267 (0.8773)  acc1: 78.1250 (78.2531)  acc5: 93.7500 (92.5421)  time: 0.0904  data: 0.0001  max mem: 21541
Epoch: [2]  [ 4000/10010]  eta: 0:09:09  lr: 0.01  img/s: 357.4230803030505  loss: 0.8334 (0.8847)  acc1: 78.1250 (78.1328)  acc5: 93.7500 (92.4417)  time: 0.0909  data: 0.0001  max mem: 21541
Epoch: [2]  [ 5000/10010]  eta: 0:07:37  lr: 0.01  img/s: 346.7289284081251  loss: 0.9048 (0.8896)  acc1: 75.0000 (78.0313)  acc5: 90.6250 (92.3540)  time: 0.0905  data: 0.0001  max mem: 21541
Epoch: [2]  [ 6000/10010]  eta: 0:06:05  lr: 0.01  img/s: 360.6936873505146  loss: 0.8201 (0.8866)  acc1: 78.1250 (78.1229)  acc5: 90.6250 (92.3752)  time: 0.0906  data: 0.0001  max mem: 21541
Epoch: [2]  [ 7000/10010]  eta: 0:04:34  lr: 0.01  img/s: 355.1259657515399  loss: 0.7878 (0.8878)  acc1: 78.1250 (78.1112)  acc5: 93.7500 (92.3355)  time: 0.0909  data: 0.0001  max mem: 21541
Epoch: [2]  [ 8000/10010]  eta: 0:03:03  lr: 0.01  img/s: 356.03880363419324  loss: 0.7592 (0.8890)  acc1: 78.1250 (78.0922)  acc5: 90.6250 (92.3303)  time: 0.0905  data: 0.0001  max mem: 21541
Epoch: [2]  [ 9000/10010]  eta: 0:01:31  lr: 0.01  img/s: 346.3370482666082  loss: 0.7819 (0.8908)  acc1: 78.1250 (78.0646)  acc5: 93.7500 (92.3081)  time: 0.0906  data: 0.0001  max mem: 21541
Epoch: [2]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 368.94388780309464  loss: 0.8963 (0.8917)  acc1: 78.1250 (78.0644)  acc5: 90.6250 (92.2914)  time: 0.0884  data: 0.0001  max mem: 21541
Epoch: [2] Total time: 0:15:11
Test:   [  0/391]  eta: 0:10:53  loss: 0.4097 (0.4097)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.6721  data: 1.6371  max mem: 21541
Test:   [100/391]  eta: 0:00:27  loss: 0.6305 (0.6930)  acc1: 81.2500 (81.8069)  acc5: 96.8750 (95.8849)  time: 0.0647  data: 0.0209  max mem: 21541
Test:   [200/391]  eta: 0:00:16  loss: 1.1819 (0.7898)  acc1: 68.7500 (79.3377)  acc5: 90.6250 (94.9627)  time: 0.0756  data: 0.0326  max mem: 21541
Test:   [300/391]  eta: 0:00:06  loss: 1.2374 (0.9181)  acc1: 68.7500 (76.8065)  acc5: 90.6250 (93.5008)  time: 0.0446  data: 0.0058  max mem: 21541
Test:  Total time: 0:00:28
Test:  Acc@1 76.238 Acc@5 92.976
Number of added parameters: 2129952
Epoch: [3]  [    0/10010]  eta: 5:10:20  lr: 0.01  img/s: 229.65460198174983  loss: 0.7165 (0.7165)  acc1: 81.2500 (81.2500)  acc5: 93.7500 (93.7500)  time: 1.8602  data: 1.7208  max mem: 21541
Epoch: [3]  [ 1000/10010]  eta: 0:14:31  lr: 0.01  img/s: 338.1378372114115  loss: 0.8108 (0.8889)  acc1: 78.1250 (78.0095)  acc5: 93.7500 (92.5293)  time: 0.0944  data: 0.0001  max mem: 21541
Epoch: [3]  [ 2000/10010]  eta: 0:12:47  lr: 0.01  img/s: 337.6121946924915  loss: 0.8241 (0.8893)  acc1: 81.2500 (78.0625)  acc5: 93.7500 (92.4834)  time: 0.0943  data: 0.0001  max mem: 21541
Epoch: [3]  [ 3000/10010]  eta: 0:11:09  lr: 0.01  img/s: 339.1589060411334  loss: 0.7147 (0.8926)  acc1: 84.3750 (78.0261)  acc5: 93.7500 (92.3630)  time: 0.0945  data: 0.0001  max mem: 21541
Epoch: [3]  [ 4000/10010]  eta: 0:09:32  lr: 0.01  img/s: 343.89583023731313  loss: 0.9420 (0.8956)  acc1: 78.1250 (77.9290)  acc5: 90.6250 (92.2996)  time: 0.0946  data: 0.0001  max mem: 21541
Epoch: [3]  [ 5000/10010]  eta: 0:07:56  lr: 0.01  img/s: 341.2847291442055  loss: 0.7904 (0.8950)  acc1: 78.1250 (77.9400)  acc5: 93.7500 (92.2890)  time: 0.0944  data: 0.0001  max mem: 21541
Epoch: [3]  [ 6000/10010]  eta: 0:06:21  lr: 0.01  img/s: 345.1738062601423  loss: 0.8932 (0.8940)  acc1: 78.1250 (77.9834)  acc5: 90.6250 (92.2945)  time: 0.0947  data: 0.0001  max mem: 21541
Epoch: [3]  [ 7000/10010]  eta: 0:04:46  lr: 0.01  img/s: 333.28796050736514  loss: 0.9102 (0.8944)  acc1: 78.1250 (78.0223)  acc5: 93.7500 (92.2841)  time: 0.0950  data: 0.0001  max mem: 21541
Epoch: [3]  [ 8000/10010]  eta: 0:03:10  lr: 0.01  img/s: 341.5861245784819  loss: 0.7623 (0.8926)  acc1: 81.2500 (78.0578)  acc5: 93.7500 (92.3021)  time: 0.0955  data: 0.0001  max mem: 21541
Epoch: [3]  [ 9000/10010]  eta: 0:01:35  lr: 0.01  img/s: 329.0747111782359  loss: 0.9770 (0.8909)  acc1: 78.1250 (78.1108)  acc5: 90.6250 (92.3231)  time: 0.0949  data: 0.0001  max mem: 21541
Epoch: [3]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 342.22018016456013  loss: 0.9565 (0.8919)  acc1: 75.0000 (78.1153)  acc5: 90.6250 (92.3114)  time: 0.0931  data: 0.0001  max mem: 21541
Epoch: [3] Total time: 0:15:50
Test:   [  0/391]  eta: 0:10:15  loss: 0.4037 (0.4037)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.5743  data: 1.4795  max mem: 21541
Test:   [100/391]  eta: 0:00:28  loss: 0.6770 (0.6925)  acc1: 81.2500 (81.9616)  acc5: 96.8750 (95.8540)  time: 0.0693  data: 0.0154  max mem: 21541
Test:   [200/391]  eta: 0:00:15  loss: 1.1468 (0.7907)  acc1: 68.7500 (79.4465)  acc5: 90.6250 (94.8539)  time: 0.0496  data: 0.0045  max mem: 21541
Test:   [300/391]  eta: 0:00:06  loss: 1.2563 (0.9196)  acc1: 68.7500 (76.7857)  acc5: 87.5000 (93.4178)  time: 0.0627  data: 0.0151  max mem: 21541
Test:  Total time: 0:00:28
Test:  Acc@1 76.294 Acc@5 92.932
Number of added parameters: 2129952
Epoch: [4]  [    0/10010]  eta: 5:40:44  lr: 0.01  img/s: 211.66149357766335  loss: 0.8591 (0.8591)  acc1: 71.8750 (71.8750)  acc5: 93.7500 (93.7500)  time: 2.0424  data: 1.8912  max mem: 21541
Epoch: [4]  [ 1000/10010]  eta: 0:15:10  lr: 0.01  img/s: 323.7704090740231  loss: 0.8107 (0.8908)  acc1: 78.1250 (78.2405)  acc5: 90.6250 (92.4201)  time: 0.0989  data: 0.0001  max mem: 21541
Epoch: [4]  [ 2000/10010]  eta: 0:13:21  lr: 0.01  img/s: 322.91044869481533  loss: 0.9906 (0.8835)  acc1: 78.1250 (78.2671)  acc5: 90.6250 (92.4241)  time: 0.0985  data: 0.0001  max mem: 21541
Epoch: [4]  [ 3000/10010]  eta: 0:11:38  lr: 0.01  img/s: 325.7901625337398  loss: 0.8523 (0.8828)  acc1: 81.2500 (78.2916)  acc5: 93.7500 (92.3963)  time: 0.0987  data: 0.0001  max mem: 21541
Epoch: [4]  [ 4000/10010]  eta: 0:09:57  lr: 0.01  img/s: 326.151166407465  loss: 0.6853 (0.8807)  acc1: 78.1250 (78.3148)  acc5: 96.8750 (92.4081)  time: 0.0982  data: 0.0001  max mem: 21541
Epoch: [4]  [ 5000/10010]  eta: 0:08:17  lr: 0.01  img/s: 324.66087579128657  loss: 0.7388 (0.8840)  acc1: 78.1250 (78.2300)  acc5: 93.7500 (92.3578)  time: 0.0984  data: 0.0001  max mem: 21541
Epoch: [4]  [ 6000/10010]  eta: 0:06:38  lr: 0.01  img/s: 325.677907783693  loss: 0.8015 (0.8855)  acc1: 75.0000 (78.1786)  acc5: 93.7500 (92.3419)  time: 0.0988  data: 0.0001  max mem: 21541
Epoch: [4]  [ 7000/10010]  eta: 0:04:58  lr: 0.01  img/s: 320.26985017073235  loss: 0.8165 (0.8861)  acc1: 81.2500 (78.2053)  acc5: 93.7500 (92.3239)  time: 0.0990  data: 0.0001  max mem: 21541
Epoch: [4]  [ 8000/10010]  eta: 0:03:19  lr: 0.01  img/s: 322.21663445726153  loss: 0.8188 (0.8857)  acc1: 78.1250 (78.1937)  acc5: 93.7500 (92.3338)  time: 0.0988  data: 0.0001  max mem: 21541
Epoch: [4]  [ 9000/10010]  eta: 0:01:40  lr: 0.01  img/s: 327.2940551059176  loss: 0.9939 (0.8870)  acc1: 75.0000 (78.1701)  acc5: 93.7500 (92.3168)  time: 0.0988  data: 0.0001  max mem: 21541
Epoch: [4]  [10000/10010]  eta: 0:00:00  lr: 0.01  img/s: 327.1432805553389  loss: 0.8902 (0.8876)  acc1: 78.1250 (78.1478)  acc5: 90.6250 (92.3348)  time: 0.0974  data: 0.0001  max mem: 21541
Epoch: [4] Total time: 0:16:32
Test:   [  0/391]  eta: 0:09:43  loss: 0.3857 (0.3857)  acc1: 84.3750 (84.3750)  acc5: 96.8750 (96.8750)  time: 1.4927  data: 1.4216  max mem: 21541
Test:   [100/391]  eta: 0:00:26  loss: 0.6377 (0.6899)  acc1: 81.2500 (81.9616)  acc5: 96.8750 (95.8849)  time: 0.0666  data: 0.0099  max mem: 21541
Test:   [200/391]  eta: 0:00:15  loss: 1.2091 (0.7900)  acc1: 65.6250 (79.3532)  acc5: 90.6250 (94.9005)  time: 0.0574  data: 0.0056  max mem: 21541
Test:   [300/391]  eta: 0:00:06  loss: 1.2310 (0.9188)  acc1: 68.7500 (76.7650)  acc5: 87.5000 (93.3659)  time: 0.0651  data: 0.0064  max mem: 21541
Test:  Total time: 0:00:28
Test:  Acc@1 76.244 Acc@5 92.944
Number of added parameters: 2129952
Training time 1:18:27
Experiment with model=resnet50, n_components=32, and dof=32 completed
-----------------------------------
